/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 80, in main
    cfg = get_config(args.config, overrides=args.override, tensorboard=args.use_tensorboard)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/utils/config.py", line 46, in get_config
    assert os.path.exists(fname), ('config file({}) is not exist'.format(fname))
AssertionError: config file(CONFIG_PATH) is not exist
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 08:44:17] [35mCOLLATE[0m : 
[03/06 08:44:17]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 08:44:17]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 08:44:17] ------------------------------------------------------------
[03/06 08:44:17] [35mDATASET[0m : 
[03/06 08:44:17]     [35mnum_workers[0m : [92m0[0m
[03/06 08:44:17]     [35mtemporal_clip_batch_size[0m : [92m4[0m
[03/06 08:44:17]     [35mtest[0m : 
[03/06 08:44:17]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 08:44:17]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 08:44:17]         [35mclip_seg_num[0m : [92m8[0m
[03/06 08:44:17]         [35mdata_prefix[0m : [92m./[0m
[03/06 08:44:17]         [35mdataset_type[0m : [92mgtea[0m
[03/06 08:44:17]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 08:44:17]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 08:44:17]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 08:44:17]         [35msample_rate[0m : [92m4[0m
[03/06 08:44:17]         [35msliding_window[0m : [92m32[0m
[03/06 08:44:17]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 08:44:17]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 08:44:17]     [35mtrain[0m : 
[03/06 08:44:17]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 08:44:17]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 08:44:17]         [35mclip_seg_num[0m : [92m8[0m
[03/06 08:44:17]         [35mdata_prefix[0m : [92m./[0m
[03/06 08:44:17]         [35mdataset_type[0m : [92mgtea[0m
[03/06 08:44:17]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 08:44:17]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 08:44:17]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 08:44:17]         [35msample_rate[0m : [92m4[0m
[03/06 08:44:17]         [35msliding_window[0m : [92m32[0m
[03/06 08:44:17]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 08:44:17]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 08:44:17]     [35mvideo_batch_size[0m : [92m16[0m
[03/06 08:44:17] ------------------------------------------------------------
[03/06 08:44:17] [35mLRSCHEDULER[0m : 
[03/06 08:44:17]     [35mgamma[0m : [92m0.1[0m
[03/06 08:44:17]     [35mname[0m : [92mMultiStepLR[0m
[03/06 08:44:17]     [35mstep_size[0m : [92m[50][0m
[03/06 08:44:17] ------------------------------------------------------------
[03/06 08:44:17] [35mMETRIC[0m : 
[03/06 08:44:17]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 08:44:17]     [35mfile_output[0m : [92mTrue[0m
[03/06 08:44:17]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 08:44:17]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 08:44:17]     [35mscore_output[0m : [92mTrue[0m
[03/06 08:44:17] ------------------------------------------------------------
[03/06 08:44:17] [35mMODEL[0m : 
[03/06 08:44:17]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 08:44:17]     [35mbackbone[0m : 
[03/06 08:44:17]         [35mclip_seg_num[0m : [92m8[0m
[03/06 08:44:17]         [35mname[0m : [92mResNetTSM[0m
[03/06 08:44:17]         [35mout_indices[0m : [92m(3,)[0m
[03/06 08:44:17]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 08:44:17]         [35mshift_div[0m : [92m8[0m
[03/06 08:44:17]     [35mhead[0m : 
[03/06 08:44:17]         [35maction_head[0m : 
[03/06 08:44:17]             [35mdim[0m : [92m2048[0m
[03/06 08:44:17]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 08:44:17]             [35mnum_classes[0m : [92m5[0m
[03/06 08:44:17]             [35mnum_f_maps[0m : [92m64[0m
[03/06 08:44:17]             [35mnum_layers[0m : [92m4[0m
[03/06 08:44:17]             [35mnum_stages[0m : [92m1[0m
[03/06 08:44:17]             [35msample_rate[0m : [92m4[0m
[03/06 08:44:17]         [35mbranch_head[0m : 
[03/06 08:44:17]             [35mdim[0m : [92m2048[0m
[03/06 08:44:17]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 08:44:17]             [35mnum_classes[0m : [92m15[0m
[03/06 08:44:17]             [35mnum_f_maps[0m : [92m64[0m
[03/06 08:44:17]             [35mnum_layers[0m : [92m4[0m
[03/06 08:44:17]             [35mnum_stages[0m : [92m1[0m
[03/06 08:44:17]             [35msample_rate[0m : [92m4[0m
[03/06 08:44:17]         [35msample_rate[0m : [92m4[0m
[03/06 08:44:17]     [35mloss[0m : 
[03/06 08:44:17]         [35mignore_index[0m : [92m-100[0m
[03/06 08:44:17]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 08:44:17]         [35mnum_classes_action[0m : [92m5[0m
[03/06 08:44:17]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 08:44:17]         [35msample_rate[0m : [92m4[0m
[03/06 08:44:17]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 08:44:17]     [35mneck[0m : 
[03/06 08:44:17]         [35mclip_seg_num[0m : [92m8[0m
[03/06 08:44:17]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 08:44:17]         [35min_channels[0m : [92m2048[0m
[03/06 08:44:17]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 08:44:17]         [35mneed_pool[0m : [92mTrue[0m
[03/06 08:44:17]         [35mnum_classes[0m : [92m20[0m
[03/06 08:44:17] ------------------------------------------------------------
[03/06 08:44:17] [35mOPTIMIZER[0m : 
[03/06 08:44:17]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 08:44:17]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 08:44:17]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 08:44:17]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 08:44:17] ------------------------------------------------------------
[03/06 08:44:17] [35mPIPELINE[0m : 
[03/06 08:44:17]     [35mtest[0m : 
[03/06 08:44:17]         [35mdecode[0m : 
[03/06 08:44:17]             [35mbackend[0m : [92mdecord[0m
[03/06 08:44:17]             [35mname[0m : [92mVideoDecoder[0m
[03/06 08:44:17]         [35mname[0m : [92mBasePipline[0m
[03/06 08:44:17]         [35msample[0m : 
[03/06 08:44:17]             [35mclip_seg_num[0m : [92m8[0m
[03/06 08:44:17]             [35mis_train[0m : [92mFalse[0m
[03/06 08:44:17]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 08:44:17]             [35msample_mode[0m : [92muniform[0m
[03/06 08:44:17]             [35msample_rate[0m : [92m4[0m
[03/06 08:44:17]             [35msliding_window[0m : [92m32[0m
[03/06 08:44:17]         [35mtransform[0m : 
[03/06 08:44:17]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 08:44:17]             [35mtransform_list[0m : 
[03/06 08:44:17]                 [35mResize[0m : 
[03/06 08:44:17]                     [35msize[0m : [92m[224, 224][0m
[03/06 08:44:17]                 [35mCenterCrop[0m : 
[03/06 08:44:17]                     [35msize[0m : [92m224[0m
[03/06 08:44:17]                 [35mToTensor[0m : [92mNone[0m
[03/06 08:44:17]                 [35mNormalize[0m : 
[03/06 08:44:17]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 08:44:17]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 08:44:17]     [35mtrain[0m : 
[03/06 08:44:17]         [35mdecode[0m : 
[03/06 08:44:17]             [35mbackend[0m : [92mdecord[0m
[03/06 08:44:17]             [35mname[0m : [92mVideoDecoder[0m
[03/06 08:44:17]         [35mname[0m : [92mBasePipline[0m
[03/06 08:44:17]         [35msample[0m : 
[03/06 08:44:17]             [35mclip_seg_num[0m : [92m8[0m
[03/06 08:44:17]             [35mis_train[0m : [92mTrue[0m
[03/06 08:44:17]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 08:44:17]             [35msample_mode[0m : [92muniform[0m
[03/06 08:44:17]             [35msample_rate[0m : [92m4[0m
[03/06 08:44:17]             [35msliding_window[0m : [92m32[0m
[03/06 08:44:17]         [35mtransform[0m : 
[03/06 08:44:17]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 08:44:17]             [35mtransform_list[0m : 
[03/06 08:44:17]                 [35mResize[0m : 
[03/06 08:44:17]                     [35msize[0m : [92m[224, 224][0m
[03/06 08:44:17]                 [35mRandomCrop[0m : 
[03/06 08:44:17]                     [35msize[0m : [92m224[0m
[03/06 08:44:17]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 08:44:17]                 [35mToTensor[0m : [92mNone[0m
[03/06 08:44:17]                 [35mNormalize[0m : 
[03/06 08:44:17]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 08:44:17]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 08:44:17] ------------------------------------------------------------
[03/06 08:44:17] [35mPOSTPRECESSING[0m : 
[03/06 08:44:17]     [35mclip_seg_num[0m : [92m8[0m
[03/06 08:44:17]     [35mignore_index[0m : [92m-100[0m
[03/06 08:44:17]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 08:44:17]     [35mnum_action_classes[0m : [92m5[0m
[03/06 08:44:17]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 08:44:17]     [35msample_rate[0m : [92m4[0m
[03/06 08:44:17]     [35msliding_window[0m : [92m32[0m
[03/06 08:44:17] ------------------------------------------------------------
[03/06 08:44:17] [35mepochs[0m : [92m200[0m
[03/06 08:44:17] [35mlog_interval[0m : [92m1[0m
[03/06 08:44:17] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 08:44:17] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 202, in train
    runner.run_one_iter(data=data, r_tic=r_tic, epoch=epoch)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 330, in run_one_iter
    self.run_one_clip(sliding_seg)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 291, in run_one_clip
    with self.model.no_sync():
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1729, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'StreamSegmentation2DMultiLabel' object has no attribute 'no_sync'
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 08:45:07] [35mCOLLATE[0m : 
[03/06 08:45:07]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 08:45:07]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 08:45:07] ------------------------------------------------------------
[03/06 08:45:07] [35mDATASET[0m : 
[03/06 08:45:07]     [35mnum_workers[0m : [92m0[0m
[03/06 08:45:07]     [35mtemporal_clip_batch_size[0m : [92m4[0m
[03/06 08:45:07]     [35mtest[0m : 
[03/06 08:45:07]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 08:45:07]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 08:45:07]         [35mclip_seg_num[0m : [92m8[0m
[03/06 08:45:07]         [35mdata_prefix[0m : [92m./[0m
[03/06 08:45:07]         [35mdataset_type[0m : [92mgtea[0m
[03/06 08:45:07]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 08:45:07]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 08:45:07]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 08:45:07]         [35msample_rate[0m : [92m4[0m
[03/06 08:45:07]         [35msliding_window[0m : [92m32[0m
[03/06 08:45:07]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 08:45:07]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 08:45:07]     [35mtrain[0m : 
[03/06 08:45:07]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 08:45:07]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 08:45:07]         [35mclip_seg_num[0m : [92m8[0m
[03/06 08:45:07]         [35mdata_prefix[0m : [92m./[0m
[03/06 08:45:07]         [35mdataset_type[0m : [92mgtea[0m
[03/06 08:45:07]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 08:45:07]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 08:45:07]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 08:45:07]         [35msample_rate[0m : [92m4[0m
[03/06 08:45:07]         [35msliding_window[0m : [92m32[0m
[03/06 08:45:07]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 08:45:07]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 08:45:07]     [35mvideo_batch_size[0m : [92m16[0m
[03/06 08:45:07] ------------------------------------------------------------
[03/06 08:45:07] [35mLRSCHEDULER[0m : 
[03/06 08:45:07]     [35mgamma[0m : [92m0.1[0m
[03/06 08:45:07]     [35mname[0m : [92mMultiStepLR[0m
[03/06 08:45:07]     [35mstep_size[0m : [92m[50][0m
[03/06 08:45:07] ------------------------------------------------------------
[03/06 08:45:07] [35mMETRIC[0m : 
[03/06 08:45:07]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 08:45:07]     [35mfile_output[0m : [92mTrue[0m
[03/06 08:45:07]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 08:45:07]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 08:45:07]     [35mscore_output[0m : [92mTrue[0m
[03/06 08:45:07] ------------------------------------------------------------
[03/06 08:45:07] [35mMODEL[0m : 
[03/06 08:45:07]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 08:45:07]     [35mbackbone[0m : 
[03/06 08:45:07]         [35mclip_seg_num[0m : [92m8[0m
[03/06 08:45:07]         [35mname[0m : [92mResNetTSM[0m
[03/06 08:45:07]         [35mout_indices[0m : [92m(3,)[0m
[03/06 08:45:07]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 08:45:07]         [35mshift_div[0m : [92m8[0m
[03/06 08:45:07]     [35mhead[0m : 
[03/06 08:45:07]         [35maction_head[0m : 
[03/06 08:45:07]             [35mdim[0m : [92m2048[0m
[03/06 08:45:07]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 08:45:07]             [35mnum_classes[0m : [92m5[0m
[03/06 08:45:07]             [35mnum_f_maps[0m : [92m64[0m
[03/06 08:45:07]             [35mnum_layers[0m : [92m4[0m
[03/06 08:45:07]             [35mnum_stages[0m : [92m1[0m
[03/06 08:45:07]             [35msample_rate[0m : [92m4[0m
[03/06 08:45:07]         [35mbranch_head[0m : 
[03/06 08:45:07]             [35mdim[0m : [92m2048[0m
[03/06 08:45:07]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 08:45:07]             [35mnum_classes[0m : [92m15[0m
[03/06 08:45:07]             [35mnum_f_maps[0m : [92m64[0m
[03/06 08:45:07]             [35mnum_layers[0m : [92m4[0m
[03/06 08:45:07]             [35mnum_stages[0m : [92m1[0m
[03/06 08:45:07]             [35msample_rate[0m : [92m4[0m
[03/06 08:45:07]         [35msample_rate[0m : [92m4[0m
[03/06 08:45:07]     [35mloss[0m : 
[03/06 08:45:07]         [35mignore_index[0m : [92m-100[0m
[03/06 08:45:07]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 08:45:07]         [35mnum_classes_action[0m : [92m5[0m
[03/06 08:45:07]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 08:45:07]         [35msample_rate[0m : [92m4[0m
[03/06 08:45:07]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 08:45:07]     [35mneck[0m : 
[03/06 08:45:07]         [35mclip_seg_num[0m : [92m8[0m
[03/06 08:45:07]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 08:45:07]         [35min_channels[0m : [92m2048[0m
[03/06 08:45:07]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 08:45:07]         [35mneed_pool[0m : [92mTrue[0m
[03/06 08:45:07]         [35mnum_classes[0m : [92m20[0m
[03/06 08:45:07] ------------------------------------------------------------
[03/06 08:45:07] [35mOPTIMIZER[0m : 
[03/06 08:45:07]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 08:45:07]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 08:45:07]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 08:45:07]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 08:45:07] ------------------------------------------------------------
[03/06 08:45:07] [35mPIPELINE[0m : 
[03/06 08:45:07]     [35mtest[0m : 
[03/06 08:45:07]         [35mdecode[0m : 
[03/06 08:45:07]             [35mbackend[0m : [92mdecord[0m
[03/06 08:45:07]             [35mname[0m : [92mVideoDecoder[0m
[03/06 08:45:07]         [35mname[0m : [92mBasePipline[0m
[03/06 08:45:07]         [35msample[0m : 
[03/06 08:45:07]             [35mclip_seg_num[0m : [92m8[0m
[03/06 08:45:07]             [35mis_train[0m : [92mFalse[0m
[03/06 08:45:07]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 08:45:07]             [35msample_mode[0m : [92muniform[0m
[03/06 08:45:07]             [35msample_rate[0m : [92m4[0m
[03/06 08:45:07]             [35msliding_window[0m : [92m32[0m
[03/06 08:45:07]         [35mtransform[0m : 
[03/06 08:45:07]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 08:45:07]             [35mtransform_list[0m : 
[03/06 08:45:07]                 [35mResize[0m : 
[03/06 08:45:07]                     [35msize[0m : [92m[224, 224][0m
[03/06 08:45:07]                 [35mCenterCrop[0m : 
[03/06 08:45:07]                     [35msize[0m : [92m224[0m
[03/06 08:45:07]                 [35mToTensor[0m : [92mNone[0m
[03/06 08:45:07]                 [35mNormalize[0m : 
[03/06 08:45:07]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 08:45:07]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 08:45:07]     [35mtrain[0m : 
[03/06 08:45:07]         [35mdecode[0m : 
[03/06 08:45:07]             [35mbackend[0m : [92mdecord[0m
[03/06 08:45:07]             [35mname[0m : [92mVideoDecoder[0m
[03/06 08:45:07]         [35mname[0m : [92mBasePipline[0m
[03/06 08:45:07]         [35msample[0m : 
[03/06 08:45:07]             [35mclip_seg_num[0m : [92m8[0m
[03/06 08:45:07]             [35mis_train[0m : [92mTrue[0m
[03/06 08:45:07]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 08:45:07]             [35msample_mode[0m : [92muniform[0m
[03/06 08:45:07]             [35msample_rate[0m : [92m4[0m
[03/06 08:45:07]             [35msliding_window[0m : [92m32[0m
[03/06 08:45:07]         [35mtransform[0m : 
[03/06 08:45:07]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 08:45:07]             [35mtransform_list[0m : 
[03/06 08:45:07]                 [35mResize[0m : 
[03/06 08:45:07]                     [35msize[0m : [92m[224, 224][0m
[03/06 08:45:07]                 [35mRandomCrop[0m : 
[03/06 08:45:07]                     [35msize[0m : [92m224[0m
[03/06 08:45:07]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 08:45:07]                 [35mToTensor[0m : [92mNone[0m
[03/06 08:45:07]                 [35mNormalize[0m : 
[03/06 08:45:07]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 08:45:07]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 08:45:07] ------------------------------------------------------------
[03/06 08:45:07] [35mPOSTPRECESSING[0m : 
[03/06 08:45:07]     [35mclip_seg_num[0m : [92m8[0m
[03/06 08:45:07]     [35mignore_index[0m : [92m-100[0m
[03/06 08:45:07]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 08:45:07]     [35mnum_action_classes[0m : [92m5[0m
[03/06 08:45:07]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 08:45:07]     [35msample_rate[0m : [92m4[0m
[03/06 08:45:07]     [35msliding_window[0m : [92m32[0m
[03/06 08:45:07] ------------------------------------------------------------
[03/06 08:45:07] [35mepochs[0m : [92m200[0m
[03/06 08:45:07] [35mlog_interval[0m : [92m1[0m
[03/06 08:45:07] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 08:45:07] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 202, in train
    runner.run_one_iter(data=data, r_tic=r_tic, epoch=epoch)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 330, in run_one_iter
    self.run_one_clip(sliding_seg)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 291, in run_one_clip
    with self.model.no_sync():
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1729, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'StreamSegmentation2DMultiLabel' object has no attribute 'no_sync'
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 09:37:30] [35mCOLLATE[0m : 
[03/06 09:37:30]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 09:37:30]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 09:37:30] ------------------------------------------------------------
[03/06 09:37:30] [35mDATASET[0m : 
[03/06 09:37:30]     [35mnum_workers[0m : [92m0[0m
[03/06 09:37:30]     [35mtemporal_clip_batch_size[0m : [92m4[0m
[03/06 09:37:30]     [35mtest[0m : 
[03/06 09:37:30]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 09:37:30]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 09:37:30]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:37:30]         [35mdata_prefix[0m : [92m./[0m
[03/06 09:37:30]         [35mdataset_type[0m : [92mgtea[0m
[03/06 09:37:30]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 09:37:30]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 09:37:30]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 09:37:30]         [35msample_rate[0m : [92m4[0m
[03/06 09:37:30]         [35msliding_window[0m : [92m32[0m
[03/06 09:37:30]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 09:37:30]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 09:37:30]     [35mtrain[0m : 
[03/06 09:37:30]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 09:37:30]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 09:37:30]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:37:30]         [35mdata_prefix[0m : [92m./[0m
[03/06 09:37:30]         [35mdataset_type[0m : [92mgtea[0m
[03/06 09:37:30]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 09:37:30]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 09:37:30]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 09:37:30]         [35msample_rate[0m : [92m4[0m
[03/06 09:37:30]         [35msliding_window[0m : [92m32[0m
[03/06 09:37:30]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 09:37:30]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 09:37:30]     [35mvideo_batch_size[0m : [92m16[0m
[03/06 09:37:30] ------------------------------------------------------------
[03/06 09:37:30] [35mLRSCHEDULER[0m : 
[03/06 09:37:30]     [35mgamma[0m : [92m0.1[0m
[03/06 09:37:30]     [35mname[0m : [92mMultiStepLR[0m
[03/06 09:37:30]     [35mstep_size[0m : [92m[50][0m
[03/06 09:37:30] ------------------------------------------------------------
[03/06 09:37:30] [35mMETRIC[0m : 
[03/06 09:37:30]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 09:37:30]     [35mfile_output[0m : [92mTrue[0m
[03/06 09:37:30]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 09:37:30]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 09:37:30]     [35mscore_output[0m : [92mTrue[0m
[03/06 09:37:30] ------------------------------------------------------------
[03/06 09:37:30] [35mMODEL[0m : 
[03/06 09:37:30]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 09:37:30]     [35mbackbone[0m : 
[03/06 09:37:30]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:37:30]         [35mname[0m : [92mResNetTSM[0m
[03/06 09:37:30]         [35mout_indices[0m : [92m(3,)[0m
[03/06 09:37:30]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 09:37:30]         [35mshift_div[0m : [92m8[0m
[03/06 09:37:30]     [35mhead[0m : 
[03/06 09:37:30]         [35maction_head[0m : 
[03/06 09:37:30]             [35mdim[0m : [92m2048[0m
[03/06 09:37:30]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 09:37:30]             [35mnum_classes[0m : [92m5[0m
[03/06 09:37:30]             [35mnum_f_maps[0m : [92m64[0m
[03/06 09:37:30]             [35mnum_layers[0m : [92m4[0m
[03/06 09:37:30]             [35mnum_stages[0m : [92m1[0m
[03/06 09:37:30]             [35msample_rate[0m : [92m4[0m
[03/06 09:37:30]         [35mbranch_head[0m : 
[03/06 09:37:30]             [35mdim[0m : [92m2048[0m
[03/06 09:37:30]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 09:37:30]             [35mnum_classes[0m : [92m15[0m
[03/06 09:37:30]             [35mnum_f_maps[0m : [92m64[0m
[03/06 09:37:30]             [35mnum_layers[0m : [92m4[0m
[03/06 09:37:30]             [35mnum_stages[0m : [92m1[0m
[03/06 09:37:30]             [35msample_rate[0m : [92m4[0m
[03/06 09:37:30]         [35msample_rate[0m : [92m4[0m
[03/06 09:37:30]     [35mloss[0m : 
[03/06 09:37:30]         [35mignore_index[0m : [92m-100[0m
[03/06 09:37:30]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 09:37:30]         [35mnum_classes_action[0m : [92m5[0m
[03/06 09:37:30]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 09:37:30]         [35msample_rate[0m : [92m4[0m
[03/06 09:37:30]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 09:37:30]     [35mneck[0m : 
[03/06 09:37:30]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:37:30]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 09:37:30]         [35min_channels[0m : [92m2048[0m
[03/06 09:37:30]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 09:37:30]         [35mneed_pool[0m : [92mTrue[0m
[03/06 09:37:30]         [35mnum_classes[0m : [92m20[0m
[03/06 09:37:30] ------------------------------------------------------------
[03/06 09:37:30] [35mOPTIMIZER[0m : 
[03/06 09:37:30]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 09:37:30]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 09:37:30]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 09:37:30]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 09:37:30] ------------------------------------------------------------
[03/06 09:37:30] [35mPIPELINE[0m : 
[03/06 09:37:30]     [35mtest[0m : 
[03/06 09:37:30]         [35mdecode[0m : 
[03/06 09:37:30]             [35mbackend[0m : [92mdecord[0m
[03/06 09:37:30]             [35mname[0m : [92mVideoDecoder[0m
[03/06 09:37:30]         [35mname[0m : [92mBasePipline[0m
[03/06 09:37:30]         [35msample[0m : 
[03/06 09:37:30]             [35mclip_seg_num[0m : [92m8[0m
[03/06 09:37:30]             [35mis_train[0m : [92mFalse[0m
[03/06 09:37:30]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 09:37:30]             [35msample_mode[0m : [92muniform[0m
[03/06 09:37:30]             [35msample_rate[0m : [92m4[0m
[03/06 09:37:30]             [35msliding_window[0m : [92m32[0m
[03/06 09:37:30]         [35mtransform[0m : 
[03/06 09:37:30]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 09:37:30]             [35mtransform_list[0m : 
[03/06 09:37:30]                 [35mResize[0m : 
[03/06 09:37:30]                     [35msize[0m : [92m[224, 224][0m
[03/06 09:37:30]                 [35mCenterCrop[0m : 
[03/06 09:37:30]                     [35msize[0m : [92m224[0m
[03/06 09:37:30]                 [35mToTensor[0m : [92mNone[0m
[03/06 09:37:30]                 [35mNormalize[0m : 
[03/06 09:37:30]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 09:37:30]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 09:37:30]     [35mtrain[0m : 
[03/06 09:37:30]         [35mdecode[0m : 
[03/06 09:37:30]             [35mbackend[0m : [92mdecord[0m
[03/06 09:37:30]             [35mname[0m : [92mVideoDecoder[0m
[03/06 09:37:30]         [35mname[0m : [92mBasePipline[0m
[03/06 09:37:30]         [35msample[0m : 
[03/06 09:37:30]             [35mclip_seg_num[0m : [92m8[0m
[03/06 09:37:30]             [35mis_train[0m : [92mTrue[0m
[03/06 09:37:30]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 09:37:30]             [35msample_mode[0m : [92muniform[0m
[03/06 09:37:30]             [35msample_rate[0m : [92m4[0m
[03/06 09:37:30]             [35msliding_window[0m : [92m32[0m
[03/06 09:37:30]         [35mtransform[0m : 
[03/06 09:37:30]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 09:37:30]             [35mtransform_list[0m : 
[03/06 09:37:30]                 [35mResize[0m : 
[03/06 09:37:30]                     [35msize[0m : [92m[224, 224][0m
[03/06 09:37:30]                 [35mRandomCrop[0m : 
[03/06 09:37:30]                     [35msize[0m : [92m224[0m
[03/06 09:37:30]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 09:37:30]                 [35mToTensor[0m : [92mNone[0m
[03/06 09:37:30]                 [35mNormalize[0m : 
[03/06 09:37:30]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 09:37:30]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 09:37:30] ------------------------------------------------------------
[03/06 09:37:30] [35mPOSTPRECESSING[0m : 
[03/06 09:37:30]     [35mclip_seg_num[0m : [92m8[0m
[03/06 09:37:30]     [35mignore_index[0m : [92m-100[0m
[03/06 09:37:30]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 09:37:30]     [35mnum_action_classes[0m : [92m5[0m
[03/06 09:37:30]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 09:37:30]     [35msample_rate[0m : [92m4[0m
[03/06 09:37:30]     [35msliding_window[0m : [92m32[0m
[03/06 09:37:30] ------------------------------------------------------------
[03/06 09:37:30] [35mepochs[0m : [92m200[0m
[03/06 09:37:30] [35mlog_interval[0m : [92m1[0m
[03/06 09:37:30] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 09:37:30] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 202, in train
    runner.run_one_iter(data=data, r_tic=r_tic, epoch=epoch)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 336, in run_one_iter
    self.run_one_clip(sliding_seg)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 302, in run_one_clip
    score, loss_dict = self._model_forward(data_dict)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 257, in _model_forward
    outputs = self.model(input_data)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py", line 246, in forward
    feature = self.backbone(imgs, backbone_masks)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/model/backbones/image/resnet.py", line 575, in forward
    x = res_layer(x) * masks
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/container.py", line 219, in forward
    input = module(input)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/model/backbones/image/resnet.py", line 234, in forward
    out = _inner_forward(x)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/model/backbones/image/resnet.py", line 225, in _inner_forward
    identity = self.downsample(x)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/conv_module.py", line 207, in forward
    x = self.conv(x)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1553, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1562, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/wrappers.py", line 59, in forward
    return super().forward(x)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 458, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 454, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 98.00 MiB. GPU 0 has a total capacity of 23.69 GiB of which 72.81 MiB is free. Including non-PyTorch memory, this process has 11.80 GiB memory in use. Process 551339 has 11.80 GiB memory in use. Of the allocated memory 11.45 GiB is allocated by PyTorch, and 54.35 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
usage: SVTAS train script [-h] [-c CONFIG] [--test] [-o OVERRIDE] [-w WEIGHTS]
                          [--local_rank LOCAL_RANK] [--validate]
                          [--use_amp USE_AMP]
                          [--use_tensorboard USE_TENSORBOARD] [--seed SEED]
                          [--max_iters MAX_ITERS] [--launcher {none,pytorch}]
SVTAS train script: error: argument --seed: invalid int value: '43335n'
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 09:40:09] [35mCOLLATE[0m : 
[03/06 09:40:09]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 09:40:09]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 09:40:09] ------------------------------------------------------------
[03/06 09:40:09] [35mDATASET[0m : 
[03/06 09:40:09]     [35mnum_workers[0m : [92m0[0m
[03/06 09:40:09]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 09:40:09]     [35mtest[0m : 
[03/06 09:40:09]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 09:40:09]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 09:40:09]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:40:09]         [35mdata_prefix[0m : [92m./[0m
[03/06 09:40:09]         [35mdataset_type[0m : [92mgtea[0m
[03/06 09:40:09]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 09:40:09]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 09:40:09]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 09:40:09]         [35msample_rate[0m : [92m4[0m
[03/06 09:40:09]         [35msliding_window[0m : [92m32[0m
[03/06 09:40:09]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 09:40:09]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 09:40:09]     [35mtrain[0m : 
[03/06 09:40:09]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 09:40:09]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 09:40:09]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:40:09]         [35mdata_prefix[0m : [92m./[0m
[03/06 09:40:09]         [35mdataset_type[0m : [92mgtea[0m
[03/06 09:40:09]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 09:40:09]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 09:40:09]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 09:40:09]         [35msample_rate[0m : [92m4[0m
[03/06 09:40:09]         [35msliding_window[0m : [92m32[0m
[03/06 09:40:09]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 09:40:09]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 09:40:09]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 09:40:09] ------------------------------------------------------------
[03/06 09:40:09] [35mLRSCHEDULER[0m : 
[03/06 09:40:09]     [35mgamma[0m : [92m0.1[0m
[03/06 09:40:09]     [35mname[0m : [92mMultiStepLR[0m
[03/06 09:40:09]     [35mstep_size[0m : [92m[50][0m
[03/06 09:40:09] ------------------------------------------------------------
[03/06 09:40:09] [35mMETRIC[0m : 
[03/06 09:40:09]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 09:40:09]     [35mfile_output[0m : [92mTrue[0m
[03/06 09:40:09]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 09:40:09]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 09:40:09]     [35mscore_output[0m : [92mTrue[0m
[03/06 09:40:09] ------------------------------------------------------------
[03/06 09:40:09] [35mMODEL[0m : 
[03/06 09:40:09]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 09:40:09]     [35mbackbone[0m : 
[03/06 09:40:09]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:40:09]         [35mname[0m : [92mResNetTSM[0m
[03/06 09:40:09]         [35mout_indices[0m : [92m(3,)[0m
[03/06 09:40:09]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 09:40:09]         [35mshift_div[0m : [92m8[0m
[03/06 09:40:09]     [35mhead[0m : 
[03/06 09:40:09]         [35maction_head[0m : 
[03/06 09:40:09]             [35mdim[0m : [92m2048[0m
[03/06 09:40:09]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 09:40:09]             [35mnum_classes[0m : [92m5[0m
[03/06 09:40:09]             [35mnum_f_maps[0m : [92m64[0m
[03/06 09:40:09]             [35mnum_layers[0m : [92m4[0m
[03/06 09:40:09]             [35mnum_stages[0m : [92m1[0m
[03/06 09:40:09]             [35msample_rate[0m : [92m4[0m
[03/06 09:40:09]         [35mbranch_head[0m : 
[03/06 09:40:09]             [35mdim[0m : [92m2048[0m
[03/06 09:40:09]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 09:40:09]             [35mnum_classes[0m : [92m15[0m
[03/06 09:40:09]             [35mnum_f_maps[0m : [92m64[0m
[03/06 09:40:09]             [35mnum_layers[0m : [92m4[0m
[03/06 09:40:09]             [35mnum_stages[0m : [92m1[0m
[03/06 09:40:09]             [35msample_rate[0m : [92m4[0m
[03/06 09:40:09]         [35msample_rate[0m : [92m4[0m
[03/06 09:40:09]     [35mloss[0m : 
[03/06 09:40:09]         [35mignore_index[0m : [92m-100[0m
[03/06 09:40:09]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 09:40:09]         [35mnum_classes_action[0m : [92m5[0m
[03/06 09:40:09]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 09:40:09]         [35msample_rate[0m : [92m4[0m
[03/06 09:40:09]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 09:40:09]     [35mneck[0m : 
[03/06 09:40:09]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:40:09]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 09:40:09]         [35min_channels[0m : [92m2048[0m
[03/06 09:40:09]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 09:40:09]         [35mneed_pool[0m : [92mTrue[0m
[03/06 09:40:09]         [35mnum_classes[0m : [92m20[0m
[03/06 09:40:09] ------------------------------------------------------------
[03/06 09:40:09] [35mOPTIMIZER[0m : 
[03/06 09:40:09]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 09:40:09]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 09:40:09]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 09:40:09]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 09:40:09] ------------------------------------------------------------
[03/06 09:40:09] [35mPIPELINE[0m : 
[03/06 09:40:09]     [35mtest[0m : 
[03/06 09:40:09]         [35mdecode[0m : 
[03/06 09:40:09]             [35mbackend[0m : [92mdecord[0m
[03/06 09:40:09]             [35mname[0m : [92mVideoDecoder[0m
[03/06 09:40:09]         [35mname[0m : [92mBasePipline[0m
[03/06 09:40:09]         [35msample[0m : 
[03/06 09:40:09]             [35mclip_seg_num[0m : [92m8[0m
[03/06 09:40:09]             [35mis_train[0m : [92mFalse[0m
[03/06 09:40:09]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 09:40:09]             [35msample_mode[0m : [92muniform[0m
[03/06 09:40:09]             [35msample_rate[0m : [92m4[0m
[03/06 09:40:09]             [35msliding_window[0m : [92m32[0m
[03/06 09:40:09]         [35mtransform[0m : 
[03/06 09:40:09]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 09:40:09]             [35mtransform_list[0m : 
[03/06 09:40:09]                 [35mResize[0m : 
[03/06 09:40:09]                     [35msize[0m : [92m[224, 224][0m
[03/06 09:40:09]                 [35mCenterCrop[0m : 
[03/06 09:40:09]                     [35msize[0m : [92m224[0m
[03/06 09:40:09]                 [35mToTensor[0m : [92mNone[0m
[03/06 09:40:09]                 [35mNormalize[0m : 
[03/06 09:40:09]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 09:40:09]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 09:40:09]     [35mtrain[0m : 
[03/06 09:40:09]         [35mdecode[0m : 
[03/06 09:40:09]             [35mbackend[0m : [92mdecord[0m
[03/06 09:40:09]             [35mname[0m : [92mVideoDecoder[0m
[03/06 09:40:09]         [35mname[0m : [92mBasePipline[0m
[03/06 09:40:09]         [35msample[0m : 
[03/06 09:40:09]             [35mclip_seg_num[0m : [92m8[0m
[03/06 09:40:09]             [35mis_train[0m : [92mTrue[0m
[03/06 09:40:09]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 09:40:09]             [35msample_mode[0m : [92muniform[0m
[03/06 09:40:09]             [35msample_rate[0m : [92m4[0m
[03/06 09:40:09]             [35msliding_window[0m : [92m32[0m
[03/06 09:40:09]         [35mtransform[0m : 
[03/06 09:40:09]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 09:40:09]             [35mtransform_list[0m : 
[03/06 09:40:09]                 [35mResize[0m : 
[03/06 09:40:09]                     [35msize[0m : [92m[224, 224][0m
[03/06 09:40:09]                 [35mRandomCrop[0m : 
[03/06 09:40:09]                     [35msize[0m : [92m224[0m
[03/06 09:40:09]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 09:40:09]                 [35mToTensor[0m : [92mNone[0m
[03/06 09:40:09]                 [35mNormalize[0m : 
[03/06 09:40:09]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 09:40:09]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 09:40:09] ------------------------------------------------------------
[03/06 09:40:09] [35mPOSTPRECESSING[0m : 
[03/06 09:40:09]     [35mclip_seg_num[0m : [92m8[0m
[03/06 09:40:09]     [35mignore_index[0m : [92m-100[0m
[03/06 09:40:09]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 09:40:09]     [35mnum_action_classes[0m : [92m5[0m
[03/06 09:40:09]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 09:40:09]     [35msample_rate[0m : [92m4[0m
[03/06 09:40:09]     [35msliding_window[0m : [92m32[0m
[03/06 09:40:09] ------------------------------------------------------------
[03/06 09:40:09] [35mepochs[0m : [92m200[0m
[03/06 09:40:09] [35mlog_interval[0m : [92m1[0m
[03/06 09:40:09] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 09:40:09] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 202, in train
    runner.run_one_iter(data=data, r_tic=r_tic, epoch=epoch)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 333, in run_one_iter
    self.batch_end_step(sliding_num=sliding_num, vid_list=vid_list, step=step, epoch=epoch)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 121, in batch_end_step
    self.model.module._clear_memory_buffer()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1729, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'StreamSegmentation2DMultiLabel' object has no attribute 'module'
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 09:41:21] [35mCOLLATE[0m : 
[03/06 09:41:21]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 09:41:21]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 09:41:21] ------------------------------------------------------------
[03/06 09:41:21] [35mDATASET[0m : 
[03/06 09:41:21]     [35mnum_workers[0m : [92m0[0m
[03/06 09:41:21]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 09:41:21]     [35mtest[0m : 
[03/06 09:41:21]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 09:41:21]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 09:41:21]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:41:21]         [35mdata_prefix[0m : [92m./[0m
[03/06 09:41:21]         [35mdataset_type[0m : [92mgtea[0m
[03/06 09:41:21]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 09:41:21]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 09:41:21]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 09:41:21]         [35msample_rate[0m : [92m4[0m
[03/06 09:41:21]         [35msliding_window[0m : [92m32[0m
[03/06 09:41:21]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 09:41:21]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 09:41:21]     [35mtrain[0m : 
[03/06 09:41:21]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 09:41:21]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 09:41:21]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:41:21]         [35mdata_prefix[0m : [92m./[0m
[03/06 09:41:21]         [35mdataset_type[0m : [92mgtea[0m
[03/06 09:41:21]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 09:41:21]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 09:41:21]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 09:41:21]         [35msample_rate[0m : [92m4[0m
[03/06 09:41:21]         [35msliding_window[0m : [92m32[0m
[03/06 09:41:21]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 09:41:21]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 09:41:21]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 09:41:21] ------------------------------------------------------------
[03/06 09:41:21] [35mLRSCHEDULER[0m : 
[03/06 09:41:21]     [35mgamma[0m : [92m0.1[0m
[03/06 09:41:21]     [35mname[0m : [92mMultiStepLR[0m
[03/06 09:41:21]     [35mstep_size[0m : [92m[50][0m
[03/06 09:41:21] ------------------------------------------------------------
[03/06 09:41:21] [35mMETRIC[0m : 
[03/06 09:41:21]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 09:41:21]     [35mfile_output[0m : [92mTrue[0m
[03/06 09:41:21]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 09:41:21]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 09:41:21]     [35mscore_output[0m : [92mTrue[0m
[03/06 09:41:21] ------------------------------------------------------------
[03/06 09:41:21] [35mMODEL[0m : 
[03/06 09:41:21]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 09:41:21]     [35mbackbone[0m : 
[03/06 09:41:21]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:41:21]         [35mname[0m : [92mResNetTSM[0m
[03/06 09:41:21]         [35mout_indices[0m : [92m(3,)[0m
[03/06 09:41:21]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 09:41:21]         [35mshift_div[0m : [92m8[0m
[03/06 09:41:21]     [35mhead[0m : 
[03/06 09:41:21]         [35maction_head[0m : 
[03/06 09:41:21]             [35mdim[0m : [92m2048[0m
[03/06 09:41:21]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 09:41:21]             [35mnum_classes[0m : [92m5[0m
[03/06 09:41:21]             [35mnum_f_maps[0m : [92m64[0m
[03/06 09:41:21]             [35mnum_layers[0m : [92m4[0m
[03/06 09:41:21]             [35mnum_stages[0m : [92m1[0m
[03/06 09:41:21]             [35msample_rate[0m : [92m4[0m
[03/06 09:41:21]         [35mbranch_head[0m : 
[03/06 09:41:21]             [35mdim[0m : [92m2048[0m
[03/06 09:41:21]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 09:41:21]             [35mnum_classes[0m : [92m15[0m
[03/06 09:41:21]             [35mnum_f_maps[0m : [92m64[0m
[03/06 09:41:21]             [35mnum_layers[0m : [92m4[0m
[03/06 09:41:21]             [35mnum_stages[0m : [92m1[0m
[03/06 09:41:21]             [35msample_rate[0m : [92m4[0m
[03/06 09:41:21]         [35msample_rate[0m : [92m4[0m
[03/06 09:41:21]     [35mloss[0m : 
[03/06 09:41:21]         [35mignore_index[0m : [92m-100[0m
[03/06 09:41:21]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 09:41:21]         [35mnum_classes_action[0m : [92m5[0m
[03/06 09:41:21]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 09:41:21]         [35msample_rate[0m : [92m4[0m
[03/06 09:41:21]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 09:41:21]     [35mneck[0m : 
[03/06 09:41:21]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:41:21]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 09:41:21]         [35min_channels[0m : [92m2048[0m
[03/06 09:41:21]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 09:41:21]         [35mneed_pool[0m : [92mTrue[0m
[03/06 09:41:21]         [35mnum_classes[0m : [92m20[0m
[03/06 09:41:21] ------------------------------------------------------------
[03/06 09:41:21] [35mOPTIMIZER[0m : 
[03/06 09:41:21]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 09:41:21]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 09:41:21]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 09:41:21]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 09:41:21] ------------------------------------------------------------
[03/06 09:41:21] [35mPIPELINE[0m : 
[03/06 09:41:21]     [35mtest[0m : 
[03/06 09:41:21]         [35mdecode[0m : 
[03/06 09:41:21]             [35mbackend[0m : [92mdecord[0m
[03/06 09:41:21]             [35mname[0m : [92mVideoDecoder[0m
[03/06 09:41:21]         [35mname[0m : [92mBasePipline[0m
[03/06 09:41:21]         [35msample[0m : 
[03/06 09:41:21]             [35mclip_seg_num[0m : [92m8[0m
[03/06 09:41:21]             [35mis_train[0m : [92mFalse[0m
[03/06 09:41:21]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 09:41:21]             [35msample_mode[0m : [92muniform[0m
[03/06 09:41:21]             [35msample_rate[0m : [92m4[0m
[03/06 09:41:21]             [35msliding_window[0m : [92m32[0m
[03/06 09:41:21]         [35mtransform[0m : 
[03/06 09:41:21]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 09:41:21]             [35mtransform_list[0m : 
[03/06 09:41:21]                 [35mResize[0m : 
[03/06 09:41:21]                     [35msize[0m : [92m[224, 224][0m
[03/06 09:41:21]                 [35mCenterCrop[0m : 
[03/06 09:41:21]                     [35msize[0m : [92m224[0m
[03/06 09:41:21]                 [35mToTensor[0m : [92mNone[0m
[03/06 09:41:21]                 [35mNormalize[0m : 
[03/06 09:41:21]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 09:41:21]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 09:41:21]     [35mtrain[0m : 
[03/06 09:41:21]         [35mdecode[0m : 
[03/06 09:41:21]             [35mbackend[0m : [92mdecord[0m
[03/06 09:41:21]             [35mname[0m : [92mVideoDecoder[0m
[03/06 09:41:21]         [35mname[0m : [92mBasePipline[0m
[03/06 09:41:21]         [35msample[0m : 
[03/06 09:41:21]             [35mclip_seg_num[0m : [92m8[0m
[03/06 09:41:21]             [35mis_train[0m : [92mTrue[0m
[03/06 09:41:21]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 09:41:21]             [35msample_mode[0m : [92muniform[0m
[03/06 09:41:21]             [35msample_rate[0m : [92m4[0m
[03/06 09:41:21]             [35msliding_window[0m : [92m32[0m
[03/06 09:41:21]         [35mtransform[0m : 
[03/06 09:41:21]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 09:41:21]             [35mtransform_list[0m : 
[03/06 09:41:21]                 [35mResize[0m : 
[03/06 09:41:21]                     [35msize[0m : [92m[224, 224][0m
[03/06 09:41:21]                 [35mRandomCrop[0m : 
[03/06 09:41:21]                     [35msize[0m : [92m224[0m
[03/06 09:41:21]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 09:41:21]                 [35mToTensor[0m : [92mNone[0m
[03/06 09:41:21]                 [35mNormalize[0m : 
[03/06 09:41:21]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 09:41:21]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 09:41:21] ------------------------------------------------------------
[03/06 09:41:21] [35mPOSTPRECESSING[0m : 
[03/06 09:41:21]     [35mclip_seg_num[0m : [92m8[0m
[03/06 09:41:21]     [35mignore_index[0m : [92m-100[0m
[03/06 09:41:21]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 09:41:21]     [35mnum_action_classes[0m : [92m5[0m
[03/06 09:41:21]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 09:41:21]     [35msample_rate[0m : [92m4[0m
[03/06 09:41:21]     [35msliding_window[0m : [92m32[0m
[03/06 09:41:21] ------------------------------------------------------------
[03/06 09:41:21] [35mepochs[0m : [92m200[0m
[03/06 09:41:21] [35mlog_interval[0m : [92m1[0m
[03/06 09:41:21] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 09:41:21] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 202, in train
    runner.run_one_iter(data=data, r_tic=r_tic, epoch=epoch)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 333, in run_one_iter
    self.batch_end_step(sliding_num=sliding_num, vid_list=vid_list, step=step, epoch=epoch)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 121, in batch_end_step
    self.model.module._clear_memory_buffer()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1729, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'StreamSegmentation2DMultiLabel' object has no attribute 'module'
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 09:42:53] [35mCOLLATE[0m : 
[03/06 09:42:53]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 09:42:53]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 09:42:53] ------------------------------------------------------------
[03/06 09:42:53] [35mDATASET[0m : 
[03/06 09:42:53]     [35mnum_workers[0m : [92m0[0m
[03/06 09:42:53]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 09:42:53]     [35mtest[0m : 
[03/06 09:42:53]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 09:42:53]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 09:42:53]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:42:53]         [35mdata_prefix[0m : [92m./[0m
[03/06 09:42:53]         [35mdataset_type[0m : [92mgtea[0m
[03/06 09:42:53]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 09:42:53]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 09:42:53]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 09:42:53]         [35msample_rate[0m : [92m4[0m
[03/06 09:42:53]         [35msliding_window[0m : [92m32[0m
[03/06 09:42:53]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 09:42:53]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 09:42:53]     [35mtrain[0m : 
[03/06 09:42:53]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 09:42:53]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 09:42:53]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:42:53]         [35mdata_prefix[0m : [92m./[0m
[03/06 09:42:53]         [35mdataset_type[0m : [92mgtea[0m
[03/06 09:42:53]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 09:42:53]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 09:42:53]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 09:42:53]         [35msample_rate[0m : [92m4[0m
[03/06 09:42:53]         [35msliding_window[0m : [92m32[0m
[03/06 09:42:53]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 09:42:53]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 09:42:53]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 09:42:53] ------------------------------------------------------------
[03/06 09:42:53] [35mLRSCHEDULER[0m : 
[03/06 09:42:53]     [35mgamma[0m : [92m0.1[0m
[03/06 09:42:53]     [35mname[0m : [92mMultiStepLR[0m
[03/06 09:42:53]     [35mstep_size[0m : [92m[50][0m
[03/06 09:42:53] ------------------------------------------------------------
[03/06 09:42:53] [35mMETRIC[0m : 
[03/06 09:42:53]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 09:42:53]     [35mfile_output[0m : [92mTrue[0m
[03/06 09:42:53]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 09:42:53]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 09:42:53]     [35mscore_output[0m : [92mTrue[0m
[03/06 09:42:53] ------------------------------------------------------------
[03/06 09:42:53] [35mMODEL[0m : 
[03/06 09:42:53]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 09:42:53]     [35mbackbone[0m : 
[03/06 09:42:53]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:42:53]         [35mname[0m : [92mResNetTSM[0m
[03/06 09:42:53]         [35mout_indices[0m : [92m(3,)[0m
[03/06 09:42:53]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 09:42:53]         [35mshift_div[0m : [92m8[0m
[03/06 09:42:53]     [35mhead[0m : 
[03/06 09:42:53]         [35maction_head[0m : 
[03/06 09:42:53]             [35mdim[0m : [92m2048[0m
[03/06 09:42:53]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 09:42:53]             [35mnum_classes[0m : [92m5[0m
[03/06 09:42:53]             [35mnum_f_maps[0m : [92m64[0m
[03/06 09:42:53]             [35mnum_layers[0m : [92m4[0m
[03/06 09:42:53]             [35mnum_stages[0m : [92m1[0m
[03/06 09:42:53]             [35msample_rate[0m : [92m4[0m
[03/06 09:42:53]         [35mbranch_head[0m : 
[03/06 09:42:53]             [35mdim[0m : [92m2048[0m
[03/06 09:42:53]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 09:42:53]             [35mnum_classes[0m : [92m15[0m
[03/06 09:42:53]             [35mnum_f_maps[0m : [92m64[0m
[03/06 09:42:53]             [35mnum_layers[0m : [92m4[0m
[03/06 09:42:53]             [35mnum_stages[0m : [92m1[0m
[03/06 09:42:53]             [35msample_rate[0m : [92m4[0m
[03/06 09:42:53]         [35msample_rate[0m : [92m4[0m
[03/06 09:42:53]     [35mloss[0m : 
[03/06 09:42:53]         [35mignore_index[0m : [92m-100[0m
[03/06 09:42:53]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 09:42:53]         [35mnum_classes_action[0m : [92m5[0m
[03/06 09:42:53]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 09:42:53]         [35msample_rate[0m : [92m4[0m
[03/06 09:42:53]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 09:42:53]     [35mneck[0m : 
[03/06 09:42:53]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:42:53]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 09:42:53]         [35min_channels[0m : [92m2048[0m
[03/06 09:42:53]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 09:42:53]         [35mneed_pool[0m : [92mTrue[0m
[03/06 09:42:53]         [35mnum_classes[0m : [92m20[0m
[03/06 09:42:53] ------------------------------------------------------------
[03/06 09:42:53] [35mOPTIMIZER[0m : 
[03/06 09:42:53]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 09:42:53]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 09:42:53]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 09:42:53]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 09:42:53] ------------------------------------------------------------
[03/06 09:42:53] [35mPIPELINE[0m : 
[03/06 09:42:53]     [35mtest[0m : 
[03/06 09:42:53]         [35mdecode[0m : 
[03/06 09:42:53]             [35mbackend[0m : [92mdecord[0m
[03/06 09:42:53]             [35mname[0m : [92mVideoDecoder[0m
[03/06 09:42:53]         [35mname[0m : [92mBasePipline[0m
[03/06 09:42:53]         [35msample[0m : 
[03/06 09:42:53]             [35mclip_seg_num[0m : [92m8[0m
[03/06 09:42:53]             [35mis_train[0m : [92mFalse[0m
[03/06 09:42:53]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 09:42:53]             [35msample_mode[0m : [92muniform[0m
[03/06 09:42:53]             [35msample_rate[0m : [92m4[0m
[03/06 09:42:53]             [35msliding_window[0m : [92m32[0m
[03/06 09:42:53]         [35mtransform[0m : 
[03/06 09:42:53]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 09:42:53]             [35mtransform_list[0m : 
[03/06 09:42:53]                 [35mResize[0m : 
[03/06 09:42:53]                     [35msize[0m : [92m[224, 224][0m
[03/06 09:42:53]                 [35mCenterCrop[0m : 
[03/06 09:42:53]                     [35msize[0m : [92m224[0m
[03/06 09:42:53]                 [35mToTensor[0m : [92mNone[0m
[03/06 09:42:53]                 [35mNormalize[0m : 
[03/06 09:42:53]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 09:42:53]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 09:42:53]     [35mtrain[0m : 
[03/06 09:42:53]         [35mdecode[0m : 
[03/06 09:42:53]             [35mbackend[0m : [92mdecord[0m
[03/06 09:42:53]             [35mname[0m : [92mVideoDecoder[0m
[03/06 09:42:53]         [35mname[0m : [92mBasePipline[0m
[03/06 09:42:53]         [35msample[0m : 
[03/06 09:42:53]             [35mclip_seg_num[0m : [92m8[0m
[03/06 09:42:53]             [35mis_train[0m : [92mTrue[0m
[03/06 09:42:53]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 09:42:53]             [35msample_mode[0m : [92muniform[0m
[03/06 09:42:53]             [35msample_rate[0m : [92m4[0m
[03/06 09:42:53]             [35msliding_window[0m : [92m32[0m
[03/06 09:42:53]         [35mtransform[0m : 
[03/06 09:42:53]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 09:42:53]             [35mtransform_list[0m : 
[03/06 09:42:53]                 [35mResize[0m : 
[03/06 09:42:53]                     [35msize[0m : [92m[224, 224][0m
[03/06 09:42:53]                 [35mRandomCrop[0m : 
[03/06 09:42:53]                     [35msize[0m : [92m224[0m
[03/06 09:42:53]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 09:42:53]                 [35mToTensor[0m : [92mNone[0m
[03/06 09:42:53]                 [35mNormalize[0m : 
[03/06 09:42:53]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 09:42:53]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 09:42:53] ------------------------------------------------------------
[03/06 09:42:53] [35mPOSTPRECESSING[0m : 
[03/06 09:42:53]     [35mclip_seg_num[0m : [92m8[0m
[03/06 09:42:53]     [35mignore_index[0m : [92m-100[0m
[03/06 09:42:53]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 09:42:53]     [35mnum_action_classes[0m : [92m5[0m
[03/06 09:42:53]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 09:42:53]     [35msample_rate[0m : [92m4[0m
[03/06 09:42:53]     [35msliding_window[0m : [92m32[0m
[03/06 09:42:53] ------------------------------------------------------------
[03/06 09:42:53] [35mepochs[0m : [92m200[0m
[03/06 09:42:53] [35mlog_interval[0m : [92m1[0m
[03/06 09:42:53] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 09:42:53] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 202, in train
    runner.run_one_iter(data=data, r_tic=r_tic, epoch=epoch)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 337, in run_one_iter
    self.batch_end_step(sliding_num=sliding_num, vid_list=vid_list, step=step, epoch=epoch)
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 209, in batch_end_step
    torch.distributed.barrier()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/c10d_logger.py", line 79, in wrapper
    return func(*args, **kwargs)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 3925, in barrier
    opts.device = _get_pg_default_device(group)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 669, in _get_pg_default_device
    group = group or _get_default_group()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
    raise ValueError(
ValueError: Default process group has not been initialized, please make sure to call init_process_group.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 09:46:50] [35mCOLLATE[0m : 
[03/06 09:46:50]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 09:46:50]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 09:46:50] ------------------------------------------------------------
[03/06 09:46:50] [35mDATASET[0m : 
[03/06 09:46:50]     [35mnum_workers[0m : [92m0[0m
[03/06 09:46:50]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 09:46:50]     [35mtest[0m : 
[03/06 09:46:50]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 09:46:50]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 09:46:50]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:46:50]         [35mdata_prefix[0m : [92m./[0m
[03/06 09:46:50]         [35mdataset_type[0m : [92mgtea[0m
[03/06 09:46:50]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 09:46:50]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 09:46:50]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 09:46:50]         [35msample_rate[0m : [92m4[0m
[03/06 09:46:50]         [35msliding_window[0m : [92m32[0m
[03/06 09:46:50]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 09:46:50]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 09:46:50]     [35mtrain[0m : 
[03/06 09:46:50]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 09:46:50]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 09:46:50]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:46:50]         [35mdata_prefix[0m : [92m./[0m
[03/06 09:46:50]         [35mdataset_type[0m : [92mgtea[0m
[03/06 09:46:50]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 09:46:50]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 09:46:50]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 09:46:50]         [35msample_rate[0m : [92m4[0m
[03/06 09:46:50]         [35msliding_window[0m : [92m32[0m
[03/06 09:46:50]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 09:46:50]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 09:46:50]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 09:46:50] ------------------------------------------------------------
[03/06 09:46:50] [35mLRSCHEDULER[0m : 
[03/06 09:46:50]     [35mgamma[0m : [92m0.1[0m
[03/06 09:46:50]     [35mname[0m : [92mMultiStepLR[0m
[03/06 09:46:50]     [35mstep_size[0m : [92m[50][0m
[03/06 09:46:50] ------------------------------------------------------------
[03/06 09:46:50] [35mMETRIC[0m : 
[03/06 09:46:50]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 09:46:50]     [35mfile_output[0m : [92mTrue[0m
[03/06 09:46:50]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 09:46:50]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 09:46:50]     [35mscore_output[0m : [92mTrue[0m
[03/06 09:46:50] ------------------------------------------------------------
[03/06 09:46:50] [35mMODEL[0m : 
[03/06 09:46:50]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 09:46:50]     [35mbackbone[0m : 
[03/06 09:46:50]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:46:50]         [35mname[0m : [92mResNetTSM[0m
[03/06 09:46:50]         [35mout_indices[0m : [92m(3,)[0m
[03/06 09:46:50]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 09:46:50]         [35mshift_div[0m : [92m8[0m
[03/06 09:46:50]     [35mhead[0m : 
[03/06 09:46:50]         [35maction_head[0m : 
[03/06 09:46:50]             [35mdim[0m : [92m2048[0m
[03/06 09:46:50]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 09:46:50]             [35mnum_classes[0m : [92m5[0m
[03/06 09:46:50]             [35mnum_f_maps[0m : [92m64[0m
[03/06 09:46:50]             [35mnum_layers[0m : [92m4[0m
[03/06 09:46:50]             [35mnum_stages[0m : [92m1[0m
[03/06 09:46:50]             [35msample_rate[0m : [92m4[0m
[03/06 09:46:50]         [35mbranch_head[0m : 
[03/06 09:46:50]             [35mdim[0m : [92m2048[0m
[03/06 09:46:50]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 09:46:50]             [35mnum_classes[0m : [92m15[0m
[03/06 09:46:50]             [35mnum_f_maps[0m : [92m64[0m
[03/06 09:46:50]             [35mnum_layers[0m : [92m4[0m
[03/06 09:46:50]             [35mnum_stages[0m : [92m1[0m
[03/06 09:46:50]             [35msample_rate[0m : [92m4[0m
[03/06 09:46:50]         [35msample_rate[0m : [92m4[0m
[03/06 09:46:50]     [35mloss[0m : 
[03/06 09:46:50]         [35mignore_index[0m : [92m-100[0m
[03/06 09:46:50]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 09:46:50]         [35mnum_classes_action[0m : [92m5[0m
[03/06 09:46:50]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 09:46:50]         [35msample_rate[0m : [92m4[0m
[03/06 09:46:50]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 09:46:50]     [35mneck[0m : 
[03/06 09:46:50]         [35mclip_seg_num[0m : [92m8[0m
[03/06 09:46:50]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 09:46:50]         [35min_channels[0m : [92m2048[0m
[03/06 09:46:50]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 09:46:50]         [35mneed_pool[0m : [92mTrue[0m
[03/06 09:46:50]         [35mnum_classes[0m : [92m20[0m
[03/06 09:46:50] ------------------------------------------------------------
[03/06 09:46:50] [35mOPTIMIZER[0m : 
[03/06 09:46:50]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 09:46:50]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 09:46:50]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 09:46:50]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 09:46:50] ------------------------------------------------------------
[03/06 09:46:50] [35mPIPELINE[0m : 
[03/06 09:46:50]     [35mtest[0m : 
[03/06 09:46:50]         [35mdecode[0m : 
[03/06 09:46:50]             [35mbackend[0m : [92mdecord[0m
[03/06 09:46:50]             [35mname[0m : [92mVideoDecoder[0m
[03/06 09:46:50]         [35mname[0m : [92mBasePipline[0m
[03/06 09:46:50]         [35msample[0m : 
[03/06 09:46:50]             [35mclip_seg_num[0m : [92m8[0m
[03/06 09:46:50]             [35mis_train[0m : [92mFalse[0m
[03/06 09:46:50]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 09:46:50]             [35msample_mode[0m : [92muniform[0m
[03/06 09:46:50]             [35msample_rate[0m : [92m4[0m
[03/06 09:46:50]             [35msliding_window[0m : [92m32[0m
[03/06 09:46:50]         [35mtransform[0m : 
[03/06 09:46:50]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 09:46:50]             [35mtransform_list[0m : 
[03/06 09:46:50]                 [35mResize[0m : 
[03/06 09:46:50]                     [35msize[0m : [92m[224, 224][0m
[03/06 09:46:50]                 [35mCenterCrop[0m : 
[03/06 09:46:50]                     [35msize[0m : [92m224[0m
[03/06 09:46:50]                 [35mToTensor[0m : [92mNone[0m
[03/06 09:46:50]                 [35mNormalize[0m : 
[03/06 09:46:50]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 09:46:50]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 09:46:50]     [35mtrain[0m : 
[03/06 09:46:50]         [35mdecode[0m : 
[03/06 09:46:50]             [35mbackend[0m : [92mdecord[0m
[03/06 09:46:50]             [35mname[0m : [92mVideoDecoder[0m
[03/06 09:46:50]         [35mname[0m : [92mBasePipline[0m
[03/06 09:46:50]         [35msample[0m : 
[03/06 09:46:50]             [35mclip_seg_num[0m : [92m8[0m
[03/06 09:46:50]             [35mis_train[0m : [92mTrue[0m
[03/06 09:46:50]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 09:46:50]             [35msample_mode[0m : [92muniform[0m
[03/06 09:46:50]             [35msample_rate[0m : [92m4[0m
[03/06 09:46:50]             [35msliding_window[0m : [92m32[0m
[03/06 09:46:50]         [35mtransform[0m : 
[03/06 09:46:50]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 09:46:50]             [35mtransform_list[0m : 
[03/06 09:46:50]                 [35mResize[0m : 
[03/06 09:46:50]                     [35msize[0m : [92m[224, 224][0m
[03/06 09:46:50]                 [35mRandomCrop[0m : 
[03/06 09:46:50]                     [35msize[0m : [92m224[0m
[03/06 09:46:50]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 09:46:50]                 [35mToTensor[0m : [92mNone[0m
[03/06 09:46:50]                 [35mNormalize[0m : 
[03/06 09:46:50]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 09:46:50]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 09:46:50] ------------------------------------------------------------
[03/06 09:46:50] [35mPOSTPRECESSING[0m : 
[03/06 09:46:50]     [35mclip_seg_num[0m : [92m8[0m
[03/06 09:46:50]     [35mignore_index[0m : [92m-100[0m
[03/06 09:46:50]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 09:46:50]     [35mnum_action_classes[0m : [92m5[0m
[03/06 09:46:50]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 09:46:50]     [35msample_rate[0m : [92m4[0m
[03/06 09:46:50]     [35msliding_window[0m : [92m32[0m
[03/06 09:46:50] ------------------------------------------------------------
[03/06 09:46:50] [35mepochs[0m : [92m200[0m
[03/06 09:46:50] [35mlog_interval[0m : [92m1[0m
[03/06 09:46:50] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 09:46:50] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 173, in train
    runner = Runner(optimizer=optimizer,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 57, in __init__
    self.model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[local_rank], output_device=local_rank)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 663, in __init__
    self.process_group = _get_default_group()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
    raise ValueError(
ValueError: Default process group has not been initialized, please make sure to call init_process_group.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 10:21:09] [35mCOLLATE[0m : 
[03/06 10:21:09]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 10:21:09]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 10:21:09] ------------------------------------------------------------
[03/06 10:21:09] [35mDATASET[0m : 
[03/06 10:21:09]     [35mnum_workers[0m : [92m0[0m
[03/06 10:21:09]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 10:21:09]     [35mtest[0m : 
[03/06 10:21:09]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:21:09]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:21:09]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:09]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:21:09]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:21:09]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 10:21:09]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:21:09]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:21:09]         [35msample_rate[0m : [92m4[0m
[03/06 10:21:09]         [35msliding_window[0m : [92m32[0m
[03/06 10:21:09]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 10:21:09]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:21:09]     [35mtrain[0m : 
[03/06 10:21:09]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:21:09]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:21:09]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:09]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:21:09]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:21:09]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 10:21:09]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:21:09]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:21:09]         [35msample_rate[0m : [92m4[0m
[03/06 10:21:09]         [35msliding_window[0m : [92m32[0m
[03/06 10:21:09]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 10:21:09]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:21:09]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 10:21:09] ------------------------------------------------------------
[03/06 10:21:09] [35mLRSCHEDULER[0m : 
[03/06 10:21:09]     [35mgamma[0m : [92m0.1[0m
[03/06 10:21:09]     [35mname[0m : [92mMultiStepLR[0m
[03/06 10:21:09]     [35mstep_size[0m : [92m[50][0m
[03/06 10:21:09] ------------------------------------------------------------
[03/06 10:21:09] [35mMETRIC[0m : 
[03/06 10:21:09]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 10:21:09]     [35mfile_output[0m : [92mTrue[0m
[03/06 10:21:09]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 10:21:09]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 10:21:09]     [35mscore_output[0m : [92mTrue[0m
[03/06 10:21:09] ------------------------------------------------------------
[03/06 10:21:09] [35mMODEL[0m : 
[03/06 10:21:09]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 10:21:09]     [35mbackbone[0m : 
[03/06 10:21:09]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:09]         [35mname[0m : [92mResNetTSM[0m
[03/06 10:21:09]         [35mout_indices[0m : [92m(3,)[0m
[03/06 10:21:09]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 10:21:09]         [35mshift_div[0m : [92m8[0m
[03/06 10:21:09]     [35mhead[0m : 
[03/06 10:21:09]         [35maction_head[0m : 
[03/06 10:21:09]             [35mdim[0m : [92m2048[0m
[03/06 10:21:09]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:21:09]             [35mnum_classes[0m : [92m5[0m
[03/06 10:21:09]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:21:09]             [35mnum_layers[0m : [92m4[0m
[03/06 10:21:09]             [35mnum_stages[0m : [92m1[0m
[03/06 10:21:09]             [35msample_rate[0m : [92m4[0m
[03/06 10:21:09]         [35mbranch_head[0m : 
[03/06 10:21:09]             [35mdim[0m : [92m2048[0m
[03/06 10:21:09]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:21:09]             [35mnum_classes[0m : [92m15[0m
[03/06 10:21:09]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:21:09]             [35mnum_layers[0m : [92m4[0m
[03/06 10:21:09]             [35mnum_stages[0m : [92m1[0m
[03/06 10:21:09]             [35msample_rate[0m : [92m4[0m
[03/06 10:21:09]         [35msample_rate[0m : [92m4[0m
[03/06 10:21:09]     [35mloss[0m : 
[03/06 10:21:09]         [35mignore_index[0m : [92m-100[0m
[03/06 10:21:09]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 10:21:09]         [35mnum_classes_action[0m : [92m5[0m
[03/06 10:21:09]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 10:21:09]         [35msample_rate[0m : [92m4[0m
[03/06 10:21:09]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 10:21:09]     [35mneck[0m : 
[03/06 10:21:09]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:09]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 10:21:09]         [35min_channels[0m : [92m2048[0m
[03/06 10:21:09]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 10:21:09]         [35mneed_pool[0m : [92mTrue[0m
[03/06 10:21:09]         [35mnum_classes[0m : [92m20[0m
[03/06 10:21:09] ------------------------------------------------------------
[03/06 10:21:09] [35mOPTIMIZER[0m : 
[03/06 10:21:09]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 10:21:09]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 10:21:09]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 10:21:09]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 10:21:09] ------------------------------------------------------------
[03/06 10:21:09] [35mPIPELINE[0m : 
[03/06 10:21:09]     [35mtest[0m : 
[03/06 10:21:09]         [35mdecode[0m : 
[03/06 10:21:09]             [35mbackend[0m : [92mdecord[0m
[03/06 10:21:09]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:21:09]         [35mname[0m : [92mBasePipline[0m
[03/06 10:21:09]         [35msample[0m : 
[03/06 10:21:09]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:09]             [35mis_train[0m : [92mFalse[0m
[03/06 10:21:09]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:21:09]             [35msample_mode[0m : [92muniform[0m
[03/06 10:21:09]             [35msample_rate[0m : [92m4[0m
[03/06 10:21:09]             [35msliding_window[0m : [92m32[0m
[03/06 10:21:09]         [35mtransform[0m : 
[03/06 10:21:09]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:21:09]             [35mtransform_list[0m : 
[03/06 10:21:09]                 [35mResize[0m : 
[03/06 10:21:09]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:21:09]                 [35mCenterCrop[0m : 
[03/06 10:21:09]                     [35msize[0m : [92m224[0m
[03/06 10:21:09]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:21:09]                 [35mNormalize[0m : 
[03/06 10:21:09]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:21:09]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:21:09]     [35mtrain[0m : 
[03/06 10:21:09]         [35mdecode[0m : 
[03/06 10:21:09]             [35mbackend[0m : [92mdecord[0m
[03/06 10:21:09]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:21:09]         [35mname[0m : [92mBasePipline[0m
[03/06 10:21:09]         [35msample[0m : 
[03/06 10:21:09]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:09]             [35mis_train[0m : [92mTrue[0m
[03/06 10:21:09]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:21:09]             [35msample_mode[0m : [92muniform[0m
[03/06 10:21:09]             [35msample_rate[0m : [92m4[0m
[03/06 10:21:09]             [35msliding_window[0m : [92m32[0m
[03/06 10:21:09]         [35mtransform[0m : 
[03/06 10:21:09]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:21:09]             [35mtransform_list[0m : 
[03/06 10:21:09]                 [35mResize[0m : 
[03/06 10:21:09]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:21:09]                 [35mRandomCrop[0m : 
[03/06 10:21:09]                     [35msize[0m : [92m224[0m
[03/06 10:21:09]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 10:21:09]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:21:09]                 [35mNormalize[0m : 
[03/06 10:21:09]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:21:09]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:21:09] ------------------------------------------------------------
[03/06 10:21:09] [35mPOSTPRECESSING[0m : 
[03/06 10:21:09]     [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:09]     [35mignore_index[0m : [92m-100[0m
[03/06 10:21:09]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 10:21:09]     [35mnum_action_classes[0m : [92m5[0m
[03/06 10:21:09]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 10:21:09]     [35msample_rate[0m : [92m4[0m
[03/06 10:21:09]     [35msliding_window[0m : [92m32[0m
[03/06 10:21:09] ------------------------------------------------------------
[03/06 10:21:09] [35mepochs[0m : [92m200[0m
[03/06 10:21:09] [35mlog_interval[0m : [92m1[0m
[03/06 10:21:09] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 10:21:09] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 173, in train
    runner = Runner(optimizer=optimizer,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 58, in __init__
    self.model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[local_rank], output_device=local_rank)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 663, in __init__
    self.process_group = _get_default_group()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
    raise ValueError(
ValueError: Default process group has not been initialized, please make sure to call init_process_group.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 10:21:26] [35mCOLLATE[0m : 
[03/06 10:21:26]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 10:21:26]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 10:21:26] ------------------------------------------------------------
[03/06 10:21:26] [35mDATASET[0m : 
[03/06 10:21:26]     [35mnum_workers[0m : [92m0[0m
[03/06 10:21:26]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 10:21:26]     [35mtest[0m : 
[03/06 10:21:26]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:21:26]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:21:26]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:26]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:21:26]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:21:26]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 10:21:26]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:21:26]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:21:26]         [35msample_rate[0m : [92m4[0m
[03/06 10:21:26]         [35msliding_window[0m : [92m32[0m
[03/06 10:21:26]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 10:21:26]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:21:26]     [35mtrain[0m : 
[03/06 10:21:26]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:21:26]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:21:26]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:26]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:21:26]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:21:26]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 10:21:26]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:21:26]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:21:26]         [35msample_rate[0m : [92m4[0m
[03/06 10:21:26]         [35msliding_window[0m : [92m32[0m
[03/06 10:21:26]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 10:21:26]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:21:26]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 10:21:26] ------------------------------------------------------------
[03/06 10:21:26] [35mLRSCHEDULER[0m : 
[03/06 10:21:26]     [35mgamma[0m : [92m0.1[0m
[03/06 10:21:26]     [35mname[0m : [92mMultiStepLR[0m
[03/06 10:21:26]     [35mstep_size[0m : [92m[50][0m
[03/06 10:21:26] ------------------------------------------------------------
[03/06 10:21:26] [35mMETRIC[0m : 
[03/06 10:21:26]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 10:21:26]     [35mfile_output[0m : [92mTrue[0m
[03/06 10:21:26]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 10:21:26]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 10:21:26]     [35mscore_output[0m : [92mTrue[0m
[03/06 10:21:26] ------------------------------------------------------------
[03/06 10:21:26] [35mMODEL[0m : 
[03/06 10:21:26]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 10:21:26]     [35mbackbone[0m : 
[03/06 10:21:26]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:26]         [35mname[0m : [92mResNetTSM[0m
[03/06 10:21:26]         [35mout_indices[0m : [92m(3,)[0m
[03/06 10:21:26]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 10:21:26]         [35mshift_div[0m : [92m8[0m
[03/06 10:21:26]     [35mhead[0m : 
[03/06 10:21:26]         [35maction_head[0m : 
[03/06 10:21:26]             [35mdim[0m : [92m2048[0m
[03/06 10:21:26]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:21:26]             [35mnum_classes[0m : [92m5[0m
[03/06 10:21:26]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:21:26]             [35mnum_layers[0m : [92m4[0m
[03/06 10:21:26]             [35mnum_stages[0m : [92m1[0m
[03/06 10:21:26]             [35msample_rate[0m : [92m4[0m
[03/06 10:21:26]         [35mbranch_head[0m : 
[03/06 10:21:26]             [35mdim[0m : [92m2048[0m
[03/06 10:21:26]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:21:26]             [35mnum_classes[0m : [92m15[0m
[03/06 10:21:26]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:21:26]             [35mnum_layers[0m : [92m4[0m
[03/06 10:21:26]             [35mnum_stages[0m : [92m1[0m
[03/06 10:21:26]             [35msample_rate[0m : [92m4[0m
[03/06 10:21:26]         [35msample_rate[0m : [92m4[0m
[03/06 10:21:26]     [35mloss[0m : 
[03/06 10:21:26]         [35mignore_index[0m : [92m-100[0m
[03/06 10:21:26]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 10:21:26]         [35mnum_classes_action[0m : [92m5[0m
[03/06 10:21:26]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 10:21:26]         [35msample_rate[0m : [92m4[0m
[03/06 10:21:26]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 10:21:26]     [35mneck[0m : 
[03/06 10:21:26]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:26]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 10:21:26]         [35min_channels[0m : [92m2048[0m
[03/06 10:21:26]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 10:21:26]         [35mneed_pool[0m : [92mTrue[0m
[03/06 10:21:26]         [35mnum_classes[0m : [92m20[0m
[03/06 10:21:26] ------------------------------------------------------------
[03/06 10:21:26] [35mOPTIMIZER[0m : 
[03/06 10:21:26]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 10:21:26]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 10:21:26]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 10:21:26]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 10:21:26] ------------------------------------------------------------
[03/06 10:21:26] [35mPIPELINE[0m : 
[03/06 10:21:26]     [35mtest[0m : 
[03/06 10:21:26]         [35mdecode[0m : 
[03/06 10:21:26]             [35mbackend[0m : [92mdecord[0m
[03/06 10:21:26]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:21:26]         [35mname[0m : [92mBasePipline[0m
[03/06 10:21:26]         [35msample[0m : 
[03/06 10:21:26]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:26]             [35mis_train[0m : [92mFalse[0m
[03/06 10:21:26]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:21:26]             [35msample_mode[0m : [92muniform[0m
[03/06 10:21:26]             [35msample_rate[0m : [92m4[0m
[03/06 10:21:26]             [35msliding_window[0m : [92m32[0m
[03/06 10:21:26]         [35mtransform[0m : 
[03/06 10:21:26]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:21:26]             [35mtransform_list[0m : 
[03/06 10:21:26]                 [35mResize[0m : 
[03/06 10:21:26]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:21:26]                 [35mCenterCrop[0m : 
[03/06 10:21:26]                     [35msize[0m : [92m224[0m
[03/06 10:21:26]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:21:26]                 [35mNormalize[0m : 
[03/06 10:21:26]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:21:26]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:21:26]     [35mtrain[0m : 
[03/06 10:21:26]         [35mdecode[0m : 
[03/06 10:21:26]             [35mbackend[0m : [92mdecord[0m
[03/06 10:21:26]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:21:26]         [35mname[0m : [92mBasePipline[0m
[03/06 10:21:26]         [35msample[0m : 
[03/06 10:21:26]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:26]             [35mis_train[0m : [92mTrue[0m
[03/06 10:21:26]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:21:26]             [35msample_mode[0m : [92muniform[0m
[03/06 10:21:26]             [35msample_rate[0m : [92m4[0m
[03/06 10:21:26]             [35msliding_window[0m : [92m32[0m
[03/06 10:21:26]         [35mtransform[0m : 
[03/06 10:21:26]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:21:26]             [35mtransform_list[0m : 
[03/06 10:21:26]                 [35mResize[0m : 
[03/06 10:21:26]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:21:26]                 [35mRandomCrop[0m : 
[03/06 10:21:26]                     [35msize[0m : [92m224[0m
[03/06 10:21:26]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 10:21:26]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:21:26]                 [35mNormalize[0m : 
[03/06 10:21:26]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:21:26]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:21:26] ------------------------------------------------------------
[03/06 10:21:26] [35mPOSTPRECESSING[0m : 
[03/06 10:21:26]     [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:26]     [35mignore_index[0m : [92m-100[0m
[03/06 10:21:26]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 10:21:26]     [35mnum_action_classes[0m : [92m5[0m
[03/06 10:21:26]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 10:21:26]     [35msample_rate[0m : [92m4[0m
[03/06 10:21:26]     [35msliding_window[0m : [92m32[0m
[03/06 10:21:26] ------------------------------------------------------------
[03/06 10:21:26] [35mepochs[0m : [92m200[0m
[03/06 10:21:26] [35mlog_interval[0m : [92m1[0m
[03/06 10:21:26] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 10:21:26] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
[03/06 10:21:36] [35mepoch:[  1/200][0m [95mtrain step:0   [0m [92maction_loss: 3.67870 branch_loss: 4.98642 lr: 0.000500 F1Action@0.5: 0.00000 F1Branch@0.5: 0.00000 Acc: 0.20045 ActionSeg_Acc: 0.10679 Acc: 0.07819 BranchSeg_Acc: 0.04375[0m [92mbatch_cost: 8.19672 sec,[0m [92mreader_time: 1.65134 sec,[0m ips: 0.48800 instance/sec.
[03/06 10:21:43] [35mepoch:[  1/200][0m [95mtrain step:1   [0m [92maction_loss: 5.11062 branch_loss: 7.02030 lr: 0.000500 F1Action@0.5: 0.00000 F1Branch@0.5: 0.00000 Acc: 0.25682 ActionSeg_Acc: 0.07943 Acc: 0.04811 BranchSeg_Acc: 0.01172[0m [92mbatch_cost: 7.22384 sec,[0m [92mreader_time: 1.31546 sec,[0m ips: 0.55372 instance/sec.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 10:21:53] [35mCOLLATE[0m : 
[03/06 10:21:53]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 10:21:53]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 10:21:53] ------------------------------------------------------------
[03/06 10:21:53] [35mDATASET[0m : 
[03/06 10:21:53]     [35mnum_workers[0m : [92m0[0m
[03/06 10:21:53]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 10:21:53]     [35mtest[0m : 
[03/06 10:21:53]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:21:53]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:21:53]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:53]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:21:53]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:21:53]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 10:21:53]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:21:53]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:21:53]         [35msample_rate[0m : [92m4[0m
[03/06 10:21:53]         [35msliding_window[0m : [92m32[0m
[03/06 10:21:53]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 10:21:53]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:21:53]     [35mtrain[0m : 
[03/06 10:21:53]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:21:53]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:21:53]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:53]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:21:53]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:21:53]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 10:21:53]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:21:53]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:21:53]         [35msample_rate[0m : [92m4[0m
[03/06 10:21:53]         [35msliding_window[0m : [92m32[0m
[03/06 10:21:53]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 10:21:53]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:21:53]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 10:21:53] ------------------------------------------------------------
[03/06 10:21:53] [35mLRSCHEDULER[0m : 
[03/06 10:21:53]     [35mgamma[0m : [92m0.1[0m
[03/06 10:21:53]     [35mname[0m : [92mMultiStepLR[0m
[03/06 10:21:53]     [35mstep_size[0m : [92m[50][0m
[03/06 10:21:53] ------------------------------------------------------------
[03/06 10:21:53] [35mMETRIC[0m : 
[03/06 10:21:53]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 10:21:53]     [35mfile_output[0m : [92mTrue[0m
[03/06 10:21:53]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 10:21:53]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 10:21:53]     [35mscore_output[0m : [92mTrue[0m
[03/06 10:21:53] ------------------------------------------------------------
[03/06 10:21:53] [35mMODEL[0m : 
[03/06 10:21:53]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 10:21:53]     [35mbackbone[0m : 
[03/06 10:21:53]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:53]         [35mname[0m : [92mResNetTSM[0m
[03/06 10:21:53]         [35mout_indices[0m : [92m(3,)[0m
[03/06 10:21:53]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 10:21:53]         [35mshift_div[0m : [92m8[0m
[03/06 10:21:53]     [35mhead[0m : 
[03/06 10:21:53]         [35maction_head[0m : 
[03/06 10:21:53]             [35mdim[0m : [92m2048[0m
[03/06 10:21:53]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:21:53]             [35mnum_classes[0m : [92m5[0m
[03/06 10:21:53]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:21:53]             [35mnum_layers[0m : [92m4[0m
[03/06 10:21:53]             [35mnum_stages[0m : [92m1[0m
[03/06 10:21:53]             [35msample_rate[0m : [92m4[0m
[03/06 10:21:53]         [35mbranch_head[0m : 
[03/06 10:21:53]             [35mdim[0m : [92m2048[0m
[03/06 10:21:53]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:21:53]             [35mnum_classes[0m : [92m15[0m
[03/06 10:21:53]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:21:53]             [35mnum_layers[0m : [92m4[0m
[03/06 10:21:53]             [35mnum_stages[0m : [92m1[0m
[03/06 10:21:53]             [35msample_rate[0m : [92m4[0m
[03/06 10:21:53]         [35msample_rate[0m : [92m4[0m
[03/06 10:21:53]     [35mloss[0m : 
[03/06 10:21:53]         [35mignore_index[0m : [92m-100[0m
[03/06 10:21:53]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 10:21:53]         [35mnum_classes_action[0m : [92m5[0m
[03/06 10:21:53]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 10:21:53]         [35msample_rate[0m : [92m4[0m
[03/06 10:21:53]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 10:21:53]     [35mneck[0m : 
[03/06 10:21:53]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:53]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 10:21:53]         [35min_channels[0m : [92m2048[0m
[03/06 10:21:53]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 10:21:53]         [35mneed_pool[0m : [92mTrue[0m
[03/06 10:21:53]         [35mnum_classes[0m : [92m20[0m
[03/06 10:21:53] ------------------------------------------------------------
[03/06 10:21:53] [35mOPTIMIZER[0m : 
[03/06 10:21:53]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 10:21:53]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 10:21:53]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 10:21:53]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 10:21:53] ------------------------------------------------------------
[03/06 10:21:53] [35mPIPELINE[0m : 
[03/06 10:21:53]     [35mtest[0m : 
[03/06 10:21:53]         [35mdecode[0m : 
[03/06 10:21:53]             [35mbackend[0m : [92mdecord[0m
[03/06 10:21:53]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:21:53]         [35mname[0m : [92mBasePipline[0m
[03/06 10:21:53]         [35msample[0m : 
[03/06 10:21:53]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:53]             [35mis_train[0m : [92mFalse[0m
[03/06 10:21:53]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:21:53]             [35msample_mode[0m : [92muniform[0m
[03/06 10:21:53]             [35msample_rate[0m : [92m4[0m
[03/06 10:21:53]             [35msliding_window[0m : [92m32[0m
[03/06 10:21:53]         [35mtransform[0m : 
[03/06 10:21:53]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:21:53]             [35mtransform_list[0m : 
[03/06 10:21:53]                 [35mResize[0m : 
[03/06 10:21:53]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:21:53]                 [35mCenterCrop[0m : 
[03/06 10:21:53]                     [35msize[0m : [92m224[0m
[03/06 10:21:53]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:21:53]                 [35mNormalize[0m : 
[03/06 10:21:53]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:21:53]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:21:53]     [35mtrain[0m : 
[03/06 10:21:53]         [35mdecode[0m : 
[03/06 10:21:53]             [35mbackend[0m : [92mdecord[0m
[03/06 10:21:53]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:21:53]         [35mname[0m : [92mBasePipline[0m
[03/06 10:21:53]         [35msample[0m : 
[03/06 10:21:53]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:53]             [35mis_train[0m : [92mTrue[0m
[03/06 10:21:53]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:21:53]             [35msample_mode[0m : [92muniform[0m
[03/06 10:21:53]             [35msample_rate[0m : [92m4[0m
[03/06 10:21:53]             [35msliding_window[0m : [92m32[0m
[03/06 10:21:53]         [35mtransform[0m : 
[03/06 10:21:53]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:21:53]             [35mtransform_list[0m : 
[03/06 10:21:53]                 [35mResize[0m : 
[03/06 10:21:53]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:21:53]                 [35mRandomCrop[0m : 
[03/06 10:21:53]                     [35msize[0m : [92m224[0m
[03/06 10:21:53]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 10:21:53]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:21:53]                 [35mNormalize[0m : 
[03/06 10:21:53]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:21:53]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:21:53] ------------------------------------------------------------
[03/06 10:21:53] [35mPOSTPRECESSING[0m : 
[03/06 10:21:53]     [35mclip_seg_num[0m : [92m8[0m
[03/06 10:21:53]     [35mignore_index[0m : [92m-100[0m
[03/06 10:21:53]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 10:21:53]     [35mnum_action_classes[0m : [92m5[0m
[03/06 10:21:53]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 10:21:53]     [35msample_rate[0m : [92m4[0m
[03/06 10:21:53]     [35msliding_window[0m : [92m32[0m
[03/06 10:21:53] ------------------------------------------------------------
[03/06 10:21:53] [35mepochs[0m : [92m200[0m
[03/06 10:21:53] [35mlog_interval[0m : [92m1[0m
[03/06 10:21:53] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 10:21:53] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 173, in train
    runner = Runner(optimizer=optimizer,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 58, in __init__
    self.model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[local_rank], output_device=local_rank)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 663, in __init__
    self.process_group = _get_default_group()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
    raise ValueError(
ValueError: Default process group has not been initialized, please make sure to call init_process_group.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 10:23:23] [35mCOLLATE[0m : 
[03/06 10:23:23]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 10:23:23]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 10:23:23] ------------------------------------------------------------
[03/06 10:23:23] [35mDATASET[0m : 
[03/06 10:23:23]     [35mnum_workers[0m : [92m0[0m
[03/06 10:23:23]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 10:23:23]     [35mtest[0m : 
[03/06 10:23:23]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:23:23]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:23:23]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:23:23]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:23:23]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:23:23]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 10:23:23]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:23:23]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:23:23]         [35msample_rate[0m : [92m4[0m
[03/06 10:23:23]         [35msliding_window[0m : [92m32[0m
[03/06 10:23:23]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 10:23:23]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:23:23]     [35mtrain[0m : 
[03/06 10:23:23]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:23:23]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:23:23]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:23:23]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:23:23]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:23:23]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 10:23:23]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:23:23]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:23:23]         [35msample_rate[0m : [92m4[0m
[03/06 10:23:23]         [35msliding_window[0m : [92m32[0m
[03/06 10:23:23]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 10:23:23]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:23:23]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 10:23:23] ------------------------------------------------------------
[03/06 10:23:23] [35mLRSCHEDULER[0m : 
[03/06 10:23:23]     [35mgamma[0m : [92m0.1[0m
[03/06 10:23:23]     [35mname[0m : [92mMultiStepLR[0m
[03/06 10:23:23]     [35mstep_size[0m : [92m[50][0m
[03/06 10:23:23] ------------------------------------------------------------
[03/06 10:23:23] [35mMETRIC[0m : 
[03/06 10:23:23]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 10:23:23]     [35mfile_output[0m : [92mTrue[0m
[03/06 10:23:23]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 10:23:23]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 10:23:23]     [35mscore_output[0m : [92mTrue[0m
[03/06 10:23:23] ------------------------------------------------------------
[03/06 10:23:23] [35mMODEL[0m : 
[03/06 10:23:23]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 10:23:23]     [35mbackbone[0m : 
[03/06 10:23:23]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:23:23]         [35mname[0m : [92mResNetTSM[0m
[03/06 10:23:23]         [35mout_indices[0m : [92m(3,)[0m
[03/06 10:23:23]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 10:23:23]         [35mshift_div[0m : [92m8[0m
[03/06 10:23:23]     [35mhead[0m : 
[03/06 10:23:23]         [35maction_head[0m : 
[03/06 10:23:23]             [35mdim[0m : [92m2048[0m
[03/06 10:23:23]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:23:23]             [35mnum_classes[0m : [92m5[0m
[03/06 10:23:23]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:23:23]             [35mnum_layers[0m : [92m4[0m
[03/06 10:23:23]             [35mnum_stages[0m : [92m1[0m
[03/06 10:23:23]             [35msample_rate[0m : [92m4[0m
[03/06 10:23:23]         [35mbranch_head[0m : 
[03/06 10:23:23]             [35mdim[0m : [92m2048[0m
[03/06 10:23:23]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:23:23]             [35mnum_classes[0m : [92m15[0m
[03/06 10:23:23]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:23:23]             [35mnum_layers[0m : [92m4[0m
[03/06 10:23:23]             [35mnum_stages[0m : [92m1[0m
[03/06 10:23:23]             [35msample_rate[0m : [92m4[0m
[03/06 10:23:23]         [35msample_rate[0m : [92m4[0m
[03/06 10:23:23]     [35mloss[0m : 
[03/06 10:23:23]         [35mignore_index[0m : [92m-100[0m
[03/06 10:23:23]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 10:23:23]         [35mnum_classes_action[0m : [92m5[0m
[03/06 10:23:23]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 10:23:23]         [35msample_rate[0m : [92m4[0m
[03/06 10:23:23]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 10:23:23]     [35mneck[0m : 
[03/06 10:23:23]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:23:23]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 10:23:23]         [35min_channels[0m : [92m2048[0m
[03/06 10:23:23]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 10:23:23]         [35mneed_pool[0m : [92mTrue[0m
[03/06 10:23:23]         [35mnum_classes[0m : [92m20[0m
[03/06 10:23:23] ------------------------------------------------------------
[03/06 10:23:23] [35mOPTIMIZER[0m : 
[03/06 10:23:23]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 10:23:23]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 10:23:23]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 10:23:23]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 10:23:23] ------------------------------------------------------------
[03/06 10:23:23] [35mPIPELINE[0m : 
[03/06 10:23:23]     [35mtest[0m : 
[03/06 10:23:23]         [35mdecode[0m : 
[03/06 10:23:23]             [35mbackend[0m : [92mdecord[0m
[03/06 10:23:23]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:23:23]         [35mname[0m : [92mBasePipline[0m
[03/06 10:23:23]         [35msample[0m : 
[03/06 10:23:23]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:23:23]             [35mis_train[0m : [92mFalse[0m
[03/06 10:23:23]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:23:23]             [35msample_mode[0m : [92muniform[0m
[03/06 10:23:23]             [35msample_rate[0m : [92m4[0m
[03/06 10:23:23]             [35msliding_window[0m : [92m32[0m
[03/06 10:23:23]         [35mtransform[0m : 
[03/06 10:23:23]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:23:23]             [35mtransform_list[0m : 
[03/06 10:23:23]                 [35mResize[0m : 
[03/06 10:23:23]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:23:23]                 [35mCenterCrop[0m : 
[03/06 10:23:23]                     [35msize[0m : [92m224[0m
[03/06 10:23:23]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:23:23]                 [35mNormalize[0m : 
[03/06 10:23:23]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:23:23]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:23:23]     [35mtrain[0m : 
[03/06 10:23:23]         [35mdecode[0m : 
[03/06 10:23:23]             [35mbackend[0m : [92mdecord[0m
[03/06 10:23:23]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:23:23]         [35mname[0m : [92mBasePipline[0m
[03/06 10:23:23]         [35msample[0m : 
[03/06 10:23:23]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:23:23]             [35mis_train[0m : [92mTrue[0m
[03/06 10:23:23]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:23:23]             [35msample_mode[0m : [92muniform[0m
[03/06 10:23:23]             [35msample_rate[0m : [92m4[0m
[03/06 10:23:23]             [35msliding_window[0m : [92m32[0m
[03/06 10:23:23]         [35mtransform[0m : 
[03/06 10:23:23]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:23:23]             [35mtransform_list[0m : 
[03/06 10:23:23]                 [35mResize[0m : 
[03/06 10:23:23]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:23:23]                 [35mRandomCrop[0m : 
[03/06 10:23:23]                     [35msize[0m : [92m224[0m
[03/06 10:23:23]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 10:23:23]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:23:23]                 [35mNormalize[0m : 
[03/06 10:23:23]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:23:23]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:23:23] ------------------------------------------------------------
[03/06 10:23:23] [35mPOSTPRECESSING[0m : 
[03/06 10:23:23]     [35mclip_seg_num[0m : [92m8[0m
[03/06 10:23:23]     [35mignore_index[0m : [92m-100[0m
[03/06 10:23:23]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 10:23:23]     [35mnum_action_classes[0m : [92m5[0m
[03/06 10:23:23]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 10:23:23]     [35msample_rate[0m : [92m4[0m
[03/06 10:23:23]     [35msliding_window[0m : [92m32[0m
[03/06 10:23:23] ------------------------------------------------------------
[03/06 10:23:23] [35mepochs[0m : [92m200[0m
[03/06 10:23:23] [35mlog_interval[0m : [92m1[0m
[03/06 10:23:23] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 10:23:23] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 173, in train
    runner = Runner(optimizer=optimizer,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 58, in __init__
    self.model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[local_rank], output_device=local_rank)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 663, in __init__
    self.process_group = _get_default_group()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
    raise ValueError(
ValueError: Default process group has not been initialized, please make sure to call init_process_group.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 10:25:26] [35mCOLLATE[0m : 
[03/06 10:25:26]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 10:25:26]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 10:25:26] ------------------------------------------------------------
[03/06 10:25:26] [35mDATASET[0m : 
[03/06 10:25:26]     [35mnum_workers[0m : [92m0[0m
[03/06 10:25:26]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 10:25:26]     [35mtest[0m : 
[03/06 10:25:26]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:25:26]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:25:26]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:26]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:25:26]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:25:26]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 10:25:26]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:25:26]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:25:26]         [35msample_rate[0m : [92m4[0m
[03/06 10:25:26]         [35msliding_window[0m : [92m32[0m
[03/06 10:25:26]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 10:25:26]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:25:26]     [35mtrain[0m : 
[03/06 10:25:26]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:25:26]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:25:26]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:26]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:25:26]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:25:26]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 10:25:26]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:25:26]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:25:26]         [35msample_rate[0m : [92m4[0m
[03/06 10:25:26]         [35msliding_window[0m : [92m32[0m
[03/06 10:25:26]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 10:25:26]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:25:26]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 10:25:26] ------------------------------------------------------------
[03/06 10:25:26] [35mLRSCHEDULER[0m : 
[03/06 10:25:26]     [35mgamma[0m : [92m0.1[0m
[03/06 10:25:26]     [35mname[0m : [92mMultiStepLR[0m
[03/06 10:25:26]     [35mstep_size[0m : [92m[50][0m
[03/06 10:25:26] ------------------------------------------------------------
[03/06 10:25:26] [35mMETRIC[0m : 
[03/06 10:25:26]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 10:25:26]     [35mfile_output[0m : [92mTrue[0m
[03/06 10:25:26]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 10:25:26]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 10:25:26]     [35mscore_output[0m : [92mTrue[0m
[03/06 10:25:26] ------------------------------------------------------------
[03/06 10:25:26] [35mMODEL[0m : 
[03/06 10:25:26]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 10:25:26]     [35mbackbone[0m : 
[03/06 10:25:26]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:26]         [35mname[0m : [92mResNetTSM[0m
[03/06 10:25:26]         [35mout_indices[0m : [92m(3,)[0m
[03/06 10:25:26]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 10:25:26]         [35mshift_div[0m : [92m8[0m
[03/06 10:25:26]     [35mhead[0m : 
[03/06 10:25:26]         [35maction_head[0m : 
[03/06 10:25:26]             [35mdim[0m : [92m2048[0m
[03/06 10:25:26]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:25:26]             [35mnum_classes[0m : [92m5[0m
[03/06 10:25:26]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:25:26]             [35mnum_layers[0m : [92m4[0m
[03/06 10:25:26]             [35mnum_stages[0m : [92m1[0m
[03/06 10:25:26]             [35msample_rate[0m : [92m4[0m
[03/06 10:25:26]         [35mbranch_head[0m : 
[03/06 10:25:26]             [35mdim[0m : [92m2048[0m
[03/06 10:25:26]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:25:26]             [35mnum_classes[0m : [92m15[0m
[03/06 10:25:26]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:25:26]             [35mnum_layers[0m : [92m4[0m
[03/06 10:25:26]             [35mnum_stages[0m : [92m1[0m
[03/06 10:25:26]             [35msample_rate[0m : [92m4[0m
[03/06 10:25:26]         [35msample_rate[0m : [92m4[0m
[03/06 10:25:26]     [35mloss[0m : 
[03/06 10:25:26]         [35mignore_index[0m : [92m-100[0m
[03/06 10:25:26]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 10:25:26]         [35mnum_classes_action[0m : [92m5[0m
[03/06 10:25:26]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 10:25:26]         [35msample_rate[0m : [92m4[0m
[03/06 10:25:26]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 10:25:26]     [35mneck[0m : 
[03/06 10:25:26]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:26]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 10:25:26]         [35min_channels[0m : [92m2048[0m
[03/06 10:25:26]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 10:25:26]         [35mneed_pool[0m : [92mTrue[0m
[03/06 10:25:26]         [35mnum_classes[0m : [92m20[0m
[03/06 10:25:26] ------------------------------------------------------------
[03/06 10:25:26] [35mOPTIMIZER[0m : 
[03/06 10:25:26]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 10:25:26]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 10:25:26]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 10:25:26]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 10:25:26] ------------------------------------------------------------
[03/06 10:25:26] [35mPIPELINE[0m : 
[03/06 10:25:26]     [35mtest[0m : 
[03/06 10:25:26]         [35mdecode[0m : 
[03/06 10:25:26]             [35mbackend[0m : [92mdecord[0m
[03/06 10:25:26]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:25:26]         [35mname[0m : [92mBasePipline[0m
[03/06 10:25:26]         [35msample[0m : 
[03/06 10:25:26]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:26]             [35mis_train[0m : [92mFalse[0m
[03/06 10:25:26]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:25:26]             [35msample_mode[0m : [92muniform[0m
[03/06 10:25:26]             [35msample_rate[0m : [92m4[0m
[03/06 10:25:26]             [35msliding_window[0m : [92m32[0m
[03/06 10:25:26]         [35mtransform[0m : 
[03/06 10:25:26]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:25:26]             [35mtransform_list[0m : 
[03/06 10:25:26]                 [35mResize[0m : 
[03/06 10:25:26]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:25:26]                 [35mCenterCrop[0m : 
[03/06 10:25:26]                     [35msize[0m : [92m224[0m
[03/06 10:25:26]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:25:26]                 [35mNormalize[0m : 
[03/06 10:25:26]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:25:26]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:25:26]     [35mtrain[0m : 
[03/06 10:25:26]         [35mdecode[0m : 
[03/06 10:25:26]             [35mbackend[0m : [92mdecord[0m
[03/06 10:25:26]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:25:26]         [35mname[0m : [92mBasePipline[0m
[03/06 10:25:26]         [35msample[0m : 
[03/06 10:25:26]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:26]             [35mis_train[0m : [92mTrue[0m
[03/06 10:25:26]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:25:26]             [35msample_mode[0m : [92muniform[0m
[03/06 10:25:26]             [35msample_rate[0m : [92m4[0m
[03/06 10:25:26]             [35msliding_window[0m : [92m32[0m
[03/06 10:25:26]         [35mtransform[0m : 
[03/06 10:25:26]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:25:26]             [35mtransform_list[0m : 
[03/06 10:25:26]                 [35mResize[0m : 
[03/06 10:25:26]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:25:26]                 [35mRandomCrop[0m : 
[03/06 10:25:26]                     [35msize[0m : [92m224[0m
[03/06 10:25:26]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 10:25:26]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:25:26]                 [35mNormalize[0m : 
[03/06 10:25:26]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:25:26]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:25:26] ------------------------------------------------------------
[03/06 10:25:26] [35mPOSTPRECESSING[0m : 
[03/06 10:25:26]     [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:26]     [35mignore_index[0m : [92m-100[0m
[03/06 10:25:26]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 10:25:26]     [35mnum_action_classes[0m : [92m5[0m
[03/06 10:25:26]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 10:25:26]     [35msample_rate[0m : [92m4[0m
[03/06 10:25:26]     [35msliding_window[0m : [92m32[0m
[03/06 10:25:26] ------------------------------------------------------------
[03/06 10:25:26] [35mepochs[0m : [92m200[0m
[03/06 10:25:26] [35mlog_interval[0m : [92m1[0m
[03/06 10:25:26] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 10:25:26] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
-1
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 173, in train
    runner = Runner(optimizer=optimizer,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 59, in __init__
    self.model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[local_rank], output_device=local_rank)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 663, in __init__
    self.process_group = _get_default_group()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
    raise ValueError(
ValueError: Default process group has not been initialized, please make sure to call init_process_group.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 10:25:39] [35mCOLLATE[0m : 
[03/06 10:25:39]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 10:25:39]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 10:25:39] ------------------------------------------------------------
[03/06 10:25:39] [35mDATASET[0m : 
[03/06 10:25:39]     [35mnum_workers[0m : [92m0[0m
[03/06 10:25:39]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 10:25:39]     [35mtest[0m : 
[03/06 10:25:39]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:25:39]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:25:39]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:39]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:25:39]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:25:39]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 10:25:39]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:25:39]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:25:39]         [35msample_rate[0m : [92m4[0m
[03/06 10:25:39]         [35msliding_window[0m : [92m32[0m
[03/06 10:25:39]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 10:25:39]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:25:39]     [35mtrain[0m : 
[03/06 10:25:39]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:25:39]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:25:39]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:39]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:25:39]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:25:39]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 10:25:39]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:25:39]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:25:39]         [35msample_rate[0m : [92m4[0m
[03/06 10:25:39]         [35msliding_window[0m : [92m32[0m
[03/06 10:25:39]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 10:25:39]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:25:39]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 10:25:39] ------------------------------------------------------------
[03/06 10:25:39] [35mLRSCHEDULER[0m : 
[03/06 10:25:39]     [35mgamma[0m : [92m0.1[0m
[03/06 10:25:39]     [35mname[0m : [92mMultiStepLR[0m
[03/06 10:25:39]     [35mstep_size[0m : [92m[50][0m
[03/06 10:25:39] ------------------------------------------------------------
[03/06 10:25:39] [35mMETRIC[0m : 
[03/06 10:25:39]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 10:25:39]     [35mfile_output[0m : [92mTrue[0m
[03/06 10:25:39]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 10:25:39]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 10:25:39]     [35mscore_output[0m : [92mTrue[0m
[03/06 10:25:39] ------------------------------------------------------------
[03/06 10:25:39] [35mMODEL[0m : 
[03/06 10:25:39]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 10:25:39]     [35mbackbone[0m : 
[03/06 10:25:39]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:39]         [35mname[0m : [92mResNetTSM[0m
[03/06 10:25:39]         [35mout_indices[0m : [92m(3,)[0m
[03/06 10:25:39]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 10:25:39]         [35mshift_div[0m : [92m8[0m
[03/06 10:25:39]     [35mhead[0m : 
[03/06 10:25:39]         [35maction_head[0m : 
[03/06 10:25:39]             [35mdim[0m : [92m2048[0m
[03/06 10:25:39]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:25:39]             [35mnum_classes[0m : [92m5[0m
[03/06 10:25:39]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:25:39]             [35mnum_layers[0m : [92m4[0m
[03/06 10:25:39]             [35mnum_stages[0m : [92m1[0m
[03/06 10:25:39]             [35msample_rate[0m : [92m4[0m
[03/06 10:25:39]         [35mbranch_head[0m : 
[03/06 10:25:39]             [35mdim[0m : [92m2048[0m
[03/06 10:25:39]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:25:39]             [35mnum_classes[0m : [92m15[0m
[03/06 10:25:39]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:25:39]             [35mnum_layers[0m : [92m4[0m
[03/06 10:25:39]             [35mnum_stages[0m : [92m1[0m
[03/06 10:25:39]             [35msample_rate[0m : [92m4[0m
[03/06 10:25:39]         [35msample_rate[0m : [92m4[0m
[03/06 10:25:39]     [35mloss[0m : 
[03/06 10:25:39]         [35mignore_index[0m : [92m-100[0m
[03/06 10:25:39]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 10:25:39]         [35mnum_classes_action[0m : [92m5[0m
[03/06 10:25:39]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 10:25:39]         [35msample_rate[0m : [92m4[0m
[03/06 10:25:39]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 10:25:39]     [35mneck[0m : 
[03/06 10:25:39]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:39]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 10:25:39]         [35min_channels[0m : [92m2048[0m
[03/06 10:25:39]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 10:25:39]         [35mneed_pool[0m : [92mTrue[0m
[03/06 10:25:39]         [35mnum_classes[0m : [92m20[0m
[03/06 10:25:39] ------------------------------------------------------------
[03/06 10:25:39] [35mOPTIMIZER[0m : 
[03/06 10:25:39]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 10:25:39]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 10:25:39]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 10:25:39]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 10:25:39] ------------------------------------------------------------
[03/06 10:25:39] [35mPIPELINE[0m : 
[03/06 10:25:39]     [35mtest[0m : 
[03/06 10:25:39]         [35mdecode[0m : 
[03/06 10:25:39]             [35mbackend[0m : [92mdecord[0m
[03/06 10:25:39]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:25:39]         [35mname[0m : [92mBasePipline[0m
[03/06 10:25:39]         [35msample[0m : 
[03/06 10:25:39]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:39]             [35mis_train[0m : [92mFalse[0m
[03/06 10:25:39]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:25:39]             [35msample_mode[0m : [92muniform[0m
[03/06 10:25:39]             [35msample_rate[0m : [92m4[0m
[03/06 10:25:39]             [35msliding_window[0m : [92m32[0m
[03/06 10:25:39]         [35mtransform[0m : 
[03/06 10:25:39]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:25:39]             [35mtransform_list[0m : 
[03/06 10:25:39]                 [35mResize[0m : 
[03/06 10:25:39]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:25:39]                 [35mCenterCrop[0m : 
[03/06 10:25:39]                     [35msize[0m : [92m224[0m
[03/06 10:25:39]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:25:39]                 [35mNormalize[0m : 
[03/06 10:25:39]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:25:39]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:25:39]     [35mtrain[0m : 
[03/06 10:25:39]         [35mdecode[0m : 
[03/06 10:25:39]             [35mbackend[0m : [92mdecord[0m
[03/06 10:25:39]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:25:39]         [35mname[0m : [92mBasePipline[0m
[03/06 10:25:39]         [35msample[0m : 
[03/06 10:25:39]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:39]             [35mis_train[0m : [92mTrue[0m
[03/06 10:25:39]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:25:39]             [35msample_mode[0m : [92muniform[0m
[03/06 10:25:39]             [35msample_rate[0m : [92m4[0m
[03/06 10:25:39]             [35msliding_window[0m : [92m32[0m
[03/06 10:25:39]         [35mtransform[0m : 
[03/06 10:25:39]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:25:39]             [35mtransform_list[0m : 
[03/06 10:25:39]                 [35mResize[0m : 
[03/06 10:25:39]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:25:39]                 [35mRandomCrop[0m : 
[03/06 10:25:39]                     [35msize[0m : [92m224[0m
[03/06 10:25:39]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 10:25:39]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:25:39]                 [35mNormalize[0m : 
[03/06 10:25:39]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:25:39]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:25:39] ------------------------------------------------------------
[03/06 10:25:39] [35mPOSTPRECESSING[0m : 
[03/06 10:25:39]     [35mclip_seg_num[0m : [92m8[0m
[03/06 10:25:39]     [35mignore_index[0m : [92m-100[0m
[03/06 10:25:39]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 10:25:39]     [35mnum_action_classes[0m : [92m5[0m
[03/06 10:25:39]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 10:25:39]     [35msample_rate[0m : [92m4[0m
[03/06 10:25:39]     [35msliding_window[0m : [92m32[0m
[03/06 10:25:39] ------------------------------------------------------------
[03/06 10:25:39] [35mepochs[0m : [92m200[0m
[03/06 10:25:39] [35mlog_interval[0m : [92m1[0m
[03/06 10:25:39] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 10:25:39] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
I am here -1
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 173, in train
    runner = Runner(optimizer=optimizer,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 59, in __init__
    self.model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[local_rank], output_device=local_rank)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 663, in __init__
    self.process_group = _get_default_group()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
    raise ValueError(
ValueError: Default process group has not been initialized, please make sure to call init_process_group.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 10:26:45] [35mCOLLATE[0m : 
[03/06 10:26:45]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 10:26:45]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 10:26:45] ------------------------------------------------------------
[03/06 10:26:45] [35mDATASET[0m : 
[03/06 10:26:45]     [35mnum_workers[0m : [92m0[0m
[03/06 10:26:45]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 10:26:45]     [35mtest[0m : 
[03/06 10:26:45]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:26:45]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:26:45]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:26:45]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:26:45]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:26:45]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 10:26:45]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:26:45]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:26:45]         [35msample_rate[0m : [92m4[0m
[03/06 10:26:45]         [35msliding_window[0m : [92m32[0m
[03/06 10:26:45]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 10:26:45]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:26:45]     [35mtrain[0m : 
[03/06 10:26:45]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:26:45]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:26:45]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:26:45]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:26:45]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:26:45]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 10:26:45]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:26:45]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:26:45]         [35msample_rate[0m : [92m4[0m
[03/06 10:26:45]         [35msliding_window[0m : [92m32[0m
[03/06 10:26:45]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 10:26:45]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:26:45]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 10:26:45] ------------------------------------------------------------
[03/06 10:26:45] [35mLRSCHEDULER[0m : 
[03/06 10:26:45]     [35mgamma[0m : [92m0.1[0m
[03/06 10:26:45]     [35mname[0m : [92mMultiStepLR[0m
[03/06 10:26:45]     [35mstep_size[0m : [92m[50][0m
[03/06 10:26:45] ------------------------------------------------------------
[03/06 10:26:45] [35mMETRIC[0m : 
[03/06 10:26:45]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 10:26:45]     [35mfile_output[0m : [92mTrue[0m
[03/06 10:26:45]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 10:26:45]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 10:26:45]     [35mscore_output[0m : [92mTrue[0m
[03/06 10:26:45] ------------------------------------------------------------
[03/06 10:26:45] [35mMODEL[0m : 
[03/06 10:26:45]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 10:26:45]     [35mbackbone[0m : 
[03/06 10:26:45]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:26:45]         [35mname[0m : [92mResNetTSM[0m
[03/06 10:26:45]         [35mout_indices[0m : [92m(3,)[0m
[03/06 10:26:45]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 10:26:45]         [35mshift_div[0m : [92m8[0m
[03/06 10:26:45]     [35mhead[0m : 
[03/06 10:26:45]         [35maction_head[0m : 
[03/06 10:26:45]             [35mdim[0m : [92m2048[0m
[03/06 10:26:45]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:26:45]             [35mnum_classes[0m : [92m5[0m
[03/06 10:26:45]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:26:45]             [35mnum_layers[0m : [92m4[0m
[03/06 10:26:45]             [35mnum_stages[0m : [92m1[0m
[03/06 10:26:45]             [35msample_rate[0m : [92m4[0m
[03/06 10:26:45]         [35mbranch_head[0m : 
[03/06 10:26:45]             [35mdim[0m : [92m2048[0m
[03/06 10:26:45]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:26:45]             [35mnum_classes[0m : [92m15[0m
[03/06 10:26:45]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:26:45]             [35mnum_layers[0m : [92m4[0m
[03/06 10:26:45]             [35mnum_stages[0m : [92m1[0m
[03/06 10:26:45]             [35msample_rate[0m : [92m4[0m
[03/06 10:26:45]         [35msample_rate[0m : [92m4[0m
[03/06 10:26:45]     [35mloss[0m : 
[03/06 10:26:45]         [35mignore_index[0m : [92m-100[0m
[03/06 10:26:45]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 10:26:45]         [35mnum_classes_action[0m : [92m5[0m
[03/06 10:26:45]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 10:26:45]         [35msample_rate[0m : [92m4[0m
[03/06 10:26:45]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 10:26:45]     [35mneck[0m : 
[03/06 10:26:45]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:26:45]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 10:26:45]         [35min_channels[0m : [92m2048[0m
[03/06 10:26:45]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 10:26:45]         [35mneed_pool[0m : [92mTrue[0m
[03/06 10:26:45]         [35mnum_classes[0m : [92m20[0m
[03/06 10:26:45] ------------------------------------------------------------
[03/06 10:26:45] [35mOPTIMIZER[0m : 
[03/06 10:26:45]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 10:26:45]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 10:26:45]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 10:26:45]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 10:26:45] ------------------------------------------------------------
[03/06 10:26:45] [35mPIPELINE[0m : 
[03/06 10:26:45]     [35mtest[0m : 
[03/06 10:26:45]         [35mdecode[0m : 
[03/06 10:26:45]             [35mbackend[0m : [92mdecord[0m
[03/06 10:26:45]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:26:45]         [35mname[0m : [92mBasePipline[0m
[03/06 10:26:45]         [35msample[0m : 
[03/06 10:26:45]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:26:45]             [35mis_train[0m : [92mFalse[0m
[03/06 10:26:45]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:26:45]             [35msample_mode[0m : [92muniform[0m
[03/06 10:26:45]             [35msample_rate[0m : [92m4[0m
[03/06 10:26:45]             [35msliding_window[0m : [92m32[0m
[03/06 10:26:45]         [35mtransform[0m : 
[03/06 10:26:45]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:26:45]             [35mtransform_list[0m : 
[03/06 10:26:45]                 [35mResize[0m : 
[03/06 10:26:45]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:26:45]                 [35mCenterCrop[0m : 
[03/06 10:26:45]                     [35msize[0m : [92m224[0m
[03/06 10:26:45]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:26:45]                 [35mNormalize[0m : 
[03/06 10:26:45]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:26:45]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:26:45]     [35mtrain[0m : 
[03/06 10:26:45]         [35mdecode[0m : 
[03/06 10:26:45]             [35mbackend[0m : [92mdecord[0m
[03/06 10:26:45]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:26:45]         [35mname[0m : [92mBasePipline[0m
[03/06 10:26:45]         [35msample[0m : 
[03/06 10:26:45]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:26:45]             [35mis_train[0m : [92mTrue[0m
[03/06 10:26:45]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:26:45]             [35msample_mode[0m : [92muniform[0m
[03/06 10:26:45]             [35msample_rate[0m : [92m4[0m
[03/06 10:26:45]             [35msliding_window[0m : [92m32[0m
[03/06 10:26:45]         [35mtransform[0m : 
[03/06 10:26:45]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:26:45]             [35mtransform_list[0m : 
[03/06 10:26:45]                 [35mResize[0m : 
[03/06 10:26:45]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:26:45]                 [35mRandomCrop[0m : 
[03/06 10:26:45]                     [35msize[0m : [92m224[0m
[03/06 10:26:45]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 10:26:45]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:26:45]                 [35mNormalize[0m : 
[03/06 10:26:45]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:26:45]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:26:45] ------------------------------------------------------------
[03/06 10:26:45] [35mPOSTPRECESSING[0m : 
[03/06 10:26:45]     [35mclip_seg_num[0m : [92m8[0m
[03/06 10:26:45]     [35mignore_index[0m : [92m-100[0m
[03/06 10:26:45]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 10:26:45]     [35mnum_action_classes[0m : [92m5[0m
[03/06 10:26:45]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 10:26:45]     [35msample_rate[0m : [92m4[0m
[03/06 10:26:45]     [35msliding_window[0m : [92m32[0m
[03/06 10:26:45] ------------------------------------------------------------
[03/06 10:26:45] [35mepochs[0m : [92m200[0m
[03/06 10:26:45] [35mlog_interval[0m : [92m1[0m
[03/06 10:26:45] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 10:26:45] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
I am here 2
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 173, in train
    runner = Runner(optimizer=optimizer,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 59, in __init__
    self.model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[local_rank], output_device=local_rank)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 663, in __init__
    self.process_group = _get_default_group()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
    raise ValueError(
ValueError: Default process group has not been initialized, please make sure to call init_process_group.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 10:27:34] [35mCOLLATE[0m : 
[03/06 10:27:34]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 10:27:34]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 10:27:34] ------------------------------------------------------------
[03/06 10:27:34] [35mDATASET[0m : 
[03/06 10:27:34]     [35mnum_workers[0m : [92m0[0m
[03/06 10:27:34]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 10:27:34]     [35mtest[0m : 
[03/06 10:27:34]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:27:34]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:27:34]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:27:34]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:27:34]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:27:34]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 10:27:34]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:27:34]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:27:34]         [35msample_rate[0m : [92m4[0m
[03/06 10:27:34]         [35msliding_window[0m : [92m32[0m
[03/06 10:27:34]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 10:27:34]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:27:34]     [35mtrain[0m : 
[03/06 10:27:34]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:27:34]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:27:34]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:27:34]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:27:34]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:27:34]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 10:27:34]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:27:34]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:27:34]         [35msample_rate[0m : [92m4[0m
[03/06 10:27:34]         [35msliding_window[0m : [92m32[0m
[03/06 10:27:34]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 10:27:34]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:27:34]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 10:27:34] ------------------------------------------------------------
[03/06 10:27:34] [35mLRSCHEDULER[0m : 
[03/06 10:27:34]     [35mgamma[0m : [92m0.1[0m
[03/06 10:27:34]     [35mname[0m : [92mMultiStepLR[0m
[03/06 10:27:34]     [35mstep_size[0m : [92m[50][0m
[03/06 10:27:34] ------------------------------------------------------------
[03/06 10:27:34] [35mMETRIC[0m : 
[03/06 10:27:34]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 10:27:34]     [35mfile_output[0m : [92mTrue[0m
[03/06 10:27:34]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 10:27:34]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 10:27:34]     [35mscore_output[0m : [92mTrue[0m
[03/06 10:27:34] ------------------------------------------------------------
[03/06 10:27:34] [35mMODEL[0m : 
[03/06 10:27:34]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 10:27:34]     [35mbackbone[0m : 
[03/06 10:27:34]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:27:34]         [35mname[0m : [92mResNetTSM[0m
[03/06 10:27:34]         [35mout_indices[0m : [92m(3,)[0m
[03/06 10:27:34]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 10:27:34]         [35mshift_div[0m : [92m8[0m
[03/06 10:27:34]     [35mhead[0m : 
[03/06 10:27:34]         [35maction_head[0m : 
[03/06 10:27:34]             [35mdim[0m : [92m2048[0m
[03/06 10:27:34]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:27:34]             [35mnum_classes[0m : [92m5[0m
[03/06 10:27:34]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:27:34]             [35mnum_layers[0m : [92m4[0m
[03/06 10:27:34]             [35mnum_stages[0m : [92m1[0m
[03/06 10:27:34]             [35msample_rate[0m : [92m4[0m
[03/06 10:27:34]         [35mbranch_head[0m : 
[03/06 10:27:34]             [35mdim[0m : [92m2048[0m
[03/06 10:27:34]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:27:34]             [35mnum_classes[0m : [92m15[0m
[03/06 10:27:34]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:27:34]             [35mnum_layers[0m : [92m4[0m
[03/06 10:27:34]             [35mnum_stages[0m : [92m1[0m
[03/06 10:27:34]             [35msample_rate[0m : [92m4[0m
[03/06 10:27:34]         [35msample_rate[0m : [92m4[0m
[03/06 10:27:34]     [35mloss[0m : 
[03/06 10:27:34]         [35mignore_index[0m : [92m-100[0m
[03/06 10:27:34]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 10:27:34]         [35mnum_classes_action[0m : [92m5[0m
[03/06 10:27:34]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 10:27:34]         [35msample_rate[0m : [92m4[0m
[03/06 10:27:34]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 10:27:34]     [35mneck[0m : 
[03/06 10:27:34]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:27:34]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 10:27:34]         [35min_channels[0m : [92m2048[0m
[03/06 10:27:34]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 10:27:34]         [35mneed_pool[0m : [92mTrue[0m
[03/06 10:27:34]         [35mnum_classes[0m : [92m20[0m
[03/06 10:27:34] ------------------------------------------------------------
[03/06 10:27:34] [35mOPTIMIZER[0m : 
[03/06 10:27:34]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 10:27:34]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 10:27:34]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 10:27:34]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 10:27:34] ------------------------------------------------------------
[03/06 10:27:34] [35mPIPELINE[0m : 
[03/06 10:27:34]     [35mtest[0m : 
[03/06 10:27:34]         [35mdecode[0m : 
[03/06 10:27:34]             [35mbackend[0m : [92mdecord[0m
[03/06 10:27:34]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:27:34]         [35mname[0m : [92mBasePipline[0m
[03/06 10:27:34]         [35msample[0m : 
[03/06 10:27:34]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:27:34]             [35mis_train[0m : [92mFalse[0m
[03/06 10:27:34]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:27:34]             [35msample_mode[0m : [92muniform[0m
[03/06 10:27:34]             [35msample_rate[0m : [92m4[0m
[03/06 10:27:34]             [35msliding_window[0m : [92m32[0m
[03/06 10:27:34]         [35mtransform[0m : 
[03/06 10:27:34]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:27:34]             [35mtransform_list[0m : 
[03/06 10:27:34]                 [35mResize[0m : 
[03/06 10:27:34]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:27:34]                 [35mCenterCrop[0m : 
[03/06 10:27:34]                     [35msize[0m : [92m224[0m
[03/06 10:27:34]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:27:34]                 [35mNormalize[0m : 
[03/06 10:27:34]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:27:34]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:27:34]     [35mtrain[0m : 
[03/06 10:27:34]         [35mdecode[0m : 
[03/06 10:27:34]             [35mbackend[0m : [92mdecord[0m
[03/06 10:27:34]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:27:34]         [35mname[0m : [92mBasePipline[0m
[03/06 10:27:34]         [35msample[0m : 
[03/06 10:27:34]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:27:34]             [35mis_train[0m : [92mTrue[0m
[03/06 10:27:34]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:27:34]             [35msample_mode[0m : [92muniform[0m
[03/06 10:27:34]             [35msample_rate[0m : [92m4[0m
[03/06 10:27:34]             [35msliding_window[0m : [92m32[0m
[03/06 10:27:34]         [35mtransform[0m : 
[03/06 10:27:34]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:27:34]             [35mtransform_list[0m : 
[03/06 10:27:34]                 [35mResize[0m : 
[03/06 10:27:34]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:27:34]                 [35mRandomCrop[0m : 
[03/06 10:27:34]                     [35msize[0m : [92m224[0m
[03/06 10:27:34]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 10:27:34]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:27:34]                 [35mNormalize[0m : 
[03/06 10:27:34]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:27:34]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:27:34] ------------------------------------------------------------
[03/06 10:27:34] [35mPOSTPRECESSING[0m : 
[03/06 10:27:34]     [35mclip_seg_num[0m : [92m8[0m
[03/06 10:27:34]     [35mignore_index[0m : [92m-100[0m
[03/06 10:27:34]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 10:27:34]     [35mnum_action_classes[0m : [92m5[0m
[03/06 10:27:34]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 10:27:34]     [35msample_rate[0m : [92m4[0m
[03/06 10:27:34]     [35msliding_window[0m : [92m32[0m
[03/06 10:27:34] ------------------------------------------------------------
[03/06 10:27:34] [35mepochs[0m : [92m200[0m
[03/06 10:27:34] [35mlog_interval[0m : [92m1[0m
[03/06 10:27:34] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 10:27:34] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
I am here 2
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 174, in train
    runner = Runner(optimizer=optimizer,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 59, in __init__
    self.model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[local_rank], output_device=local_rank)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 663, in __init__
    self.process_group = _get_default_group()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
    raise ValueError(
ValueError: Default process group has not been initialized, please make sure to call init_process_group.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 10:28:07] [35mCOLLATE[0m : 
[03/06 10:28:07]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 10:28:07]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 10:28:07] ------------------------------------------------------------
[03/06 10:28:07] [35mDATASET[0m : 
[03/06 10:28:07]     [35mnum_workers[0m : [92m0[0m
[03/06 10:28:07]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 10:28:07]     [35mtest[0m : 
[03/06 10:28:07]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:28:07]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:28:07]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:07]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:28:07]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:28:07]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 10:28:07]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:28:07]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:28:07]         [35msample_rate[0m : [92m4[0m
[03/06 10:28:07]         [35msliding_window[0m : [92m32[0m
[03/06 10:28:07]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 10:28:07]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:28:07]     [35mtrain[0m : 
[03/06 10:28:07]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:28:07]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:28:07]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:07]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:28:07]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:28:07]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 10:28:07]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:28:07]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:28:07]         [35msample_rate[0m : [92m4[0m
[03/06 10:28:07]         [35msliding_window[0m : [92m32[0m
[03/06 10:28:07]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 10:28:07]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:28:07]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 10:28:07] ------------------------------------------------------------
[03/06 10:28:07] [35mLRSCHEDULER[0m : 
[03/06 10:28:07]     [35mgamma[0m : [92m0.1[0m
[03/06 10:28:07]     [35mname[0m : [92mMultiStepLR[0m
[03/06 10:28:07]     [35mstep_size[0m : [92m[50][0m
[03/06 10:28:07] ------------------------------------------------------------
[03/06 10:28:07] [35mMETRIC[0m : 
[03/06 10:28:07]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 10:28:07]     [35mfile_output[0m : [92mTrue[0m
[03/06 10:28:07]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 10:28:07]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 10:28:07]     [35mscore_output[0m : [92mTrue[0m
[03/06 10:28:07] ------------------------------------------------------------
[03/06 10:28:07] [35mMODEL[0m : 
[03/06 10:28:07]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 10:28:07]     [35mbackbone[0m : 
[03/06 10:28:07]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:07]         [35mname[0m : [92mResNetTSM[0m
[03/06 10:28:07]         [35mout_indices[0m : [92m(3,)[0m
[03/06 10:28:07]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 10:28:07]         [35mshift_div[0m : [92m8[0m
[03/06 10:28:07]     [35mhead[0m : 
[03/06 10:28:07]         [35maction_head[0m : 
[03/06 10:28:07]             [35mdim[0m : [92m2048[0m
[03/06 10:28:07]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:28:07]             [35mnum_classes[0m : [92m5[0m
[03/06 10:28:07]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:28:07]             [35mnum_layers[0m : [92m4[0m
[03/06 10:28:07]             [35mnum_stages[0m : [92m1[0m
[03/06 10:28:07]             [35msample_rate[0m : [92m4[0m
[03/06 10:28:07]         [35mbranch_head[0m : 
[03/06 10:28:07]             [35mdim[0m : [92m2048[0m
[03/06 10:28:07]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:28:07]             [35mnum_classes[0m : [92m15[0m
[03/06 10:28:07]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:28:07]             [35mnum_layers[0m : [92m4[0m
[03/06 10:28:07]             [35mnum_stages[0m : [92m1[0m
[03/06 10:28:07]             [35msample_rate[0m : [92m4[0m
[03/06 10:28:07]         [35msample_rate[0m : [92m4[0m
[03/06 10:28:07]     [35mloss[0m : 
[03/06 10:28:07]         [35mignore_index[0m : [92m-100[0m
[03/06 10:28:07]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 10:28:07]         [35mnum_classes_action[0m : [92m5[0m
[03/06 10:28:07]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 10:28:07]         [35msample_rate[0m : [92m4[0m
[03/06 10:28:07]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 10:28:07]     [35mneck[0m : 
[03/06 10:28:07]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:07]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 10:28:07]         [35min_channels[0m : [92m2048[0m
[03/06 10:28:07]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 10:28:07]         [35mneed_pool[0m : [92mTrue[0m
[03/06 10:28:07]         [35mnum_classes[0m : [92m20[0m
[03/06 10:28:07] ------------------------------------------------------------
[03/06 10:28:07] [35mOPTIMIZER[0m : 
[03/06 10:28:07]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 10:28:07]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 10:28:07]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 10:28:07]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 10:28:07] ------------------------------------------------------------
[03/06 10:28:07] [35mPIPELINE[0m : 
[03/06 10:28:07]     [35mtest[0m : 
[03/06 10:28:07]         [35mdecode[0m : 
[03/06 10:28:07]             [35mbackend[0m : [92mdecord[0m
[03/06 10:28:07]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:28:07]         [35mname[0m : [92mBasePipline[0m
[03/06 10:28:07]         [35msample[0m : 
[03/06 10:28:07]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:07]             [35mis_train[0m : [92mFalse[0m
[03/06 10:28:07]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:28:07]             [35msample_mode[0m : [92muniform[0m
[03/06 10:28:07]             [35msample_rate[0m : [92m4[0m
[03/06 10:28:07]             [35msliding_window[0m : [92m32[0m
[03/06 10:28:07]         [35mtransform[0m : 
[03/06 10:28:07]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:28:07]             [35mtransform_list[0m : 
[03/06 10:28:07]                 [35mResize[0m : 
[03/06 10:28:07]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:28:07]                 [35mCenterCrop[0m : 
[03/06 10:28:07]                     [35msize[0m : [92m224[0m
[03/06 10:28:07]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:28:07]                 [35mNormalize[0m : 
[03/06 10:28:07]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:28:07]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:28:07]     [35mtrain[0m : 
[03/06 10:28:07]         [35mdecode[0m : 
[03/06 10:28:07]             [35mbackend[0m : [92mdecord[0m
[03/06 10:28:07]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:28:07]         [35mname[0m : [92mBasePipline[0m
[03/06 10:28:07]         [35msample[0m : 
[03/06 10:28:07]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:07]             [35mis_train[0m : [92mTrue[0m
[03/06 10:28:07]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:28:07]             [35msample_mode[0m : [92muniform[0m
[03/06 10:28:07]             [35msample_rate[0m : [92m4[0m
[03/06 10:28:07]             [35msliding_window[0m : [92m32[0m
[03/06 10:28:07]         [35mtransform[0m : 
[03/06 10:28:07]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:28:07]             [35mtransform_list[0m : 
[03/06 10:28:07]                 [35mResize[0m : 
[03/06 10:28:07]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:28:07]                 [35mRandomCrop[0m : 
[03/06 10:28:07]                     [35msize[0m : [92m224[0m
[03/06 10:28:07]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 10:28:07]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:28:07]                 [35mNormalize[0m : 
[03/06 10:28:07]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:28:07]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:28:07] ------------------------------------------------------------
[03/06 10:28:07] [35mPOSTPRECESSING[0m : 
[03/06 10:28:07]     [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:07]     [35mignore_index[0m : [92m-100[0m
[03/06 10:28:07]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 10:28:07]     [35mnum_action_classes[0m : [92m5[0m
[03/06 10:28:07]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 10:28:07]     [35msample_rate[0m : [92m4[0m
[03/06 10:28:07]     [35msliding_window[0m : [92m32[0m
[03/06 10:28:07] ------------------------------------------------------------
[03/06 10:28:07] [35mepochs[0m : [92m200[0m
[03/06 10:28:07] [35mlog_interval[0m : [92m1[0m
[03/06 10:28:07] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 10:28:07] [35msave_interval[0m : [92m50[0m
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
I am here 2
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 174, in train
    runner = Runner(optimizer=optimizer,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 59, in __init__
    self.model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[local_rank], output_device=local_rank)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 663, in __init__
    self.process_group = _get_default_group()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
    raise ValueError(
ValueError: Default process group has not been initialized, please make sure to call init_process_group.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 10:28:46] [35mCOLLATE[0m : 
[03/06 10:28:46]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 10:28:46]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 10:28:46] ------------------------------------------------------------
[03/06 10:28:46] [35mDATASET[0m : 
[03/06 10:28:46]     [35mnum_workers[0m : [92m0[0m
[03/06 10:28:46]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 10:28:46]     [35mtest[0m : 
[03/06 10:28:46]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:28:46]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:28:46]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:46]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:28:46]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:28:46]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 10:28:46]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:28:46]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:28:46]         [35msample_rate[0m : [92m4[0m
[03/06 10:28:46]         [35msliding_window[0m : [92m32[0m
[03/06 10:28:46]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 10:28:46]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:28:46]     [35mtrain[0m : 
[03/06 10:28:46]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:28:46]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:28:46]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:46]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:28:46]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:28:46]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 10:28:46]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:28:46]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:28:46]         [35msample_rate[0m : [92m4[0m
[03/06 10:28:46]         [35msliding_window[0m : [92m32[0m
[03/06 10:28:46]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 10:28:46]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:28:46]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 10:28:46] ------------------------------------------------------------
[03/06 10:28:46] [35mLRSCHEDULER[0m : 
[03/06 10:28:46]     [35mgamma[0m : [92m0.1[0m
[03/06 10:28:46]     [35mname[0m : [92mMultiStepLR[0m
[03/06 10:28:46]     [35mstep_size[0m : [92m[50][0m
[03/06 10:28:46] ------------------------------------------------------------
[03/06 10:28:46] [35mMETRIC[0m : 
[03/06 10:28:46]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 10:28:46]     [35mfile_output[0m : [92mTrue[0m
[03/06 10:28:46]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 10:28:46]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 10:28:46]     [35mscore_output[0m : [92mTrue[0m
[03/06 10:28:46] ------------------------------------------------------------
[03/06 10:28:46] [35mMODEL[0m : 
[03/06 10:28:46]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 10:28:46]     [35mbackbone[0m : 
[03/06 10:28:46]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:46]         [35mname[0m : [92mResNetTSM[0m
[03/06 10:28:46]         [35mout_indices[0m : [92m(3,)[0m
[03/06 10:28:46]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 10:28:46]         [35mshift_div[0m : [92m8[0m
[03/06 10:28:46]     [35mhead[0m : 
[03/06 10:28:46]         [35maction_head[0m : 
[03/06 10:28:46]             [35mdim[0m : [92m2048[0m
[03/06 10:28:46]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:28:46]             [35mnum_classes[0m : [92m5[0m
[03/06 10:28:46]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:28:46]             [35mnum_layers[0m : [92m4[0m
[03/06 10:28:46]             [35mnum_stages[0m : [92m1[0m
[03/06 10:28:46]             [35msample_rate[0m : [92m4[0m
[03/06 10:28:46]         [35mbranch_head[0m : 
[03/06 10:28:46]             [35mdim[0m : [92m2048[0m
[03/06 10:28:46]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:28:46]             [35mnum_classes[0m : [92m15[0m
[03/06 10:28:46]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:28:46]             [35mnum_layers[0m : [92m4[0m
[03/06 10:28:46]             [35mnum_stages[0m : [92m1[0m
[03/06 10:28:46]             [35msample_rate[0m : [92m4[0m
[03/06 10:28:46]         [35msample_rate[0m : [92m4[0m
[03/06 10:28:46]     [35mloss[0m : 
[03/06 10:28:46]         [35mignore_index[0m : [92m-100[0m
[03/06 10:28:46]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 10:28:46]         [35mnum_classes_action[0m : [92m5[0m
[03/06 10:28:46]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 10:28:46]         [35msample_rate[0m : [92m4[0m
[03/06 10:28:46]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 10:28:46]     [35mneck[0m : 
[03/06 10:28:46]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:46]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 10:28:46]         [35min_channels[0m : [92m2048[0m
[03/06 10:28:46]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 10:28:46]         [35mneed_pool[0m : [92mTrue[0m
[03/06 10:28:46]         [35mnum_classes[0m : [92m20[0m
[03/06 10:28:46] ------------------------------------------------------------
[03/06 10:28:46] [35mOPTIMIZER[0m : 
[03/06 10:28:46]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 10:28:46]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 10:28:46]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 10:28:46]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 10:28:46] ------------------------------------------------------------
[03/06 10:28:46] [35mPIPELINE[0m : 
[03/06 10:28:46]     [35mtest[0m : 
[03/06 10:28:46]         [35mdecode[0m : 
[03/06 10:28:46]             [35mbackend[0m : [92mdecord[0m
[03/06 10:28:46]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:28:46]         [35mname[0m : [92mBasePipline[0m
[03/06 10:28:46]         [35msample[0m : 
[03/06 10:28:46]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:46]             [35mis_train[0m : [92mFalse[0m
[03/06 10:28:46]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:28:46]             [35msample_mode[0m : [92muniform[0m
[03/06 10:28:46]             [35msample_rate[0m : [92m4[0m
[03/06 10:28:46]             [35msliding_window[0m : [92m32[0m
[03/06 10:28:46]         [35mtransform[0m : 
[03/06 10:28:46]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:28:46]             [35mtransform_list[0m : 
[03/06 10:28:46]                 [35mResize[0m : 
[03/06 10:28:46]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:28:46]                 [35mCenterCrop[0m : 
[03/06 10:28:46]                     [35msize[0m : [92m224[0m
[03/06 10:28:46]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:28:46]                 [35mNormalize[0m : 
[03/06 10:28:46]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:28:46]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:28:46]     [35mtrain[0m : 
[03/06 10:28:46]         [35mdecode[0m : 
[03/06 10:28:46]             [35mbackend[0m : [92mdecord[0m
[03/06 10:28:46]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:28:46]         [35mname[0m : [92mBasePipline[0m
[03/06 10:28:46]         [35msample[0m : 
[03/06 10:28:46]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:46]             [35mis_train[0m : [92mTrue[0m
[03/06 10:28:46]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:28:46]             [35msample_mode[0m : [92muniform[0m
[03/06 10:28:46]             [35msample_rate[0m : [92m4[0m
[03/06 10:28:46]             [35msliding_window[0m : [92m32[0m
[03/06 10:28:46]         [35mtransform[0m : 
[03/06 10:28:46]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:28:46]             [35mtransform_list[0m : 
[03/06 10:28:46]                 [35mResize[0m : 
[03/06 10:28:46]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:28:46]                 [35mRandomCrop[0m : 
[03/06 10:28:46]                     [35msize[0m : [92m224[0m
[03/06 10:28:46]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 10:28:46]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:28:46]                 [35mNormalize[0m : 
[03/06 10:28:46]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:28:46]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:28:46] ------------------------------------------------------------
[03/06 10:28:46] [35mPOSTPRECESSING[0m : 
[03/06 10:28:46]     [35mclip_seg_num[0m : [92m8[0m
[03/06 10:28:46]     [35mignore_index[0m : [92m-100[0m
[03/06 10:28:46]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 10:28:46]     [35mnum_action_classes[0m : [92m5[0m
[03/06 10:28:46]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 10:28:46]     [35msample_rate[0m : [92m4[0m
[03/06 10:28:46]     [35msliding_window[0m : [92m32[0m
[03/06 10:28:46] ------------------------------------------------------------
[03/06 10:28:46] [35mepochs[0m : [92m200[0m
[03/06 10:28:46] [35mlog_interval[0m : [92m1[0m
[03/06 10:28:46] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 10:28:46] [35msave_interval[0m : [92m50[0m
> /home/multi-gpu/amur/copilot/copilot-svtas/main.py(104)main()
-> if args.test:
(Pdb) (Pdb) /home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 10:29:12] [35mCOLLATE[0m : 
[03/06 10:29:12]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 10:29:12]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 10:29:12] ------------------------------------------------------------
[03/06 10:29:12] [35mDATASET[0m : 
[03/06 10:29:12]     [35mnum_workers[0m : [92m0[0m
[03/06 10:29:12]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 10:29:12]     [35mtest[0m : 
[03/06 10:29:12]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:29:12]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:29:12]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:12]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:29:12]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:29:12]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 10:29:12]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:29:12]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:29:12]         [35msample_rate[0m : [92m4[0m
[03/06 10:29:12]         [35msliding_window[0m : [92m32[0m
[03/06 10:29:12]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 10:29:12]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:29:12]     [35mtrain[0m : 
[03/06 10:29:12]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:29:12]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:29:12]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:12]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:29:12]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:29:12]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 10:29:12]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:29:12]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:29:12]         [35msample_rate[0m : [92m4[0m
[03/06 10:29:12]         [35msliding_window[0m : [92m32[0m
[03/06 10:29:12]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 10:29:12]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:29:12]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 10:29:12] ------------------------------------------------------------
[03/06 10:29:12] [35mLRSCHEDULER[0m : 
[03/06 10:29:12]     [35mgamma[0m : [92m0.1[0m
[03/06 10:29:12]     [35mname[0m : [92mMultiStepLR[0m
[03/06 10:29:12]     [35mstep_size[0m : [92m[50][0m
[03/06 10:29:12] ------------------------------------------------------------
[03/06 10:29:12] [35mMETRIC[0m : 
[03/06 10:29:12]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 10:29:12]     [35mfile_output[0m : [92mTrue[0m
[03/06 10:29:12]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 10:29:12]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 10:29:12]     [35mscore_output[0m : [92mTrue[0m
[03/06 10:29:12] ------------------------------------------------------------
[03/06 10:29:12] [35mMODEL[0m : 
[03/06 10:29:12]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 10:29:12]     [35mbackbone[0m : 
[03/06 10:29:12]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:12]         [35mname[0m : [92mResNetTSM[0m
[03/06 10:29:12]         [35mout_indices[0m : [92m(3,)[0m
[03/06 10:29:12]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 10:29:12]         [35mshift_div[0m : [92m8[0m
[03/06 10:29:12]     [35mhead[0m : 
[03/06 10:29:12]         [35maction_head[0m : 
[03/06 10:29:12]             [35mdim[0m : [92m2048[0m
[03/06 10:29:12]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:29:12]             [35mnum_classes[0m : [92m5[0m
[03/06 10:29:12]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:29:12]             [35mnum_layers[0m : [92m4[0m
[03/06 10:29:12]             [35mnum_stages[0m : [92m1[0m
[03/06 10:29:12]             [35msample_rate[0m : [92m4[0m
[03/06 10:29:12]         [35mbranch_head[0m : 
[03/06 10:29:12]             [35mdim[0m : [92m2048[0m
[03/06 10:29:12]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:29:12]             [35mnum_classes[0m : [92m15[0m
[03/06 10:29:12]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:29:12]             [35mnum_layers[0m : [92m4[0m
[03/06 10:29:12]             [35mnum_stages[0m : [92m1[0m
[03/06 10:29:12]             [35msample_rate[0m : [92m4[0m
[03/06 10:29:12]         [35msample_rate[0m : [92m4[0m
[03/06 10:29:12]     [35mloss[0m : 
[03/06 10:29:12]         [35mignore_index[0m : [92m-100[0m
[03/06 10:29:12]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 10:29:12]         [35mnum_classes_action[0m : [92m5[0m
[03/06 10:29:12]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 10:29:12]         [35msample_rate[0m : [92m4[0m
[03/06 10:29:12]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 10:29:12]     [35mneck[0m : 
[03/06 10:29:12]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:12]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 10:29:12]         [35min_channels[0m : [92m2048[0m
[03/06 10:29:12]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 10:29:12]         [35mneed_pool[0m : [92mTrue[0m
[03/06 10:29:12]         [35mnum_classes[0m : [92m20[0m
[03/06 10:29:12] ------------------------------------------------------------
[03/06 10:29:12] [35mOPTIMIZER[0m : 
[03/06 10:29:12]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 10:29:12]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 10:29:12]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 10:29:12]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 10:29:12] ------------------------------------------------------------
[03/06 10:29:12] [35mPIPELINE[0m : 
[03/06 10:29:12]     [35mtest[0m : 
[03/06 10:29:12]         [35mdecode[0m : 
[03/06 10:29:12]             [35mbackend[0m : [92mdecord[0m
[03/06 10:29:12]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:29:12]         [35mname[0m : [92mBasePipline[0m
[03/06 10:29:12]         [35msample[0m : 
[03/06 10:29:12]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:12]             [35mis_train[0m : [92mFalse[0m
[03/06 10:29:12]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:29:12]             [35msample_mode[0m : [92muniform[0m
[03/06 10:29:12]             [35msample_rate[0m : [92m4[0m
[03/06 10:29:12]             [35msliding_window[0m : [92m32[0m
[03/06 10:29:12]         [35mtransform[0m : 
[03/06 10:29:12]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:29:12]             [35mtransform_list[0m : 
[03/06 10:29:12]                 [35mResize[0m : 
[03/06 10:29:12]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:29:12]                 [35mCenterCrop[0m : 
[03/06 10:29:12]                     [35msize[0m : [92m224[0m
[03/06 10:29:12]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:29:12]                 [35mNormalize[0m : 
[03/06 10:29:12]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:29:12]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:29:12]     [35mtrain[0m : 
[03/06 10:29:12]         [35mdecode[0m : 
[03/06 10:29:12]             [35mbackend[0m : [92mdecord[0m
[03/06 10:29:12]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:29:12]         [35mname[0m : [92mBasePipline[0m
[03/06 10:29:12]         [35msample[0m : 
[03/06 10:29:12]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:12]             [35mis_train[0m : [92mTrue[0m
[03/06 10:29:12]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:29:12]             [35msample_mode[0m : [92muniform[0m
[03/06 10:29:12]             [35msample_rate[0m : [92m4[0m
[03/06 10:29:12]             [35msliding_window[0m : [92m32[0m
[03/06 10:29:12]         [35mtransform[0m : 
[03/06 10:29:12]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:29:12]             [35mtransform_list[0m : 
[03/06 10:29:12]                 [35mResize[0m : 
[03/06 10:29:12]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:29:12]                 [35mRandomCrop[0m : 
[03/06 10:29:12]                     [35msize[0m : [92m224[0m
[03/06 10:29:12]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 10:29:12]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:29:12]                 [35mNormalize[0m : 
[03/06 10:29:12]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:29:12]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:29:12] ------------------------------------------------------------
[03/06 10:29:12] [35mPOSTPRECESSING[0m : 
[03/06 10:29:12]     [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:12]     [35mignore_index[0m : [92m-100[0m
[03/06 10:29:12]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 10:29:12]     [35mnum_action_classes[0m : [92m5[0m
[03/06 10:29:12]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 10:29:12]     [35msample_rate[0m : [92m4[0m
[03/06 10:29:12]     [35msliding_window[0m : [92m32[0m
[03/06 10:29:12] ------------------------------------------------------------
[03/06 10:29:12] [35mepochs[0m : [92m200[0m
[03/06 10:29:12] [35mlog_interval[0m : [92m1[0m
[03/06 10:29:12] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 10:29:12] [35msave_interval[0m : [92m50[0m
Namespace(config='config/resnet50tsm_memory_tcn_split1_32sw_multilabel.yaml', launcher='pytorch', local_rank=-1, max_iters=None, override=[], seed=43335, test=False, use_amp=False, use_tensorboard=False, validate=True, weights=None)
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
I am here 2
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 173, in train
    runner = Runner(optimizer=optimizer,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 59, in __init__
    self.model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[local_rank], output_device=local_rank)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 663, in __init__
    self.process_group = _get_default_group()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
    raise ValueError(
ValueError: Default process group has not been initialized, please make sure to call init_process_group.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
[03/06 10:29:34] [35mCOLLATE[0m : 
[03/06 10:29:34]     [35mname[0m : [92mStreamBatchCompose[0m
[03/06 10:29:34]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[03/06 10:29:34] ------------------------------------------------------------
[03/06 10:29:34] [35mDATASET[0m : 
[03/06 10:29:34]     [35mnum_workers[0m : [92m0[0m
[03/06 10:29:34]     [35mtemporal_clip_batch_size[0m : [92m2[0m
[03/06 10:29:34]     [35mtest[0m : 
[03/06 10:29:34]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:29:34]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:29:34]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:34]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:29:34]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:29:34]         [35mfile_path[0m : [92m./data/thal/splits/test.bundle[0m
[03/06 10:29:34]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:29:34]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:29:34]         [35msample_rate[0m : [92m4[0m
[03/06 10:29:34]         [35msliding_window[0m : [92m32[0m
[03/06 10:29:34]         [35mtrain_mode[0m : [92mFalse[0m
[03/06 10:29:34]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:29:34]     [35mtrain[0m : 
[03/06 10:29:34]         [35mactions_map_file_path[0m : [92m./data/thal/mapping_tasks.txt[0m
[03/06 10:29:34]         [35mbranches_map_file_path[0m : [92m./data/thal/mapping_branches.txt[0m
[03/06 10:29:34]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:34]         [35mdata_prefix[0m : [92m./[0m
[03/06 10:29:34]         [35mdataset_type[0m : [92mgtea[0m
[03/06 10:29:34]         [35mfile_path[0m : [92m./data/thal/splits/train.bundle[0m
[03/06 10:29:34]         [35mgt_path[0m : [92m./data/thal/groundTruth_split[0m
[03/06 10:29:34]         [35mname[0m : [92mRawFrameStreamSegmentationDatasetMultiLabel[0m
[03/06 10:29:34]         [35msample_rate[0m : [92m4[0m
[03/06 10:29:34]         [35msliding_window[0m : [92m32[0m
[03/06 10:29:34]         [35mtrain_mode[0m : [92mTrue[0m
[03/06 10:29:34]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[03/06 10:29:34]     [35mvideo_batch_size[0m : [92m4[0m
[03/06 10:29:34] ------------------------------------------------------------
[03/06 10:29:34] [35mLRSCHEDULER[0m : 
[03/06 10:29:34]     [35mgamma[0m : [92m0.1[0m
[03/06 10:29:34]     [35mname[0m : [92mMultiStepLR[0m
[03/06 10:29:34]     [35mstep_size[0m : [92m[50][0m
[03/06 10:29:34] ------------------------------------------------------------
[03/06 10:29:34] [35mMETRIC[0m : 
[03/06 10:29:34]     [35mactions_map_file_path[0m : [92m./data/thal/mapping_split.txt[0m
[03/06 10:29:34]     [35mfile_output[0m : [92mTrue[0m
[03/06 10:29:34]     [35mname[0m : [92mTASegmentationMetric[0m
[03/06 10:29:34]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[03/06 10:29:34]     [35mscore_output[0m : [92mTrue[0m
[03/06 10:29:34] ------------------------------------------------------------
[03/06 10:29:34] [35mMODEL[0m : 
[03/06 10:29:34]     [35marchitecture[0m : [92mStreamSegmentation2DMultiLabel[0m
[03/06 10:29:34]     [35mbackbone[0m : 
[03/06 10:29:34]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:34]         [35mname[0m : [92mResNetTSM[0m
[03/06 10:29:34]         [35mout_indices[0m : [92m(3,)[0m
[03/06 10:29:34]         [35mpretrained[0m : [92mdata/clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[03/06 10:29:34]         [35mshift_div[0m : [92m8[0m
[03/06 10:29:34]     [35mhead[0m : 
[03/06 10:29:34]         [35maction_head[0m : 
[03/06 10:29:34]             [35mdim[0m : [92m2048[0m
[03/06 10:29:34]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:29:34]             [35mnum_classes[0m : [92m5[0m
[03/06 10:29:34]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:29:34]             [35mnum_layers[0m : [92m4[0m
[03/06 10:29:34]             [35mnum_stages[0m : [92m1[0m
[03/06 10:29:34]             [35msample_rate[0m : [92m4[0m
[03/06 10:29:34]         [35mbranch_head[0m : 
[03/06 10:29:34]             [35mdim[0m : [92m2048[0m
[03/06 10:29:34]             [35mname[0m : [92mMemoryTCNHead[0m
[03/06 10:29:34]             [35mnum_classes[0m : [92m15[0m
[03/06 10:29:34]             [35mnum_f_maps[0m : [92m64[0m
[03/06 10:29:34]             [35mnum_layers[0m : [92m4[0m
[03/06 10:29:34]             [35mnum_stages[0m : [92m1[0m
[03/06 10:29:34]             [35msample_rate[0m : [92m4[0m
[03/06 10:29:34]         [35msample_rate[0m : [92m4[0m
[03/06 10:29:34]     [35mloss[0m : 
[03/06 10:29:34]         [35mignore_index[0m : [92m-100[0m
[03/06 10:29:34]         [35mname[0m : [92mSegmentationLossMultiLabel[0m
[03/06 10:29:34]         [35mnum_classes_action[0m : [92m5[0m
[03/06 10:29:34]         [35mnum_classes_branches[0m : [92m15[0m
[03/06 10:29:34]         [35msample_rate[0m : [92m4[0m
[03/06 10:29:34]         [35msmooth_weight[0m : [92m0.15[0m
[03/06 10:29:34]     [35mneck[0m : 
[03/06 10:29:34]         [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:34]         [35mdrop_ratio[0m : [92m0.5[0m
[03/06 10:29:34]         [35min_channels[0m : [92m2048[0m
[03/06 10:29:34]         [35mname[0m : [92mAvgPoolNeck[0m
[03/06 10:29:34]         [35mneed_pool[0m : [92mTrue[0m
[03/06 10:29:34]         [35mnum_classes[0m : [92m20[0m
[03/06 10:29:34] ------------------------------------------------------------
[03/06 10:29:34] [35mOPTIMIZER[0m : 
[03/06 10:29:34]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[03/06 10:29:34]     [35mlearning_rate[0m : [92m0.0005[0m
[03/06 10:29:34]     [35mname[0m : [92mTSMAdamOptimizer[0m
[03/06 10:29:34]     [35mweight_decay[0m : [92m0.0001[0m
[03/06 10:29:34] ------------------------------------------------------------
[03/06 10:29:34] [35mPIPELINE[0m : 
[03/06 10:29:34]     [35mtest[0m : 
[03/06 10:29:34]         [35mdecode[0m : 
[03/06 10:29:34]             [35mbackend[0m : [92mdecord[0m
[03/06 10:29:34]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:29:34]         [35mname[0m : [92mBasePipline[0m
[03/06 10:29:34]         [35msample[0m : 
[03/06 10:29:34]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:34]             [35mis_train[0m : [92mFalse[0m
[03/06 10:29:34]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:29:34]             [35msample_mode[0m : [92muniform[0m
[03/06 10:29:34]             [35msample_rate[0m : [92m4[0m
[03/06 10:29:34]             [35msliding_window[0m : [92m32[0m
[03/06 10:29:34]         [35mtransform[0m : 
[03/06 10:29:34]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:29:34]             [35mtransform_list[0m : 
[03/06 10:29:34]                 [35mResize[0m : 
[03/06 10:29:34]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:29:34]                 [35mCenterCrop[0m : 
[03/06 10:29:34]                     [35msize[0m : [92m224[0m
[03/06 10:29:34]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:29:34]                 [35mNormalize[0m : 
[03/06 10:29:34]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:29:34]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:29:34]     [35mtrain[0m : 
[03/06 10:29:34]         [35mdecode[0m : 
[03/06 10:29:34]             [35mbackend[0m : [92mdecord[0m
[03/06 10:29:34]             [35mname[0m : [92mVideoDecoder[0m
[03/06 10:29:34]         [35mname[0m : [92mBasePipline[0m
[03/06 10:29:34]         [35msample[0m : 
[03/06 10:29:34]             [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:34]             [35mis_train[0m : [92mTrue[0m
[03/06 10:29:34]             [35mname[0m : [92mVideoStreamSamplerMultiLabel[0m
[03/06 10:29:34]             [35msample_mode[0m : [92muniform[0m
[03/06 10:29:34]             [35msample_rate[0m : [92m4[0m
[03/06 10:29:34]             [35msliding_window[0m : [92m32[0m
[03/06 10:29:34]         [35mtransform[0m : 
[03/06 10:29:34]             [35mname[0m : [92mVideoStreamTransform[0m
[03/06 10:29:34]             [35mtransform_list[0m : 
[03/06 10:29:34]                 [35mResize[0m : 
[03/06 10:29:34]                     [35msize[0m : [92m[224, 224][0m
[03/06 10:29:34]                 [35mRandomCrop[0m : 
[03/06 10:29:34]                     [35msize[0m : [92m224[0m
[03/06 10:29:34]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[03/06 10:29:34]                 [35mToTensor[0m : [92mNone[0m
[03/06 10:29:34]                 [35mNormalize[0m : 
[03/06 10:29:34]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[03/06 10:29:34]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[03/06 10:29:34] ------------------------------------------------------------
[03/06 10:29:34] [35mPOSTPRECESSING[0m : 
[03/06 10:29:34]     [35mclip_seg_num[0m : [92m8[0m
[03/06 10:29:34]     [35mignore_index[0m : [92m-100[0m
[03/06 10:29:34]     [35mname[0m : [92mStreamScorePostProcessingMultiLabel[0m
[03/06 10:29:34]     [35mnum_action_classes[0m : [92m5[0m
[03/06 10:29:34]     [35mnum_branch_classes[0m : [92m15[0m
[03/06 10:29:34]     [35msample_rate[0m : [92m4[0m
[03/06 10:29:34]     [35msliding_window[0m : [92m32[0m
[03/06 10:29:34] ------------------------------------------------------------
[03/06 10:29:34] [35mepochs[0m : [92m200[0m
[03/06 10:29:34] [35mlog_interval[0m : [92m1[0m
[03/06 10:29:34] [35mmodel_name[0m : [92mGPUTEST[0m
[03/06 10:29:34] [35msave_interval[0m : [92m50[0m
-1
/home/multi-gpu/amur/copilot/copilot-svtas/model/architectures/segmentation/stream_segmentation2d.py:170: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  self.det_weights = torch.load('data/new_cleaned.pth')
det backbone loaded
det backbone freezed
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/albumentations/core/composition.py:168: UserWarning: ShiftScaleRotate could work incorrectly in ReplayMode for other input data because its' params depend on targets.
  t.set_deterministic(flag, save_key)
I am here 2
Traceback (most recent call last):
  File "main.py", line 121, in <module>
    main()
  File "main.py", line 111, in main
    train(cfg,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/train.py", line 173, in train
    runner = Runner(optimizer=optimizer,
  File "/home/multi-gpu/amur/copilot/copilot-svtas/tasks/runner.py", line 59, in __init__
    self.model = torch.nn.parallel.DistributedDataParallel(model, device_ids=[local_rank], output_device=local_rank)
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 663, in __init__
    self.process_group = _get_default_group()
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/torch/distributed/distributed_c10d.py", line 1025, in _get_default_group
    raise ValueError(
ValueError: Default process group has not been initialized, please make sure to call init_process_group.
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/site-packages/mmcv/cnn/bricks/transformer.py:33: UserWarning: Fail to import ``MultiScaleDeformableAttention`` from ``mmcv.ops.multi_scale_deform_attn``, You should install ``mmcv-full`` if you need this module. 
  warnings.warn('Fail to import ``MultiScaleDeformableAttention`` from '
INFO:albumentations.check_version:A new version of Albumentations is available: 2.0.5 (you have 1.4.10). Upgrade using: pip install --upgrade albumentations
Traceback (most recent call last):
  File "main.py", line 123, in <module>
    main()
  File "main.py", line 81, in main
    args = parse_args()
  File "main.py", line 75, in parse_args
    args.local_rank = int(os.environ["LOCAL_RANK"])
  File "/home/multi-gpu/anaconda3/envs/svtas/lib/python3.8/os.py", line 675, in __getitem__
    raise KeyError(key) from None
KeyError: 'LOCAL_RANK'
