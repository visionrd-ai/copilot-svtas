[12/24 14:30:38] [35mCOLLATE[0m : 
[12/24 14:30:38]     [35mname[0m : [92mStreamBatchCompose[0m
[12/24 14:30:38]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[12/24 14:30:38] ------------------------------------------------------------
[12/24 14:30:38] [35mDATASET[0m : 
[12/24 14:30:38]     [35mnum_workers[0m : [92m0[0m
[12/24 14:30:38]     [35mtemporal_clip_batch_size[0m : [92m3[0m
[12/24 14:30:38]     [35mtest[0m : 
[12/24 14:30:38]         [35mactions_map_file_path[0m : [92m./data/thal/mapping.txt[0m
[12/24 14:30:38]         [35mclip_seg_num[0m : [92m32[0m
[12/24 14:30:38]         [35mdata_prefix[0m : [92m./[0m
[12/24 14:30:38]         [35mdataset_type[0m : [92mgtea[0m
[12/24 14:30:38]         [35mfile_path[0m : [92m./data/thal/splits/test.split1.bundle[0m
[12/24 14:30:38]         [35mgt_path[0m : [92m./data/thal/groundTruth[0m
[12/24 14:30:38]         [35mname[0m : [92mRawFrameStreamSegmentationDataset[0m
[12/24 14:30:38]         [35msample_rate[0m : [92m4[0m
[12/24 14:30:38]         [35msliding_window[0m : [92m128[0m
[12/24 14:30:38]         [35mtrain_mode[0m : [92mFalse[0m
[12/24 14:30:38]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[12/24 14:30:38]     [35mtrain[0m : 
[12/24 14:30:38]         [35mactions_map_file_path[0m : [92m./data/thal/mapping.txt[0m
[12/24 14:30:38]         [35mclip_seg_num[0m : [92m32[0m
[12/24 14:30:38]         [35mdata_prefix[0m : [92m./[0m
[12/24 14:30:38]         [35mdataset_type[0m : [92mgtea[0m
[12/24 14:30:38]         [35mfile_path[0m : [92m./data/thal/splits/train.split1.bundle[0m
[12/24 14:30:38]         [35mgt_path[0m : [92m./data/thal/groundTruth[0m
[12/24 14:30:38]         [35mname[0m : [92mRawFrameStreamSegmentationDataset[0m
[12/24 14:30:38]         [35msample_rate[0m : [92m4[0m
[12/24 14:30:38]         [35msliding_window[0m : [92m128[0m
[12/24 14:30:38]         [35mtrain_mode[0m : [92mTrue[0m
[12/24 14:30:38]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[12/24 14:30:38]     [35mvideo_batch_size[0m : [92m2[0m
[12/24 14:30:38] ------------------------------------------------------------
[12/24 14:30:38] [35mLRSCHEDULER[0m : 
[12/24 14:30:38]     [35mgamma[0m : [92m0.1[0m
[12/24 14:30:38]     [35mname[0m : [92mMultiStepLR[0m
[12/24 14:30:38]     [35mstep_size[0m : [92m[50][0m
[12/24 14:30:38] ------------------------------------------------------------
[12/24 14:30:38] [35mMETRIC[0m : 
[12/24 14:30:38]     [35mactions_map_file_path[0m : [92m./data/thal/mapping.txt[0m
[12/24 14:30:38]     [35mfile_output[0m : [92mTrue[0m
[12/24 14:30:38]     [35mname[0m : [92mTASegmentationMetric[0m
[12/24 14:30:38]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[12/24 14:30:38]     [35mscore_output[0m : [92mTrue[0m
[12/24 14:30:38] ------------------------------------------------------------
[12/24 14:30:38] [35mMODEL[0m : 
[12/24 14:30:38]     [35marchitecture[0m : [92mStreamSegmentation2D[0m
[12/24 14:30:38]     [35mbackbone[0m : 
[12/24 14:30:38]         [35mclip_seg_num[0m : [92m32[0m
[12/24 14:30:38]         [35mname[0m : [92mResNetTSM[0m
[12/24 14:30:38]         [35mout_indices[0m : [92m(3,)[0m
[12/24 14:30:38]         [35mpretrained[0m : [92mdata/tsm_r50_dense_256p_1x1x8_100e_kinetics400_rgb_20200727-e1e0c785.pth[0m
[12/24 14:30:38]         [35mshift_div[0m : [92m8[0m
[12/24 14:30:38]     [35mhead[0m : 
[12/24 14:30:38]         [35mdim[0m : [92m2048[0m
[12/24 14:30:38]         [35mname[0m : [92mMemoryTCNHead[0m
[12/24 14:30:38]         [35mnum_classes[0m : [92m5[0m
[12/24 14:30:38]         [35mnum_f_maps[0m : [92m64[0m
[12/24 14:30:38]         [35mnum_layers[0m : [92m4[0m
[12/24 14:30:38]         [35mnum_stages[0m : [92m1[0m
[12/24 14:30:38]         [35msample_rate[0m : [92m4[0m
[12/24 14:30:38]     [35mloss[0m : 
[12/24 14:30:38]         [35mignore_index[0m : [92m-100[0m
[12/24 14:30:38]         [35mname[0m : [92mSegmentationLoss[0m
[12/24 14:30:38]         [35mnum_classes[0m : [92m5[0m
[12/24 14:30:38]         [35msample_rate[0m : [92m4[0m
[12/24 14:30:38]         [35msmooth_weight[0m : [92m0.15[0m
[12/24 14:30:38]     [35mneck[0m : 
[12/24 14:30:38]         [35mclip_seg_num[0m : [92m32[0m
[12/24 14:30:38]         [35mdrop_ratio[0m : [92m0.5[0m
[12/24 14:30:38]         [35min_channels[0m : [92m2048[0m
[12/24 14:30:38]         [35mname[0m : [92mAvgPoolNeck[0m
[12/24 14:30:38]         [35mneed_pool[0m : [92mTrue[0m
[12/24 14:30:38]         [35mnum_classes[0m : [92m5[0m
[12/24 14:30:38] ------------------------------------------------------------
[12/24 14:30:38] [35mOPTIMIZER[0m : 
[12/24 14:30:38]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[12/24 14:30:38]     [35mlearning_rate[0m : [92m0.0005[0m
[12/24 14:30:38]     [35mname[0m : [92mTSMAdamOptimizer[0m
[12/24 14:30:38]     [35mweight_decay[0m : [92m0.0001[0m
[12/24 14:30:38] ------------------------------------------------------------
[12/24 14:30:38] [35mPIPELINE[0m : 
[12/24 14:30:38]     [35mtest[0m : 
[12/24 14:30:38]         [35mdecode[0m : 
[12/24 14:30:38]             [35mbackend[0m : [92mdecord[0m
[12/24 14:30:38]             [35mname[0m : [92mVideoDecoder[0m
[12/24 14:30:38]         [35mname[0m : [92mBasePipline[0m
[12/24 14:30:38]         [35msample[0m : 
[12/24 14:30:38]             [35mclip_seg_num[0m : [92m32[0m
[12/24 14:30:38]             [35mis_train[0m : [92m./data/resnet_tsm_224_new.pth[0m
[12/24 14:30:38]             [35mname[0m : [92mVideoStreamSampler[0m
[12/24 14:30:38]             [35msample_mode[0m : [92muniform[0m
[12/24 14:30:38]             [35msample_rate[0m : [92m4[0m
[12/24 14:30:38]             [35msliding_window[0m : [92m128[0m
[12/24 14:30:38]         [35mtransform[0m : 
[12/24 14:30:38]             [35mname[0m : [92mVideoStreamTransform[0m
[12/24 14:30:38]             [35mtransform_list[0m : 
[12/24 14:30:38]                 [35mResize[0m : 
[12/24 14:30:38]                     [35msize[0m : [92m[256, 320][0m
[12/24 14:30:38]                 [35mCenterCrop[0m : 
[12/24 14:30:38]                     [35msize[0m : [92m224[0m
[12/24 14:30:38]                 [35mToTensor[0m : [92mNone[0m
[12/24 14:30:38]                 [35mNormalize[0m : 
[12/24 14:30:38]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[12/24 14:30:38]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[12/24 14:30:38]     [35mtrain[0m : 
[12/24 14:30:38]         [35mdecode[0m : 
[12/24 14:30:38]             [35mbackend[0m : [92mdecord[0m
[12/24 14:30:38]             [35mname[0m : [92mVideoDecoder[0m
[12/24 14:30:38]         [35mname[0m : [92mBasePipline[0m
[12/24 14:30:38]         [35msample[0m : 
[12/24 14:30:38]             [35mclip_seg_num[0m : [92m32[0m
[12/24 14:30:38]             [35mis_train[0m : [92mTrue[0m
[12/24 14:30:38]             [35mname[0m : [92mVideoStreamSampler[0m
[12/24 14:30:38]             [35msample_mode[0m : [92muniform[0m
[12/24 14:30:38]             [35msample_rate[0m : [92m4[0m
[12/24 14:30:38]             [35msliding_window[0m : [92m128[0m
[12/24 14:30:38]         [35mtransform[0m : 
[12/24 14:30:38]             [35mname[0m : [92mVideoStreamTransform[0m
[12/24 14:30:38]             [35mtransform_list[0m : 
[12/24 14:30:38]                 [35mResize[0m : 
[12/24 14:30:38]                     [35msize[0m : [92m[256, 320][0m
[12/24 14:30:38]                 [35mRandomCrop[0m : 
[12/24 14:30:38]                     [35msize[0m : [92m224[0m
[12/24 14:30:38]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[12/24 14:30:38]                 [35mToTensor[0m : [92mNone[0m
[12/24 14:30:38]                 [35mNormalize[0m : 
[12/24 14:30:38]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[12/24 14:30:38]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[12/24 14:30:38] ------------------------------------------------------------
[12/24 14:30:38] [35mPOSTPRECESSING[0m : 
[12/24 14:30:38]     [35mclip_seg_num[0m : [92m32[0m
[12/24 14:30:38]     [35mignore_index[0m : [92m-100[0m
[12/24 14:30:38]     [35mname[0m : [92mStreamScorePostProcessing[0m
[12/24 14:30:38]     [35mnum_classes[0m : [92m5[0m
[12/24 14:30:38]     [35msample_rate[0m : [92m4[0m
[12/24 14:30:38]     [35msliding_window[0m : [92m128[0m
[12/24 14:30:38] ------------------------------------------------------------
[12/24 14:30:38] [35mepochs[0m : [92m50[0m
[12/24 14:30:38] [35mlog_interval[0m : [92m4[0m
[12/24 14:30:38] [35mmodel_name[0m : [92mResnetTSM_Memory_TCN_thal_3train_1val_kineticPretrain[0m
[12/24 14:30:38] [35msave_interval[0m : [92m50[0m
[12/24 14:30:38] Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
CUDA available: True
GPU 0: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda
NVCC: Cuda compilation tools, release 12.6, V12.6.68
GCC: gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
PyTorch: 2.4.1+cu121
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 12.1
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 90.4  (built against CUDA 12.6)
    - Built with CuDNN 90.1
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=12.1, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

TorchVision: 0.19.1+cu121
OpenCV: 4.10.0
MMCV: 1.7.2
MMCV Compiler: n/a
MMCV CUDA Compiler: n/a
SVTAS: 5201062
------------------------------------------------------------

[12/24 14:30:39] load checkpoint from local path: data/tsm_r50_dense_256p_1x1x8_100e_kinetics400_rgb_20200727-e1e0c785.pth
[12/24 14:30:39] The model and loaded state dict do not match exactly

unexpected key in source state_dict: cls_head.fc_cls.weight, cls_head.fc_cls.bias

[12/24 14:30:39] load checkpoint from local path: data/cleaned.pth
[12/24 14:32:31] [95mtest step:0   [0m [92mloss: 0.26650 F1@0.50: 0.73333 Acc: 0.92813 Seg_Acc: 0.93029[0m [92mbatch_cost: 111.09426 sec,[0m [92mreader_time: 4.61238 sec,[0m ips: 0.01800 instance/sec.
[12/24 14:32:32] dataset model performence: Acc: 92.8129, Edit: 78.7234, F1@0.10: 82.2222, F1@0.25: 80.0000, F1@0.50: 73.3333, Auc: 65.6822, AR@AN1: 2.3256, AR@AN5: 11.6279, AR@AN15: 34.1085, mAP@0.5: 82.5080, avg_mAP: 52.9282, 
[12/24 14:32:32] ====================
[12/24 14:32:32] Use mmcv get_model_complexity_info function
[12/24 14:32:33] Hitp: This FLOPs is caculation by 32 imgs
[12/24 14:32:33] Per Image FLOPs:8.239850G, Total FLOPs:263.675196G, Total params:23.706053M
[12/24 14:32:33] ====================
[12/24 14:32:33] Use fvcore FlopCountAnalysis function
[12/24 14:32:33] flop_count_table: 
| module                     | #parameters or shape   | #flops     |
|:---------------------------|:-----------------------|:-----------|
| model                      | 47.214M                | 0.263T     |
|  backbone                  |  23.508M               |  0.131T    |
|   backbone.conv1           |   9.536K               |   3.828G   |
|    backbone.conv1.conv     |    9.408K              |    3.776G  |
|    backbone.conv1.bn       |    0.128K              |    51.38M  |
|   backbone.layer1          |   0.216M               |   21.657G  |
|    backbone.layer1.0       |    75.008K             |    7.527G  |
|    backbone.layer1.1       |    70.4K               |    7.065G  |
|    backbone.layer1.2       |    70.4K               |    7.065G  |
|   backbone.layer2          |   1.22M                |   33.082G  |
|    backbone.layer2.0       |    0.379M              |    12.004G |
|    backbone.layer2.1       |    0.28M               |    7.026G  |
|    backbone.layer2.2       |    0.28M               |    7.026G  |
|    backbone.layer2.3       |    0.28M               |    7.026G  |
|   backbone.layer3          |   7.098M               |   46.997G  |
|    backbone.layer3.0       |    1.512M              |    11.962G |
|    backbone.layer3.1       |    1.117M              |    7.007G  |
|    backbone.layer3.2       |    1.117M              |    7.007G  |
|    backbone.layer3.3       |    1.117M              |    7.007G  |
|    backbone.layer3.4       |    1.117M              |    7.007G  |
|    backbone.layer3.5       |    1.117M              |    7.007G  |
|   backbone.layer4          |   14.965M              |   25.936G  |
|    backbone.layer4.0       |    6.04M               |    11.941G |
|    backbone.layer4.1       |    4.463M              |    6.997G  |
|    backbone.layer4.2       |    4.463M              |    6.997G  |
|  det_backbone              |  23.508M               |  0.131T    |
|   det_backbone.conv1       |   9.536K               |   3.828G   |
|    det_backbone.conv1.conv |    9.408K              |    3.776G  |
|    det_backbone.conv1.bn   |    0.128K              |    51.38M  |
|   det_backbone.layer1      |   0.216M               |   21.657G  |
|    det_backbone.layer1.0   |    75.008K             |    7.527G  |
|    det_backbone.layer1.1   |    70.4K               |    7.065G  |
|    det_backbone.layer1.2   |    70.4K               |    7.065G  |
|   det_backbone.layer2      |   1.22M                |   33.082G  |
|    det_backbone.layer2.0   |    0.379M              |    12.004G |
|    det_backbone.layer2.1   |    0.28M               |    7.026G  |
|    det_backbone.layer2.2   |    0.28M               |    7.026G  |
|    det_backbone.layer2.3   |    0.28M               |    7.026G  |
|   det_backbone.layer3      |   7.098M               |   46.997G  |
|    det_backbone.layer3.0   |    1.512M              |    11.962G |
|    det_backbone.layer3.1   |    1.117M              |    7.007G  |
|    det_backbone.layer3.2   |    1.117M              |    7.007G  |
|    det_backbone.layer3.3   |    1.117M              |    7.007G  |
|    det_backbone.layer3.4   |    1.117M              |    7.007G  |
|    det_backbone.layer3.5   |    1.117M              |    7.007G  |
|   det_backbone.layer4      |   14.965M              |   25.936G  |
|    det_backbone.layer4.0   |    6.04M               |    11.941G |
|    det_backbone.layer4.1   |    4.463M              |    6.997G  |
|    det_backbone.layer4.2   |    4.463M              |    6.997G  |
|  head                      |  0.198M                |  6.319M    |
|   head.stage1              |   0.198M               |   6.318M   |
|    head.stage1.conv_1x1    |    0.131M              |    4.194M  |
|    head.stage1.layers      |    66.56K              |    2.114M  |
|    head.stage1.conv_out    |    0.325K              |    10.24K  |
|  neck.backbone_avgpool     |                        |  3.211M    |
[12/24 14:32:33] Hitp: This FLOPs is caculation by 32 imgs
[12/24 14:32:33] Per Image FLOPs:8.219026G, Total FLOPs:263.008840G
[12/24 14:32:33] ====================
[12/24 14:32:33] Caculate model fps (single frame infer times)
[12/24 14:32:52] Mean@1 59.285ms, Std@5 19.534ms, FPS@1 539.77
[12/24 14:32:52] Model single forward infer time(ms) 59.285ms
[12/24 14:32:52] ====================
[12/24 14:32:52] Caculate model Throughput
[12/24 14:32:57] Final Throughput: 17.03 V/s, Measuring by batch_size: 1
[12/24 14:32:57] ====================
[12/25 17:42:03] [35mCOLLATE[0m : 
[12/25 17:42:03]     [35mname[0m : [92mStreamBatchCompose[0m
[12/25 17:42:03]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[12/25 17:42:03] ------------------------------------------------------------
[12/25 17:42:03] [35mDATASET[0m : 
[12/25 17:42:03]     [35mnum_workers[0m : [92m0[0m
[12/25 17:42:03]     [35mtemporal_clip_batch_size[0m : [92m3[0m
[12/25 17:42:03]     [35mtest[0m : 
[12/25 17:42:03]         [35mactions_map_file_path[0m : [92m./data/thal/mapping.txt[0m
[12/25 17:42:03]         [35mclip_seg_num[0m : [92m32[0m
[12/25 17:42:03]         [35mdata_prefix[0m : [92m./[0m
[12/25 17:42:03]         [35mdataset_type[0m : [92mgtea[0m
[12/25 17:42:03]         [35mfile_path[0m : [92m./data/thal/splits/test.split1.bundle[0m
[12/25 17:42:03]         [35mgt_path[0m : [92m./data/thal/groundTruth[0m
[12/25 17:42:03]         [35mname[0m : [92mRawFrameStreamSegmentationDataset[0m
[12/25 17:42:03]         [35msample_rate[0m : [92m4[0m
[12/25 17:42:03]         [35msliding_window[0m : [92m128[0m
[12/25 17:42:03]         [35mtrain_mode[0m : [92mFalse[0m
[12/25 17:42:03]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[12/25 17:42:03]     [35mtrain[0m : 
[12/25 17:42:03]         [35mactions_map_file_path[0m : [92m./data/thal/mapping.txt[0m
[12/25 17:42:03]         [35mclip_seg_num[0m : [92m32[0m
[12/25 17:42:03]         [35mdata_prefix[0m : [92m./[0m
[12/25 17:42:03]         [35mdataset_type[0m : [92mgtea[0m
[12/25 17:42:03]         [35mfile_path[0m : [92m./data/thal/splits/train.split1.bundle[0m
[12/25 17:42:03]         [35mgt_path[0m : [92m./data/thal/groundTruth[0m
[12/25 17:42:03]         [35mname[0m : [92mRawFrameStreamSegmentationDataset[0m
[12/25 17:42:03]         [35msample_rate[0m : [92m4[0m
[12/25 17:42:03]         [35msliding_window[0m : [92m128[0m
[12/25 17:42:03]         [35mtrain_mode[0m : [92mTrue[0m
[12/25 17:42:03]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[12/25 17:42:03]     [35mvideo_batch_size[0m : [92m2[0m
[12/25 17:42:03] ------------------------------------------------------------
[12/25 17:42:03] [35mLRSCHEDULER[0m : 
[12/25 17:42:03]     [35mgamma[0m : [92m0.1[0m
[12/25 17:42:03]     [35mname[0m : [92mMultiStepLR[0m
[12/25 17:42:03]     [35mstep_size[0m : [92m[50][0m
[12/25 17:42:03] ------------------------------------------------------------
[12/25 17:42:03] [35mMETRIC[0m : 
[12/25 17:42:03]     [35mactions_map_file_path[0m : [92m./data/thal/mapping.txt[0m
[12/25 17:42:03]     [35mfile_output[0m : [92mTrue[0m
[12/25 17:42:03]     [35mname[0m : [92mTASegmentationMetric[0m
[12/25 17:42:03]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[12/25 17:42:03]     [35mscore_output[0m : [92mTrue[0m
[12/25 17:42:03] ------------------------------------------------------------
[12/25 17:42:03] [35mMODEL[0m : 
[12/25 17:42:03]     [35marchitecture[0m : [92mStreamSegmentation2D[0m
[12/25 17:42:03]     [35mbackbone[0m : 
[12/25 17:42:03]         [35mclip_seg_num[0m : [92m32[0m
[12/25 17:42:03]         [35mname[0m : [92mResNetTSM[0m
[12/25 17:42:03]         [35mout_indices[0m : [92m(3,)[0m
[12/25 17:42:03]         [35mpretrained[0m : [92mdata/tsm_r50_dense_256p_1x1x8_100e_kinetics400_rgb_20200727-e1e0c785.pth[0m
[12/25 17:42:03]         [35mshift_div[0m : [92m8[0m
[12/25 17:42:03]     [35mhead[0m : 
[12/25 17:42:03]         [35mdim[0m : [92m2048[0m
[12/25 17:42:03]         [35mname[0m : [92mMemoryTCNHead[0m
[12/25 17:42:03]         [35mnum_classes[0m : [92m5[0m
[12/25 17:42:03]         [35mnum_f_maps[0m : [92m64[0m
[12/25 17:42:03]         [35mnum_layers[0m : [92m4[0m
[12/25 17:42:03]         [35mnum_stages[0m : [92m1[0m
[12/25 17:42:03]         [35msample_rate[0m : [92m4[0m
[12/25 17:42:03]     [35mloss[0m : 
[12/25 17:42:03]         [35mignore_index[0m : [92m-100[0m
[12/25 17:42:03]         [35mname[0m : [92mSegmentationLoss[0m
[12/25 17:42:03]         [35mnum_classes[0m : [92m5[0m
[12/25 17:42:03]         [35msample_rate[0m : [92m4[0m
[12/25 17:42:03]         [35msmooth_weight[0m : [92m0.15[0m
[12/25 17:42:03]     [35mneck[0m : 
[12/25 17:42:03]         [35mclip_seg_num[0m : [92m32[0m
[12/25 17:42:03]         [35mdrop_ratio[0m : [92m0.5[0m
[12/25 17:42:03]         [35min_channels[0m : [92m2048[0m
[12/25 17:42:03]         [35mname[0m : [92mAvgPoolNeck[0m
[12/25 17:42:03]         [35mneed_pool[0m : [92mTrue[0m
[12/25 17:42:03]         [35mnum_classes[0m : [92m5[0m
[12/25 17:42:03] ------------------------------------------------------------
[12/25 17:42:03] [35mOPTIMIZER[0m : 
[12/25 17:42:03]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[12/25 17:42:03]     [35mlearning_rate[0m : [92m0.0005[0m
[12/25 17:42:03]     [35mname[0m : [92mTSMAdamOptimizer[0m
[12/25 17:42:03]     [35mweight_decay[0m : [92m0.0001[0m
[12/25 17:42:03] ------------------------------------------------------------
[12/25 17:42:03] [35mPIPELINE[0m : 
[12/25 17:42:03]     [35mtest[0m : 
[12/25 17:42:03]         [35mdecode[0m : 
[12/25 17:42:03]             [35mbackend[0m : [92mdecord[0m
[12/25 17:42:03]             [35mname[0m : [92mVideoDecoder[0m
[12/25 17:42:03]         [35mname[0m : [92mBasePipline[0m
[12/25 17:42:03]         [35msample[0m : 
[12/25 17:42:03]             [35mclip_seg_num[0m : [92m32[0m
[12/25 17:42:03]             [35mis_train[0m : [92m./data/resnet_tsm_224_new.pth[0m
[12/25 17:42:03]             [35mname[0m : [92mVideoStreamSampler[0m
[12/25 17:42:03]             [35msample_mode[0m : [92muniform[0m
[12/25 17:42:03]             [35msample_rate[0m : [92m4[0m
[12/25 17:42:03]             [35msliding_window[0m : [92m128[0m
[12/25 17:42:03]         [35mtransform[0m : 
[12/25 17:42:03]             [35mname[0m : [92mVideoStreamTransform[0m
[12/25 17:42:03]             [35mtransform_list[0m : 
[12/25 17:42:03]                 [35mResize[0m : 
[12/25 17:42:03]                     [35msize[0m : [92m[256, 320][0m
[12/25 17:42:03]                 [35mCenterCrop[0m : 
[12/25 17:42:03]                     [35msize[0m : [92m224[0m
[12/25 17:42:03]                 [35mToTensor[0m : [92mNone[0m
[12/25 17:42:03]                 [35mNormalize[0m : 
[12/25 17:42:03]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[12/25 17:42:03]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[12/25 17:42:03]     [35mtrain[0m : 
[12/25 17:42:03]         [35mdecode[0m : 
[12/25 17:42:03]             [35mbackend[0m : [92mdecord[0m
[12/25 17:42:03]             [35mname[0m : [92mVideoDecoder[0m
[12/25 17:42:03]         [35mname[0m : [92mBasePipline[0m
[12/25 17:42:03]         [35msample[0m : 
[12/25 17:42:03]             [35mclip_seg_num[0m : [92m32[0m
[12/25 17:42:03]             [35mis_train[0m : [92mTrue[0m
[12/25 17:42:03]             [35mname[0m : [92mVideoStreamSampler[0m
[12/25 17:42:03]             [35msample_mode[0m : [92muniform[0m
[12/25 17:42:03]             [35msample_rate[0m : [92m4[0m
[12/25 17:42:03]             [35msliding_window[0m : [92m128[0m
[12/25 17:42:03]         [35mtransform[0m : 
[12/25 17:42:03]             [35mname[0m : [92mVideoStreamTransform[0m
[12/25 17:42:03]             [35mtransform_list[0m : 
[12/25 17:42:03]                 [35mResize[0m : 
[12/25 17:42:03]                     [35msize[0m : [92m[256, 320][0m
[12/25 17:42:03]                 [35mRandomCrop[0m : 
[12/25 17:42:03]                     [35msize[0m : [92m224[0m
[12/25 17:42:03]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[12/25 17:42:03]                 [35mToTensor[0m : [92mNone[0m
[12/25 17:42:03]                 [35mNormalize[0m : 
[12/25 17:42:03]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[12/25 17:42:03]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[12/25 17:42:03] ------------------------------------------------------------
[12/25 17:42:03] [35mPOSTPRECESSING[0m : 
[12/25 17:42:03]     [35mclip_seg_num[0m : [92m32[0m
[12/25 17:42:03]     [35mignore_index[0m : [92m-100[0m
[12/25 17:42:03]     [35mname[0m : [92mStreamScorePostProcessing[0m
[12/25 17:42:03]     [35mnum_classes[0m : [92m5[0m
[12/25 17:42:03]     [35msample_rate[0m : [92m4[0m
[12/25 17:42:03]     [35msliding_window[0m : [92m128[0m
[12/25 17:42:03] ------------------------------------------------------------
[12/25 17:42:03] [35mepochs[0m : [92m50[0m
[12/25 17:42:03] [35mlog_interval[0m : [92m4[0m
[12/25 17:42:03] [35mmodel_name[0m : [92mResnetTSM_Memory_TCN_thal_latest[0m
[12/25 17:42:03] [35msave_interval[0m : [92m50[0m
[12/25 17:42:03] Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
CUDA available: True
GPU 0: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda
NVCC: Cuda compilation tools, release 12.6, V12.6.68
GCC: gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
PyTorch: 2.4.1+cu121
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 12.1
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 90.4  (built against CUDA 12.6)
    - Built with CuDNN 90.1
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=12.1, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

TorchVision: 0.19.1+cu121
OpenCV: 4.10.0
MMCV: 1.7.2
MMCV Compiler: n/a
MMCV CUDA Compiler: n/a
SVTAS: da2776c
------------------------------------------------------------

[12/25 17:42:03] load checkpoint from local path: data/tsm_r50_dense_256p_1x1x8_100e_kinetics400_rgb_20200727-e1e0c785.pth
[12/25 17:42:04] The model and loaded state dict do not match exactly

unexpected key in source state_dict: cls_head.fc_cls.weight, cls_head.fc_cls.bias

[12/25 17:42:04] load checkpoint from local path: data/cleaned.pth
[12/27 11:35:24] [35mCOLLATE[0m : 
[12/27 11:35:24]     [35mname[0m : [92mStreamBatchCompose[0m
[12/27 11:35:24]     [35mto_tensor_keys[0m : [92m['imgs', 'labels', 'masks', 'precise_sliding_num'][0m
[12/27 11:35:24] ------------------------------------------------------------
[12/27 11:35:24] [35mDATASET[0m : 
[12/27 11:35:24]     [35mnum_workers[0m : [92m0[0m
[12/27 11:35:24]     [35mtemporal_clip_batch_size[0m : [92m3[0m
[12/27 11:35:24]     [35mtest[0m : 
[12/27 11:35:24]         [35mactions_map_file_path[0m : [92m./data/thal/mapping.txt[0m
[12/27 11:35:24]         [35mclip_seg_num[0m : [92m32[0m
[12/27 11:35:24]         [35mdata_prefix[0m : [92m./[0m
[12/27 11:35:24]         [35mdataset_type[0m : [92mgtea[0m
[12/27 11:35:24]         [35mfile_path[0m : [92m./data/thal/splits/test.split1.bundle[0m
[12/27 11:35:24]         [35mgt_path[0m : [92m./data/thal/groundTruth[0m
[12/27 11:35:24]         [35mname[0m : [92mRawFrameStreamSegmentationDataset[0m
[12/27 11:35:24]         [35msample_rate[0m : [92m4[0m
[12/27 11:35:24]         [35msliding_window[0m : [92m128[0m
[12/27 11:35:24]         [35mtrain_mode[0m : [92mFalse[0m
[12/27 11:35:24]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[12/27 11:35:24]     [35mtrain[0m : 
[12/27 11:35:24]         [35mactions_map_file_path[0m : [92m./data/thal/mapping.txt[0m
[12/27 11:35:24]         [35mclip_seg_num[0m : [92m32[0m
[12/27 11:35:24]         [35mdata_prefix[0m : [92m./[0m
[12/27 11:35:24]         [35mdataset_type[0m : [92mgtea[0m
[12/27 11:35:24]         [35mfile_path[0m : [92m./data/thal/splits/train.split1.bundle[0m
[12/27 11:35:24]         [35mgt_path[0m : [92m./data/thal/groundTruth[0m
[12/27 11:35:24]         [35mname[0m : [92mRawFrameStreamSegmentationDataset[0m
[12/27 11:35:24]         [35msample_rate[0m : [92m4[0m
[12/27 11:35:24]         [35msliding_window[0m : [92m128[0m
[12/27 11:35:24]         [35mtrain_mode[0m : [92mTrue[0m
[12/27 11:35:24]         [35mvideos_path[0m : [92m./data/thal/Videos[0m
[12/27 11:35:24]     [35mvideo_batch_size[0m : [92m2[0m
[12/27 11:35:24] ------------------------------------------------------------
[12/27 11:35:24] [35mLRSCHEDULER[0m : 
[12/27 11:35:24]     [35mgamma[0m : [92m0.1[0m
[12/27 11:35:24]     [35mname[0m : [92mMultiStepLR[0m
[12/27 11:35:24]     [35mstep_size[0m : [92m[50][0m
[12/27 11:35:24] ------------------------------------------------------------
[12/27 11:35:24] [35mMETRIC[0m : 
[12/27 11:35:24]     [35mactions_map_file_path[0m : [92m./data/thal/mapping.txt[0m
[12/27 11:35:24]     [35mfile_output[0m : [92mTrue[0m
[12/27 11:35:24]     [35mname[0m : [92mTASegmentationMetric[0m
[12/27 11:35:24]     [35moverlap[0m : [92m[0.1, 0.25, 0.5][0m
[12/27 11:35:24]     [35mscore_output[0m : [92mTrue[0m
[12/27 11:35:24] ------------------------------------------------------------
[12/27 11:35:24] [35mMODEL[0m : 
[12/27 11:35:24]     [35marchitecture[0m : [92mStreamSegmentation2D[0m
[12/27 11:35:24]     [35mbackbone[0m : 
[12/27 11:35:24]         [35mclip_seg_num[0m : [92m32[0m
[12/27 11:35:24]         [35mname[0m : [92mResNetTSM[0m
[12/27 11:35:24]         [35mout_indices[0m : [92m(3,)[0m
[12/27 11:35:24]         [35mpretrained[0m : [92mclsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth[0m
[12/27 11:35:24]         [35mshift_div[0m : [92m8[0m
[12/27 11:35:24]     [35mhead[0m : 
[12/27 11:35:24]         [35mdim[0m : [92m2048[0m
[12/27 11:35:24]         [35mname[0m : [92mMemoryTCNHead[0m
[12/27 11:35:24]         [35mnum_classes[0m : [92m5[0m
[12/27 11:35:24]         [35mnum_f_maps[0m : [92m64[0m
[12/27 11:35:24]         [35mnum_layers[0m : [92m4[0m
[12/27 11:35:24]         [35mnum_stages[0m : [92m1[0m
[12/27 11:35:24]         [35msample_rate[0m : [92m4[0m
[12/27 11:35:24]     [35mloss[0m : 
[12/27 11:35:24]         [35mignore_index[0m : [92m-100[0m
[12/27 11:35:24]         [35mname[0m : [92mSegmentationLoss[0m
[12/27 11:35:24]         [35mnum_classes[0m : [92m5[0m
[12/27 11:35:24]         [35msample_rate[0m : [92m4[0m
[12/27 11:35:24]         [35msmooth_weight[0m : [92m0.15[0m
[12/27 11:35:24]     [35mneck[0m : 
[12/27 11:35:24]         [35mclip_seg_num[0m : [92m32[0m
[12/27 11:35:24]         [35mdrop_ratio[0m : [92m0.5[0m
[12/27 11:35:24]         [35min_channels[0m : [92m2048[0m
[12/27 11:35:24]         [35mname[0m : [92mAvgPoolNeck[0m
[12/27 11:35:24]         [35mneed_pool[0m : [92mTrue[0m
[12/27 11:35:24]         [35mnum_classes[0m : [92m5[0m
[12/27 11:35:24] ------------------------------------------------------------
[12/27 11:35:24] [35mOPTIMIZER[0m : 
[12/27 11:35:24]     [35mbetas[0m : [92m(0.9, 0.999)[0m
[12/27 11:35:24]     [35mlearning_rate[0m : [92m0.0005[0m
[12/27 11:35:24]     [35mname[0m : [92mTSMAdamOptimizer[0m
[12/27 11:35:24]     [35mweight_decay[0m : [92m0.0001[0m
[12/27 11:35:24] ------------------------------------------------------------
[12/27 11:35:24] [35mPIPELINE[0m : 
[12/27 11:35:24]     [35mtest[0m : 
[12/27 11:35:24]         [35mdecode[0m : 
[12/27 11:35:24]             [35mbackend[0m : [92mdecord[0m
[12/27 11:35:24]             [35mname[0m : [92mVideoDecoder[0m
[12/27 11:35:24]         [35mname[0m : [92mBasePipline[0m
[12/27 11:35:24]         [35msample[0m : 
[12/27 11:35:24]             [35mclip_seg_num[0m : [92m32[0m
[12/27 11:35:24]             [35mis_train[0m : [92mFalse[0m
[12/27 11:35:24]             [35mname[0m : [92mVideoStreamSampler[0m
[12/27 11:35:24]             [35msample_mode[0m : [92muniform[0m
[12/27 11:35:24]             [35msample_rate[0m : [92m4[0m
[12/27 11:35:24]             [35msliding_window[0m : [92m128[0m
[12/27 11:35:24]         [35mtransform[0m : 
[12/27 11:35:24]             [35mname[0m : [92mVideoStreamTransform[0m
[12/27 11:35:24]             [35mtransform_list[0m : 
[12/27 11:35:24]                 [35mResize[0m : 
[12/27 11:35:24]                     [35msize[0m : [92m[256, 320][0m
[12/27 11:35:24]                 [35mCenterCrop[0m : 
[12/27 11:35:24]                     [35msize[0m : [92m224[0m
[12/27 11:35:24]                 [35mToTensor[0m : [92mNone[0m
[12/27 11:35:24]                 [35mNormalize[0m : 
[12/27 11:35:24]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[12/27 11:35:24]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[12/27 11:35:24]     [35mtrain[0m : 
[12/27 11:35:24]         [35mdecode[0m : 
[12/27 11:35:24]             [35mbackend[0m : [92mdecord[0m
[12/27 11:35:24]             [35mname[0m : [92mVideoDecoder[0m
[12/27 11:35:24]         [35mname[0m : [92mBasePipline[0m
[12/27 11:35:24]         [35msample[0m : 
[12/27 11:35:24]             [35mclip_seg_num[0m : [92m32[0m
[12/27 11:35:24]             [35mis_train[0m : [92mTrue[0m
[12/27 11:35:24]             [35mname[0m : [92mVideoStreamSampler[0m
[12/27 11:35:24]             [35msample_mode[0m : [92muniform[0m
[12/27 11:35:24]             [35msample_rate[0m : [92m4[0m
[12/27 11:35:24]             [35msliding_window[0m : [92m128[0m
[12/27 11:35:24]         [35mtransform[0m : 
[12/27 11:35:24]             [35mname[0m : [92mVideoStreamTransform[0m
[12/27 11:35:24]             [35mtransform_list[0m : 
[12/27 11:35:24]                 [35mResize[0m : 
[12/27 11:35:24]                     [35msize[0m : [92m[256, 320][0m
[12/27 11:35:24]                 [35mRandomCrop[0m : 
[12/27 11:35:24]                     [35msize[0m : [92m224[0m
[12/27 11:35:24]                 [35mRandomHorizontalFlip[0m : [92mNone[0m
[12/27 11:35:24]                 [35mToTensor[0m : [92mNone[0m
[12/27 11:35:24]                 [35mNormalize[0m : 
[12/27 11:35:24]                     [35mmean[0m : [92m[0.485, 0.456, 0.406][0m
[12/27 11:35:24]                     [35mstd[0m : [92m[0.229, 0.224, 0.225][0m
[12/27 11:35:24] ------------------------------------------------------------
[12/27 11:35:24] [35mPOSTPRECESSING[0m : 
[12/27 11:35:24]     [35mclip_seg_num[0m : [92m32[0m
[12/27 11:35:24]     [35mignore_index[0m : [92m-100[0m
[12/27 11:35:24]     [35mname[0m : [92mStreamScorePostProcessing[0m
[12/27 11:35:24]     [35mnum_classes[0m : [92m5[0m
[12/27 11:35:24]     [35msample_rate[0m : [92m4[0m
[12/27 11:35:24]     [35msliding_window[0m : [92m128[0m
[12/27 11:35:24] ------------------------------------------------------------
[12/27 11:35:24] [35mepochs[0m : [92m50[0m
[12/27 11:35:24] [35mlog_interval[0m : [92m1[0m
[12/27 11:35:24] [35mmodel_name[0m : [92mResnetTSM_Memory_TCN_thal_new_8+6+3[0m
[12/27 11:35:24] [35msave_interval[0m : [92m50[0m
[12/27 11:35:24] Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
CUDA available: True
GPU 0: NVIDIA GeForce RTX 3090
CUDA_HOME: /usr/local/cuda
NVCC: Cuda compilation tools, release 12.6, V12.6.68
GCC: gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0
PyTorch: 2.4.1+cu121
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.2-Product Build 20220804 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 12.1
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 90.4  (built against CUDA 12.6)
    - Built with CuDNN 90.1
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=12.1, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=1, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

TorchVision: 0.19.1+cu121
OpenCV: 4.10.0
MMCV: 1.7.2
MMCV Compiler: n/a
MMCV CUDA Compiler: n/a
SVTAS: da2776c
------------------------------------------------------------

[12/27 11:35:24] load checkpoint from local path: clsLess_tsm_r50_256p_1x1x8_kinetics400_rgb_.pth
det backbone loaded
det backbone freezed
[12/27 11:36:16] [95mtest step:0   [0m [92mloss: 0.62761 F1@0.50: 0.57955 Acc: 0.82621 Seg_Acc: 0.82392[0m [92mbatch_cost: 51.30734 sec,[0m [92mreader_time: 4.15963 sec,[0m ips: 0.03898 instance/sec.
[12/27 11:36:58] [95mtest step:1   [0m [92mloss: 0.69187 F1@0.50: 0.56303 Acc: 0.82063 Seg_Acc: 0.82011[0m [92mbatch_cost: 42.04189 sec,[0m [92mreader_time: 2.80430 sec,[0m ips: 0.04757 instance/sec.
[12/27 11:36:59] dataset model performence: Acc: 82.3558, Edit: 77.8198, F1@0.10: 77.3212, F1@0.25: 73.3638, F1@0.50: 57.2298, Auc: 50.1674, AR@AN1: 1.3000, AR@AN5: 6.3824, AR@AN15: 18.6999, mAP@0.5: 69.4604, avg_mAP: 40.5248, 
[12/27 11:36:59] ====================
[12/27 11:36:59] Use mmcv get_model_complexity_info function
[12/27 11:37:00] Hitp: This FLOPs is caculation by 32 imgs
[12/27 11:37:00] Per Image FLOPs:8.239850G, Total FLOPs:263.675196G, Total params:23.706053M
[12/27 11:37:00] ====================
[12/27 11:37:00] Use fvcore FlopCountAnalysis function
[12/27 11:37:00] flop_count_table: 
| module                     | #parameters or shape   | #flops     |
|:---------------------------|:-----------------------|:-----------|
| model                      | 47.214M                | 0.263T     |
|  backbone                  |  23.508M               |  0.131T    |
|   backbone.conv1           |   9.536K               |   3.828G   |
|    backbone.conv1.conv     |    9.408K              |    3.776G  |
|    backbone.conv1.bn       |    0.128K              |    51.38M  |
|   backbone.layer1          |   0.216M               |   21.657G  |
|    backbone.layer1.0       |    75.008K             |    7.527G  |
|    backbone.layer1.1       |    70.4K               |    7.065G  |
|    backbone.layer1.2       |    70.4K               |    7.065G  |
|   backbone.layer2          |   1.22M                |   33.082G  |
|    backbone.layer2.0       |    0.379M              |    12.004G |
|    backbone.layer2.1       |    0.28M               |    7.026G  |
|    backbone.layer2.2       |    0.28M               |    7.026G  |
|    backbone.layer2.3       |    0.28M               |    7.026G  |
|   backbone.layer3          |   7.098M               |   46.997G  |
|    backbone.layer3.0       |    1.512M              |    11.962G |
|    backbone.layer3.1       |    1.117M              |    7.007G  |
|    backbone.layer3.2       |    1.117M              |    7.007G  |
|    backbone.layer3.3       |    1.117M              |    7.007G  |
|    backbone.layer3.4       |    1.117M              |    7.007G  |
|    backbone.layer3.5       |    1.117M              |    7.007G  |
|   backbone.layer4          |   14.965M              |   25.936G  |
|    backbone.layer4.0       |    6.04M               |    11.941G |
|    backbone.layer4.1       |    4.463M              |    6.997G  |
|    backbone.layer4.2       |    4.463M              |    6.997G  |
|  det_backbone              |  23.508M               |  0.131T    |
|   det_backbone.conv1       |   9.536K               |   3.828G   |
|    det_backbone.conv1.conv |    9.408K              |    3.776G  |
|    det_backbone.conv1.bn   |    0.128K              |    51.38M  |
|   det_backbone.layer1      |   0.216M               |   21.657G  |
|    det_backbone.layer1.0   |    75.008K             |    7.527G  |
|    det_backbone.layer1.1   |    70.4K               |    7.065G  |
|    det_backbone.layer1.2   |    70.4K               |    7.065G  |
|   det_backbone.layer2      |   1.22M                |   33.082G  |
|    det_backbone.layer2.0   |    0.379M              |    12.004G |
|    det_backbone.layer2.1   |    0.28M               |    7.026G  |
|    det_backbone.layer2.2   |    0.28M               |    7.026G  |
|    det_backbone.layer2.3   |    0.28M               |    7.026G  |
|   det_backbone.layer3      |   7.098M               |   46.997G  |
|    det_backbone.layer3.0   |    1.512M              |    11.962G |
|    det_backbone.layer3.1   |    1.117M              |    7.007G  |
|    det_backbone.layer3.2   |    1.117M              |    7.007G  |
|    det_backbone.layer3.3   |    1.117M              |    7.007G  |
|    det_backbone.layer3.4   |    1.117M              |    7.007G  |
|    det_backbone.layer3.5   |    1.117M              |    7.007G  |
|   det_backbone.layer4      |   14.965M              |   25.936G  |
|    det_backbone.layer4.0   |    6.04M               |    11.941G |
|    det_backbone.layer4.1   |    4.463M              |    6.997G  |
|    det_backbone.layer4.2   |    4.463M              |    6.997G  |
|  head                      |  0.198M                |  6.319M    |
|   head.stage1              |   0.198M               |   6.318M   |
|    head.stage1.conv_1x1    |    0.131M              |    4.194M  |
|    head.stage1.layers      |    66.56K              |    2.114M  |
|    head.stage1.conv_out    |    0.325K              |    10.24K  |
|  neck.backbone_avgpool     |                        |  3.211M    |
[12/27 11:37:00] Hitp: This FLOPs is caculation by 32 imgs
[12/27 11:37:00] Per Image FLOPs:8.219026G, Total FLOPs:263.008840G
[12/27 11:37:00] ====================
[12/27 11:37:00] Caculate model fps (single frame infer times)
[12/27 11:37:15] Mean@1 47.525ms, Std@5 0.579ms, FPS@1 673.33
[12/27 11:37:15] Model single forward infer time(ms) 47.525ms
[12/27 11:37:15] ====================
[12/27 11:37:15] Caculate model Throughput
[12/27 11:37:19] Final Throughput: 21.03 V/s, Measuring by batch_size: 1
[12/27 11:37:19] ====================
